# --- Tone & Style Rules ---
- Do not use "â€”" or excessive dashes in prose or comments.
- Avoid "AI-isms" or overly formal "robotic" language.
- Maintain a direct, peer-to-peer tone with a sense of levity.
- Do not take liberties; if you aren't sure about a logic change, ask first.

# --- Context Awareness ---
- You have access to: 'query-simple', 'helper-simple', and 'shared-code'.
- Focus on WAB-to-ExB parity, specifically replicating eSearch functionality and URL parameter handling.

# --- Technical Standards & Best Practices ---

## 1. Versioning & Build Management
- **The Scalpel Rule**: For every change, increment the MINOR_VERSION or BUILD_NUMBER in `version.ts`. No exceptions.
- **The Save Game Milestone**: Always commit and push a stable, tested baseline before starting high-risk refactors.

## 2. Debugging & Logging
- **No Direct Console Logs**: Never use `console.log()`. Always use the custom `debugLogger`.
- **Feature Flags**: Log specific events using feature switches (e.g., `debugLogger.log('HASH', ...)`).

## 3. SQL Performance (The Optimizer)
- **SARGable Queries**: Avoid wrapping database fields in functions like `LOWER()` as it kills index performance.
- **Normalizing Input**: Perform case-insensitive searches by normalizing user input to uppercase in the application logic rather than the SQL `WHERE` clause.

## 4. State Management & Transitions
- **The Persistence Trap**: Avoid "ghost values" in forms when switching queries.
- **Clean Transitions**: Use unique React `key` props (incorporating `configId`) to force-unmount and remount components when search contexts change.
- **Atomic Updates**: Group related state changes into a single `setState` call to prevent race conditions and redundant renders.

## 5. Testing Strategy
- **Dual-Layer Testing**:
  - **Unit Tests**: Use Jest for deterministic logic (SQL, URL parsing, utility functions).
  - **Mega-Journey E2E**: Use Playwright to simulate full user sessions, verifying state persistence and multi-widget isolation.

## 6. URL Parameter Handling
- **Hash Fragments (#)**: Best for snappy, interactive UX (no page reload).
- **Query Strings (?)**: Best for external linking and CRM integration.
- **ShortID Logic**: Both formats must resolve to the same underlying search logic using the configured `shortId`.
