/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
v4.34.3 */
import{H as E,I as x,J as P,P as U,a as k,b as t,f as C,s as g}from"./U4NXTENC.js";import"./7V34NQ5V.js";var M=k`:host{display:none;background:#bdf2c4}:host([selected]){display:flex}calcite-block{margin-block:0}calcite-pagination{justify-content:center}`,w=class extends P{constructor(){super(...arguments),this._filterInputElement=E(),this._flowItemElement=E(),this.currentPage=1,this.selected=!1,this.showBackButton=!1,this.arcgisFlowItemBack=g(),this.arcgisFlowItemClose=g(),this.arcgisGetVersions=g(),this.arcgisManageVersion=g(),this.arcgisNewVersion=g()}static{this.properties={_filteredVersionInfos:16,currentPage:11,selected:7,showBackButton:7,versionListElementProps:0}}static{this.styles=M}load(){this._filteredVersionInfos=this.versionListElementProps.versionInfos}willUpdate(e){if(e.has("versionListElementProps")){let i=e.get("versionListElementProps"),s=this.versionListElementProps;i?.versionInfos!==s.versionInfos&&(this._filteredVersionInfos=s.versionInfos,this._filterInputElement.value&&this._handleFilterChange())}}updated(){this._filterInputElement.value?.setFocus()}async setFocus(){this._flowItemElement.value?.setFocus()}goBack(){}_handleFilterChange(){let{versionListElementProps:{versionInfos:e}}=this,i=this._filterInputElement.value.value.toUpperCase();this._filteredVersionInfos=i===""?e:e.filter(s=>s.versionIdentifier.name.toUpperCase().includes(i)||s.versionIdentifier.guid.toUpperCase().includes(i)),this._filteredVersionInfos.length&&(this.currentPage=1)}_handleNoticeClosed(){this.versionListElementProps={...this.versionListElementProps,executionError:void 0}}_handlePaginationChange(e){this.currentPage=e.target.startItem}_getExecutionError(e){let{versionListElementProps:{strings:{executionErrors:i}}}=this;switch(e){case"no-feature-service-found":return i.noFeatureServiceFound;case"no-valid-enterprise-version":return i.notValidEnterpriseVersion;case"no-valid-version-name":return i.invalidVersionName;default:return e}}_paginate(e,i,s){return e.slice((s-1)*i,s*i)}render(){let{currentPage:e,selected:i,showBackButton:s,versionListElementProps:{closable:u,currentUser:v,currentVersionIdentifier:c,executionError:l,heading:n,isVersionAdministrator:d,isVersioningApiAvailable:p,pageSize:r,serviceName:m,serviceUrl:h,state:f,strings:{headers:a},strings:o,versionInfos:$}}=this,I=t`<calcite-block .heading=${a.currentVersion} .description=${c.name} overlay-positioning=fixed></calcite-block>`,V=t`<calcite-action id=actionRefreshVersions icon=refresh text @click=${()=>this.arcgisGetVersions.emit({serviceUrl:h})} slot=header-actions-end><calcite-tooltip overlay-positioning=fixed reference-element=actionRefreshVersions><span>${o.actions.refreshVersions}</span></calcite-tooltip></calcite-action>`;this._paginatedVersionInfos=this._filteredVersionInfos.length>r?this._paginate(this._filteredVersionInfos,r,e):this._filteredVersionInfos;let _=this._filteredVersionInfos.length>r?t`<calcite-pagination @calcitePaginationChange=${this._handlePaginationChange} page-size=1 .startItem=${e} .totalItems=${Math.ceil(this._filteredVersionInfos.length/r)}></calcite-pagination>`:void 0,b=this._paginate(this._paginatedVersionInfos,r,1).map(A=>{let T={currentUser:v,currentVersionIdentifier:c,isCurrentVersionCard:!1,isVersionAdministrator:d,isVersioningApiAvailable:p,serviceUrl:h,strings:o,versionInfo:A};return this._renderListItem(T)}),F=$.length>r?t`<calcite-block heading .label=${a.filterVersions} open><calcite-input-text clearable icon=search @calciteInputTextInput=${this._handleFilterChange} .placeholder=${o.actions.searchVersions} ${x(this._filterInputElement)}></calcite-input-text></calcite-block>`:void 0,L=t`<calcite-list .label=${o.labels.versionList}>${b}</calcite-list>`,y=p?t`<calcite-fab appearance=outline-fill slot=fab text-enabled .text=${o.actions.newVersion} @click=${()=>this.arcgisNewVersion.emit({serviceUrl:h})}></calcite-fab>`:void 0,B=l?t`<calcite-notice @calciteNoticeClose=${this._handleNoticeClosed} class="notice" closable kind=warning open scale=s slot=footer width=full><div slot=message>${this._getExecutionError(l)}</div></calcite-notice>`:void 0;return t`<calcite-flow-item .closable=${u} .description=${m} .heading=${n} .selected=${i} .showBackButton=${s} @calciteFlowItemBack=${()=>this.arcgisFlowItemBack.emit()} @calciteFlowItemClose=${()=>this.arcgisFlowItemClose.emit()} ${x(this._flowItemElement)}><calcite-panel .loading=${f==="executing"}>${I}<calcite-panel .heading=${this._filteredVersionInfos.length?`${o.headers.manageVersions} (${this._filteredVersionInfos.length})`:o.headers.manageVersions}>${V}${F}${L}${y}</calcite-panel>${_}${B}</calcite-panel></calcite-flow-item>`}_renderListItem(e){let{currentUser:i,currentVersionIdentifier:s,isVersionAdministrator:u,isVersioningApiAvailable:v,serviceUrl:c,strings:{actions:l},versionInfo:n}=e,d=n.versionIdentifier.name,p=d.substring(d.lastIndexOf(".")+1),r=d.substring(0,d.lastIndexOf(".")),m=n.versionIdentifier.guid,h=`actionSwitchToVersion_${m}`,f=r.toUpperCase()===i.toUpperCase()&&v||u,a=s.guid===n.versionIdentifier.guid,o=t`<calcite-action .disabled=${a} icon=code-branch @click=${()=>{this.arcgisManageVersion.emit({actionType:"changeVersion",serviceUrl:c,versionInfo:n})}} scale=s .text=${l.switchToVersion} text-enabled></calcite-action>`,$=t`<calcite-action .disabled=${!f||f&&a} icon=trash @click=${()=>{this.arcgisManageVersion.emit({actionType:"deleteVersion",serviceUrl:c,versionInfo:n})}} scale=s .text=${l.deleteVersion} text-enabled></calcite-action>`,I=t`<calcite-action .disabled=${!f||a} icon=code-branch-edit @click=${()=>{this.arcgisManageVersion.emit({actionType:"editVersion",serviceUrl:c,versionInfo:n})}} scale=s .text=${l.editVersion} text-enabled></calcite-action>`,V=t`<calcite-action-menu overlay-positioning=fixed slot=actions-end label>${o}${I}${$}</calcite-action-menu>`,_=a?void 0:t`<calcite-tooltip overlay-positioning=fixed .referenceElement=${h}><span>${l.switchToVersion}</span></calcite-tooltip>`,b=t`<div slot=actions-start><calcite-action appearance=transparent .disabled=${a} id=${h??C} icon=code-branch text @click=${()=>{this.arcgisManageVersion.emit({actionType:"changeVersion",serviceUrl:c,versionInfo:n})}}></calcite-action>${_}</div>`;return t`<calcite-list-item .description=${r} .label=${p} .value=${m}>${b}${V}</calcite-list-item>`}};U("arcgis-version-management-version-list",w);export{w as ArcgisVersionManagementVersionList};
