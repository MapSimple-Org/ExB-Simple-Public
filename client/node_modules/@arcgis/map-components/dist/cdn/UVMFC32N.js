/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
v4.34.3 */
import{a as ve}from"./JER65Z5G.js";import{B as de,C as q,K as re,M as fe,N as _e,ba as ue,c as R,ea as xe,i as P,j as v,k as A,l as me,la as ce,m as he,ma as ae,n as be,na as we,o as te}from"./5DXMZMVZ.js";import{N as O,a as H,u as k}from"./VUQ2DCM6.js";import{a as ge,b as ee,d as T,e as f}from"./Z5DBBLVJ.js";import{U as j,V as ye,g as X,o as w}from"./DJXREF5L.js";import"./7V34NQ5V.js";var ie=class extends ye{setupDefaultRules(){super.setupDefaultRules();let t=this._root.interfaceColors,e=this.rule.bind(this);e("PercentSeries").setAll({legendLabelText:"{category}",legendValueText:"{valuePercentTotal.formatNumber('0.00p')}",colors:we.new(this._root,{}),width:T,height:T}),e("PieChart").setAll({radius:ee(80),startAngle:-90,endAngle:270}),e("PieSeries").setAll({alignLabels:!0,startAngle:-90,endAngle:270}),e("PieSeries").states.create("hidden",{endAngle:-90,opacity:0}),e("Slice",["pie"]).setAll({position:"absolute",isMeasured:!1,x:0,y:0,toggleKey:"active",tooltipText:"{category}: {valuePercentTotal.formatNumber('0.00p')}",strokeWidth:1,strokeOpacity:1,role:"figure",lineJoin:"round"}),e("Slice",["pie"]).states.create("active",{shiftRadius:20,scale:1}),e("Slice",["pie"]).states.create("hoverActive",{scale:1.04}),e("Slice",["pie"]).states.create("hover",{scale:1.04}),e("RadialLabel",["pie"]).setAll({textType:"aligned",radius:10,text:"{category}: {valuePercentTotal.formatNumber('0.00p')}",paddingTop:5,paddingBottom:5,populateText:!0}),e("Tick",["pie"]).setAll({location:1}),e("SlicedChart").setAll({paddingLeft:10,paddingRight:10,paddingTop:10,paddingBottom:10}),e("FunnelSeries").setAll({startLocation:0,endLocation:1,orientation:"vertical",alignLabels:!0,sequencedInterpolation:!0}),e("FunnelSlice").setAll({interactive:!0,expandDistance:0}),e("FunnelSlice").states.create("hover",{expandDistance:.15}),e("Label",["funnel"]).setAll({populateText:!0,text:"{category}: {valuePercentTotal.formatNumber('0.00p')}",centerY:f}),e("Label",["funnel","horizontal"]).setAll({centerX:0,centerY:f,rotation:-90}),e("Label",["funnel","vertical"]).setAll({centerY:f,centerX:0}),e("Tick",["funnel"]).setAll({location:1}),e("FunnelSlice",["funnel","link"]).setAll({fillOpacity:.5,strokeOpacity:0,expandDistance:-.1}),e("FunnelSlice",["funnel","link","vertical"]).setAll({height:10}),e("FunnelSlice",["funnel","link","horizontal"]).setAll({width:10}),e("PyramidSeries").setAll({valueIs:"area"}),e("FunnelSlice",["pyramid","link"]).setAll({fillOpacity:.5}),e("FunnelSlice",["pyramid","link","vertical"]).setAll({height:0}),e("FunnelSlice",["pyramid","link","horizontal"]).setAll({width:0}),e("FunnelSlice",["pyramid"]).setAll({interactive:!0,expandDistance:0}),e("FunnelSlice",["pyramid"]).states.create("hover",{expandDistance:.15}),e("Label",["pyramid"]).setAll({populateText:!0,text:"{category}: {valuePercentTotal.formatNumber('0.00p')}",centerY:f}),e("Label",["pyramid","horizontal"]).setAll({centerX:0,centerY:f,rotation:-90}),e("Label",["pyramid","vertical"]).setAll({centerY:f,centerX:0}),e("Tick",["pyramid"]).setAll({location:1}),e("FunnelSlice",["pictorial"]).setAll({interactive:!0,tooltipText:"{category}: {valuePercentTotal.formatNumber('0.00p')}"}),e("Label",["pictorial"]).setAll({populateText:!0,text:"{category}: {valuePercentTotal.formatNumber('0.00p')}",centerY:f}),e("Label",["pictorial","horizontal"]).setAll({centerX:0,centerY:f,rotation:-90}),e("Label",["pictorial","vertical"]).setAll({centerY:f,centerX:0}),e("FunnelSlice",["pictorial","link"]).setAll({fillOpacity:.5,width:0,height:0}),e("Tick",["pictorial"]).setAll({location:.5});{let i=e("Graphics",["pictorial","background"]);i.setAll({fillOpacity:.2}),_e(i,"fill",t,"alternativeBackground")}}};var $=class extends ce{_afterNew(){this._defaultThemes.push(ie.new(this._root)),super._afterNew(),this.chartContainer.children.push(this.seriesContainer),this.seriesContainer.children.push(this.bulletsContainer)}_processSeries(t){super._processSeries(t),this.seriesContainer.children.moveValue(this.bulletsContainer,this.seriesContainer.children.length-1)}};Object.defineProperty($,"className",{enumerable:!0,configurable:!0,writable:!0,value:"PercentChart"});Object.defineProperty($,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:ce.classNames.concat([$.className])});var C=class extends ue{constructor(){super(...arguments),Object.defineProperty(this,"slicesContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(re.new(this._root,{position:"absolute",isMeasured:!1}))}),Object.defineProperty(this,"labelsContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(re.new(this._root,{position:"absolute",isMeasured:!1}))}),Object.defineProperty(this,"ticksContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(re.new(this._root,{position:"absolute",isMeasured:!1}))}),Object.defineProperty(this,"_lLabels",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_rLabels",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_hLabels",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"slices",{enumerable:!0,configurable:!0,writable:!0,value:this.addDisposer(this._makeSlices())}),Object.defineProperty(this,"labels",{enumerable:!0,configurable:!0,writable:!0,value:this.addDisposer(this._makeLabels())}),Object.defineProperty(this,"ticks",{enumerable:!0,configurable:!0,writable:!0,value:this.addDisposer(this._makeTicks())})}makeSlice(t){let e=this.slicesContainer.children.push(this.slices.make());return e.on("fill",()=>{this.updateLegendMarker(t)}),e.on("fillPattern",()=>{this.updateLegendMarker(t)}),e.on("stroke",()=>{this.updateLegendMarker(t)}),e._setDataItem(t),t.set("slice",e),this.slices.push(e),e}makeLabel(t){let e=this.labelsContainer.children.push(this.labels.make());return e._setDataItem(t),t.set("label",e),this.labels.push(e),e}_shouldMakeBullet(t){return t.get("value")!=null}makeTick(t){let e=this.ticksContainer.children.push(this.ticks.make());return e._setDataItem(t),t.set("tick",e),this.ticks.push(e),e}_afterNew(){this.fields.push("category","fill"),super._afterNew()}_onDataClear(){let t=this.get("colors");t&&t.reset();let e=this.get("patterns");e&&e.reset()}_prepareChildren(){if(super._prepareChildren(),this._lLabels=[],this._rLabels=[],this._hLabels=[],this._valuesDirty){let t=0,e=0,i=0,s=1/0,r=0;w(this._dataItems,a=>{let l=a.get("valueWorking",0);t+=l,e+=Math.abs(l)}),w(this._dataItems,a=>{let l=a.get("valueWorking",0);l>i&&(i=l),l<s&&(s=l),r++;let n=l/e;e==0&&(n=0),a.setRaw("valuePercentTotal",n*100)}),this.setPrivateRaw("valueLow",s),this.setPrivateRaw("valueHigh",i),this.setPrivateRaw("valueSum",t),this.setPrivateRaw("valueAverage",t/r),this.setPrivateRaw("valueAbsoluteSum",e)}}show(t){let e=Object.create(null,{show:{get:()=>super.show}});return H(this,void 0,void 0,function*(){let i=[];i.push(e.show.call(this,t)),i.push(this._sequencedShowHide(!0,t)),yield Promise.all(i)})}hide(t){let e=Object.create(null,{hide:{get:()=>super.hide}});return H(this,void 0,void 0,function*(){let i=[];i.push(e.hide.call(this,t)),i.push(this._sequencedShowHide(!1,t)),yield Promise.all(i)})}_updateChildren(){super._updateChildren(),this._valuesDirty&&w(this._dataItems,t=>{t.get("label").text.markDirtyText()}),(this.isDirty("legendLabelText")||this.isDirty("legendValueText"))&&w(this._dataItems,t=>{this.updateLegendValue(t)}),this._arrange()}_arrange(){this._arrangeDown(this._lLabels),this._arrangeUp(this._lLabels),this._arrangeDown(this._rLabels),this._arrangeUp(this._rLabels),this._arrangeLeft(this._hLabels),this._arrangeRight(this._hLabels),w(this.dataItems,t=>{this._updateTick(t)})}_afterChanged(){super._afterChanged(),this._arrange()}processDataItem(t){if(super.processDataItem(t),t.get("fill")==null){let e=this.get("colors");e&&t.setRaw("fill",e.next())}if(t.get("fillPattern")==null){let e=this.get("patterns");e&&t.setRaw("fillPattern",e.next())}}showDataItem(t,e){let i=Object.create(null,{showDataItem:{get:()=>super.showDataItem}});return H(this,void 0,void 0,function*(){let s=[i.showDataItem.call(this,t,e)];X(e)||(e=this.get("stateAnimationDuration",0));let r=this.get("stateAnimationEasing"),a=t.get("value"),l=t.animate({key:"valueWorking",to:a,duration:e,easing:r});l&&s.push(l.waitForStop());let n=t.get("tick");n&&s.push(n.show(e));let u=t.get("label");u&&s.push(u.show(e));let o=t.get("slice");o&&s.push(o.show(e)),o.get("active")&&o.states.applyAnimate("active"),yield Promise.all(s)})}hideDataItem(t,e){let i=Object.create(null,{hideDataItem:{get:()=>super.hideDataItem}});return H(this,void 0,void 0,function*(){let s=[i.hideDataItem.call(this,t,e)],r=this.states.create("hidden",{});X(e)||(e=r.get("stateAnimationDuration",this.get("stateAnimationDuration",0)));let a=r.get("stateAnimationEasing",this.get("stateAnimationEasing")),l=t.animate({key:"valueWorking",to:0,duration:e,easing:a});l&&s.push(l.waitForStop());let n=t.get("tick");n&&s.push(n.hide(e));let u=t.get("label");u&&s.push(u.hide(e));let o=t.get("slice");o.hideTooltip(),o&&s.push(o.hide(e)),yield Promise.all(s)})}disposeDataItem(t){super.disposeDataItem(t);let e=t.get("label");e&&(this.labels.removeValue(e),e.dispose());let i=t.get("tick");i&&(this.ticks.removeValue(i),i.dispose());let s=t.get("slice");s&&(this.slices.removeValue(s),s.dispose())}hoverDataItem(t){let e=t.get("slice");e&&!e.isHidden()&&e.hover()}unhoverDataItem(t){let e=t.get("slice");e&&e.unhover()}updateLegendMarker(t){if(t){let e=t.get("slice");if(e){let i=t.get("legendDataItem");if(i){let s=i.get("markerRectangle");w(de,r=>{e.get(r)!=null&&s.set(r,e.get(r))})}}}}_arrangeDown(t){if(t){let e=this._getNextDown();t.sort((i,s)=>i.y>s.y?1:i.y<s.y?-1:0),w(t,i=>{let s=i.label.adjustedLocalBounds(),r=s.top;i.y+r<e&&(i.y=e-r),i.label.set("y",i.y),e=i.y+s.bottom})}}_getNextUp(){return this.labelsContainer.maxHeight()}_getNextDown(){return 0}_arrangeUp(t){if(t){let e=this._getNextUp();t.sort((i,s)=>i.y<s.y?1:i.y>s.y?-1:0),w(t,i=>{let s=i.label.adjustedLocalBounds(),r=s.bottom;i.y+r>e&&(i.y=e-r),i.label.set("y",i.y),e=i.y+s.top})}}_arrangeRight(t){if(t){let e=0;t.sort((i,s)=>i.y>s.y?1:i.y<s.y?-1:0),w(t,i=>{let s=i.label.adjustedLocalBounds(),r=s.left;i.y+r<e&&(i.y=e-r),i.label.set("x",i.y),e=i.y+s.right})}}_arrangeLeft(t){if(t){let e=this.labelsContainer.maxWidth();t.sort((i,s)=>i.y<s.y?1:i.y>s.y?-1:0),w(t,i=>{let s=i.label.adjustedLocalBounds(),r=s.right;i.y+r>e&&(i.y=e-r),i.label.set("x",i.y),e=i.y+s.left})}}_updateSize(){super._updateSize(),this.markDirty()}_updateTick(t){}_dispose(){super._dispose();let t=this.chart;t&&t.series.removeValue(this)}};Object.defineProperty(C,"className",{enumerable:!0,configurable:!0,writable:!0,value:"PercentSeries"});Object.defineProperty(C,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:ue.classNames.concat([C.className])});var G=class extends ${constructor(){super(...arguments),Object.defineProperty(this,"_maxRadius",{enumerable:!0,configurable:!0,writable:!0,value:1})}_afterNew(){super._afterNew(),this.seriesContainer.setAll({x:f,y:f})}_prepareChildren(){super._prepareChildren();let t=this.chartContainer,e=t.innerWidth(),i=t.innerHeight(),s=this.get("startAngle",0),r=this.get("endAngle",0),a=this.get("innerRadius"),l=he(0,0,s,r,1),n=e/(l.right-l.left),u=i/(l.bottom-l.top),o={left:0,right:0,top:0,bottom:0};if(a instanceof ge){let p=a.value,g=Math.min(n,u);p=Math.max(g*p,g-Math.min(i,e))/g,o=he(0,0,s,r,p),this.setPrivateRaw("irModifyer",p/a.value)}l=be([l,o]);let m=this._maxRadius;this._maxRadius=Math.min(n,u);let h=k(this.get("radius",0),this._maxRadius);this.seriesContainer.setAll({dy:-h*(l.bottom+l.top)/2,dx:-h*(l.right+l.left)/2}),(this.isDirty("startAngle")||this.isDirty("endAngle")||m!=this._maxRadius)&&this.series.each(p=>{p._markDirtyKey("startAngle")}),(this.isDirty("innerRadius")||this.isDirty("radius"))&&this.series.each(p=>{p._markDirtyKey("innerRadius")})}radius(t){let e=k(this.get("radius",0),this._maxRadius),i=k(this.get("innerRadius",0),e);if(t){let s=this.series.indexOf(t),r=this.series.length,a=t.get("radius");return a!=null?i+k(a,e-i):i+(e-i)/r*(s+1)}return e}innerRadius(t){let e=this.radius(),i=k(this.get("innerRadius",0),e);if(i<0&&(i=e+i),t){let s=this.series.indexOf(t),r=this.series.length,a=t.get("innerRadius");return a!=null?i+k(a,e-i):i+(e-i)/r*s}return i}_updateSize(){super._updateSize(),this.markDirtyKey("radius")}};Object.defineProperty(G,"className",{enumerable:!0,configurable:!0,writable:!0,value:"PieChart"});Object.defineProperty(G,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:$.classNames.concat([G.className])});var U=class extends C{_makeSlices(){return new R(j.new({}),()=>ve._new(this._root,{themeTags:O(this.slices.template.get("themeTags",[]),["pie","series"])},[this.slices.template]))}_makeLabels(){return new R(j.new({}),()=>xe._new(this._root,{themeTags:O(this.labels.template.get("themeTags",[]),["pie","series"])},[this.labels.template]))}_makeTicks(){return new R(j.new({}),()=>ae._new(this._root,{themeTags:O(this.ticks.template.get("themeTags",[]),["pie","series"])},[this.ticks.template]))}processDataItem(t){super.processDataItem(t);let e=this.makeSlice(t);e.on("scale",()=>{this._updateTick(t)}),e.on("shiftRadius",()=>{this._updateTick(t)}),e.events.on("positionchanged",()=>{this._updateTick(t)});let i=this.makeLabel(t);i.events.on("positionchanged",()=>{this._updateTick(t)}),this.makeTick(t),e.events.on("positionchanged",()=>{i.markDirty()})}_getNextUp(){let t=this.chart;return t?t._maxRadius:this.labelsContainer.maxHeight()/2}_getNextDown(){let t=this.chart;return t?-t._maxRadius:-this.labelsContainer.maxHeight()/2}_prepareChildren(){super._prepareChildren();let t=this.chart;if(t){if(this.isDirty("alignLabels")){let e=this.labels.template;if(this.get("alignLabels"))e.set("textType","aligned");else{let i=e.get("textType");(i==null||i=="aligned")&&e.set("textType","adjusted")}}if(this._valuesDirty||this.isDirty("radius")||this.isDirty("innerRadius")||this.isDirty("startAngle")||this.isDirty("endAngle")||this.isDirty("alignLabels")){this.markDirtyBounds();let e=this.get("startAngle",t.get("startAngle",-90)),s=this.get("endAngle",t.get("endAngle",270))-e,r=e,a=t.radius(this);this.setPrivateRaw("radius",a);let l=t.innerRadius(this)*t.getPrivate("irModifyer",1);l<0&&(l=a+l),w(this._dataItems,n=>{this.updateLegendValue(n);let u=s*n.get("valuePercentTotal")/100,o=n.get("slice");if(o){o.set("radius",a),o.set("innerRadius",l),o.set("startAngle",r),o.set("arc",u);let p=n.get("fill");o._setDefault("fill",p),o._setDefault("stroke",p);let g=n.get("fillPattern");o._setDefault("fillPattern",g)}let m=me(r+u/2),h=n.get("label");if(h&&(h.setPrivate("radius",a),h.setPrivate("innerRadius",l),h.set("labelAngle",m),h.get("textType")=="aligned")){let p=a+h.get("radius",0),g=a*P(m);m>90&&m<=270?(!h.isHidden()&&!h.isHiding()&&this._lLabels.push({label:h,y:g}),p*=-1,p-=this.labelsContainer.get("paddingLeft",0),h.set("centerX",T),h.setPrivateRaw("left",!0)):(!h.isHidden()&&!h.isHiding()&&this._rLabels.push({label:h,y:g}),p+=this.labelsContainer.get("paddingRight",0),h.set("centerX",0),h.setPrivateRaw("left",!1)),h.set("x",p),h.set("y",a*P(m))}r+=u,this._updateTick(n)})}}}_updateTick(t){let e=t.get("tick"),i=t.get("label"),s=t.get("slice"),r=e.get("location",1);if(e&&i&&s){let a=(s.get("shiftRadius",0)+s.get("radius",0))*s.get("scale",1)*r,l=i.get("labelAngle",0),n=A(l),u=P(l),o=this.labelsContainer,m=o.get("paddingLeft",0),h=o.get("paddingRight",0),p=0,g=0;p=i.x(),g=i.y();let c=[];if(p!=0||g!=0){if(i.get("textType")=="circular"){let y=i.radius()-i.get("paddingBottom",0),_=i.get("labelAngle",0);p=y*A(_),g=y*P(_)}let b=-h;i.getPrivate("left")&&(b=m),c=[{x:s.x()+a*n,y:s.y()+a*u},{x:p+b,y:g},{x:p,y:g}]}e.set("points",c)}}_positionBullet(t){let e=t.get("sprite");if(e){let s=e.dataItem.get("slice");if(s){let r=s.get("innerRadius",0),a=s.get("radius",0),l=s.get("startAngle",0),n=s.get("arc",0),u=t.get("locationX",.5),o=t.get("locationY",.5),m=l+n*u,h=r+(a-r)*o;e.setAll({x:A(m)*h,y:P(m)*h})}}}};Object.defineProperty(U,"className",{enumerable:!0,configurable:!0,writable:!0,value:"PieSeries"});Object.defineProperty(U,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:C.classNames.concat([U.className])});var M=class extends q{constructor(){super(...arguments),Object.defineProperty(this,"_projectionDirty",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_tlx",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_tly",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_trx",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_try",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_blx",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_bly",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_brx",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_bry",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_cprx",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_cplx",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_cpry",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_cply",{enumerable:!0,configurable:!0,writable:!0,value:0})}_afterNew(){super._afterNew(),this.set("draw",t=>{let e=this.width(),i=this.height(),s=Math.min(e,i)/2,r=k(this.get("cornerRadiusTL",0),s),a=k(this.get("cornerRadiusTR",0),s),l=k(this.get("cornerRadiusBR",0),s),n=k(this.get("cornerRadiusBL",0),s),u=this._trx,o=this._try,m=this._tlx,h=this._tly,p=this._brx,g=this._bry,c=this._blx,b=this._bly;o==h&&(o=o-.01),g==b&&(g=g-.01);let y=te({x:m,y:h},{x:u,y:o}),_=te({x:u,y:o},{x:p,y:g}),x=te({x:p,y:g},{x:c,y:b}),d=te({x:c,y:b},{x:m,y:h});this.get("orientation")=="horizontal"?(r=Math.min(r,Math.abs(h-o)/2),a=Math.min(a,Math.abs(h-o)/2),l=Math.min(l,Math.abs(b-g)/2),n=Math.min(n,Math.abs(b-g)/2)):(r=Math.min(r,Math.abs(m-u)/2),a=Math.min(a,Math.abs(m-u)/2),l=Math.min(l,Math.abs(c-p)/2),n=Math.min(n,Math.abs(c-p)/2));let D=m-r*v((y-d)/2)*A(d),S=h-r*v((y-d)/2)*P(d),Y=m-r*v((d-y)/2)*A(y),Z=h-r*v((d-y)/2)*P(y),N=u-a*v((_-y)/2)*A(y),ne=o-a*v((_-y)/2)*P(y),z=u-a*v((y-_)/2)*A(_),B=o-a*v((y-_)/2)*P(_),J=p-l*v((x-_)/2)*A(_),F=g-l*v((x-_)/2)*P(_),Q=p-l*v((_-x)/2)*A(x),I=g-l*v((_-x)/2)*P(x),pe=c-n*v((d-x)/2)*A(x),se=b-n*v((d-x)/2)*P(x),oe=c-n*v((x-d)/2)*A(d),Ae=b-n*v((x-d)/2)*P(d);t.moveTo(Y,Z),t.lineTo(N,ne),t.arcTo(u,o,z,B,a),t.quadraticCurveTo(this._cprx,this._cpry,J,F),t.arcTo(p,g,Q,I,l),t.lineTo(pe,se),t.arcTo(c,b,oe,Ae,n),t.quadraticCurveTo(this._cplx,this._cply,D,S),t.arcTo(m,h,Y,Z,r)})}getPoint(t,e){let i=this.width(),s=this.height(),r=this.get("topWidth",0),a=this.get("bottomWidth",0);if(this.get("orientation")=="vertical"){let l=-r/2,n=r/2,u=a/2,o=-a/2,m=l+(o-l)*e,h=n+(u-n)*e;return{x:m+(h-m)*t,y:s*e}}else{let l=-r/2,n=r/2,u=a/2,o=-a/2,m=l+(o-l)*t,h=n+(u-n)*t;return{x:i*t,y:m+(h-m)*e}}}_changed(){if(this.isDirty("topWidth")||this.isDirty("bottomWidth")||this.isDirty("expandDistance")||this.isDirty("orientation")||this.isDirty("width")||this.isDirty("height")){let t=this.width(),e=this.height(),i=this.get("topWidth",0),s=this.get("bottomWidth",0);this._clear=!0;let r=this.get("expandDistance",0);this.get("orientation")=="vertical"?(this._tlx=-i/2,this._tly=0,this._trx=i/2,this._try=0,this._brx=s/2,this._bry=e,this._blx=-s/2,this._bly=e,this._cprx=this._trx+(this._brx-this._trx)/2+r*e,this._cpry=this._try+.5*e,this._cplx=this._tlx+(this._blx-this._tlx)/2-r*e,this._cply=this._tly+.5*e):(this._tly=i/2,this._tlx=0,this._try=-i/2,this._trx=0,this._bry=-s/2,this._brx=t,this._bly=s/2,this._blx=t,this._cpry=this._try+(this._bry-this._try)/2-r*t,this._cprx=this._trx+.5*t,this._cply=this._tly+(this._bly-this._tly)/2+r*t,this._cplx=this._tlx+.5*t)}super._changed()}};Object.defineProperty(M,"className",{enumerable:!0,configurable:!0,writable:!0,value:"FunnelSlice"});Object.defineProperty(M,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:q.classNames.concat([M.className])});var W=class extends C{constructor(){super(...arguments),Object.defineProperty(this,"_tag",{enumerable:!0,configurable:!0,writable:!0,value:"funnel"}),Object.defineProperty(this,"links",{enumerable:!0,configurable:!0,writable:!0,value:this.addDisposer(this._makeLinks())}),Object.defineProperty(this,"_total",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_count",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_nextCoord",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_opposite",{enumerable:!0,configurable:!0,writable:!0,value:!1})}_makeSlices(){return new R(j.new({}),()=>M._new(this._root,{themeTags:O(this.slices.template.get("themeTags",[]),[this._tag,"series","slice",this.get("orientation")])},[this.slices.template]))}_makeLabels(){return new R(j.new({}),()=>fe._new(this._root,{themeTags:O(this.labels.template.get("themeTags",[]),[this._tag,"series","label",this.get("orientation")])},[this.labels.template]))}_makeTicks(){return new R(j.new({}),()=>ae._new(this._root,{themeTags:O(this.ticks.template.get("themeTags",[]),[this._tag,"series","tick",this.get("orientation")])},[this.ticks.template]))}_makeLinks(){return new R(j.new({}),()=>M._new(this._root,{themeTags:O(this.links.template.get("themeTags",[]),[this._tag,"series","link",this.get("orientation")])},[this.links.template]))}makeLink(t){let e=this.slicesContainer.children.push(this.links.make());return e._setDataItem(t),t.set("link",e),this.links.push(e),e}_afterNew(){super._afterNew();let t=this.slicesContainer;t.setAll({isMeasured:!0,position:"relative",width:ee(100),height:ee(100)}),t.onPrivate("width",()=>{this.markDirtySize()}),t.onPrivate("height",()=>{this.markDirtySize()}),this.get("orientation")=="vertical"?this.set("layout",this._root.horizontalLayout):this.set("layout",this._root.verticalLayout)}processDataItem(t){super.processDataItem(t);let e=this.makeSlice(t);e._setDataItem(t),t.set("slice",e),this.makeLink(t);let i=this.makeLabel(t);i.on("x",()=>{this._updateTick(t)}),i.on("y",()=>{this._updateTick(t)}),this.makeTick(t),e.events.on("positionchanged",()=>{i.markDirty()}),e.events.on("boundschanged",()=>{let s=e.dataItem;s&&this._updateTick(s)})}_updateChildren(){this._opposite=!1,this.children.indexOf(this.labelsContainer)==0&&(this._opposite=!0);let t=0,e=0;if(w(this.dataItems,i=>{let s=i.get("value");X(s)&&(e++,s>0?t+=Math.abs(i.get("valueWorking",s)/s):this.get("ignoreZeroValues",!1)||i.isHidden()?e--:t+=1)}),this._total=1/e*t,this._count=e,this.isDirty("alignLabels")&&this._fixLayout(),this._total>0&&(this._valuesDirty||this._sizeDirty)){let i=this.slicesContainer,s;this.get("orientation")=="vertical"?s=i.innerHeight():s=i.innerWidth(),this._nextCoord=this.get("startLocation",0)*s,this.markDirtyBounds();let r=0;w(this._dataItems,a=>{this.updateLegendValue(a),a.set("index",r),r++;let l=a.get("slice"),n=a.get("tick"),u=a.get("label"),o=a.get("link"),m=a.get("fill"),h=a.get("fillPattern");l._setDefault("fill",m),l._setDefault("stroke",m),l._setDefault("fillPattern",h),o._setDefault("fill",m),o._setDefault("stroke",m);let p=a.get("value");X(p)&&(p==0&&this.get("ignoreZeroValues")?(l.setPrivate("visible",!1),n.setPrivate("visible",!1),u.setPrivate("visible",!1)):(l.setPrivate("visible",!0),n.setPrivate("visible",!0),u.setPrivate("visible",!0),this.decorateSlice(a),this.isLast(a)?o.setPrivate("visible",!1):a.isHidden()||o.setPrivate("visible",!0)))})}super._updateChildren()}_fixLayout(){let t=this.get("orientation"),e=this.labelsContainer,i=this.labels.template;this.get("alignLabels")?(e.set("position","relative"),e.setAll({isMeasured:!0}),t=="vertical"?(this.set("layout",this._root.horizontalLayout),i.setAll({centerX:T,x:T})):(this.set("layout",this._root.verticalLayout),i.setAll({centerX:0,x:0}))):(e.setAll({isMeasured:!1,position:"absolute"}),t=="vertical"?(e.setAll({x:f}),i.setAll({centerX:f,x:0})):(e.setAll({y:f}),i.setAll({centerX:f,y:0}))),this.markDirtySize()}getNextValue(t){let e=t.get("index"),i=t.get("valueWorking",0);if(e<this.dataItems.length-1){let s=this.dataItems[e+1];if(i=s.get("valueWorking",0),s.isHidden()||s.get("value")==0&&this.get("ignoreZeroValues"))return this.getNextValue(s)}return i}isLast(t){let e=t.get("index");if(e==this.dataItems.length-1)return!0;for(let i=e+1;i<this.dataItems.length;i++)if(!this.dataItems[i].isHidden())return!1;return!0}decorateSlice(t){let e=this.get("orientation"),i=t.get("slice"),s=t.get("label"),r=t.get("link"),a=this.slicesContainer,l=a.innerWidth(),n=a.innerHeight(),u=l;e=="horizontal"&&(u=n);let o=this.getNextValue(t),m=t.get("value",0),h=Math.abs(t.get("valueWorking",m)),p=this.get("bottomRatio",0),g=this.getPrivate("valueHigh",0),c=1;m!=0?c=h/Math.abs(m):t.isHidden()&&(c=1e-6),this._nextCoord==1/0&&(this._nextCoord=0);let b=h/g*u,y=(h-(h-o)*p)/g*u;i.setAll({topWidth:b,bottomWidth:y,orientation:e}),r.setAll({topWidth:y,bottomWidth:(h-(h-o))/g*u,orientation:e});let _=this.get("startLocation",0),x=this.get("endLocation",1);if(e=="vertical"){let d=r.height()*c;n=n*(x-_)+d,i.set("y",this._nextCoord);let D=Math.min(1e5,Math.max(0,n/this._count*c/this._total-d));i.setAll({height:D,x:l/2});let S=this._nextCoord+D/2;s.set("y",S),this._nextCoord+=D+d,r.setAll({y:this._nextCoord-d,x:l/2})}else{let d=r.width()*c;l=l*(x-_)+d,i.set("x",this._nextCoord);let D=Math.min(1e5,Math.max(0,l/this._count*c/this._total-d));i.setAll({width:D,y:n/2});let S=this._nextCoord+D/2;s.set("x",S),this._nextCoord+=D+d,r.setAll({x:this._nextCoord-d,y:n/2})}}hideDataItem(t,e){let i=Object.create(null,{hideDataItem:{get:()=>super.hideDataItem}});return H(this,void 0,void 0,function*(){return t.get("link").hide(e),i.hideDataItem.call(this,t,e)})}showDataItem(t,e){let i=Object.create(null,{showDataItem:{get:()=>super.showDataItem}});return H(this,void 0,void 0,function*(){return t.get("link").show(e),i.showDataItem.call(this,t,e)})}_updateTick(t){if(this.get("alignLabels")){let e=t.get("tick"),i=t.get("label"),s=t.get("slice");if(e&&s&&i){let r=this.labelsContainer,a=this.slicesContainer,l=e.get("location",.5),n=r.width(),u=r.height(),o=r.get("paddingLeft",0),m=r.get("paddingRight",0),h=r.get("paddingTop",0),p=r.get("paddingBottom",0),g={x:0,y:0},c={x:0,y:0},b={x:0,y:0};this._opposite&&(l=1-l),this.get("orientation")=="vertical"?(g=s.getPoint(l,.5),g.x+=s.x()+a.x(),g.y+=s.y()+a.y(),this._opposite?(c.x=n,c.y=i.y(),b.x=n-o,b.y=c.y):(c.x=a.x()+a.width(),c.y=i.y(),b.x=c.x+n-i.width()-m,b.y=c.y)):(g=s.getPoint(.5,l),g.x+=s.x()+a.x(),g.y+=s.y()+a.y(),this._opposite?(c.y=u,c.x=i.x(),b.y=u-h,b.x=c.x):(c.y=a.y()+a.height(),c.x=i.x(),b.y=c.y+u-i.height()-p,b.x=c.x)),e.set("points",[g,c,b])}}}disposeDataItem(t){super.disposeDataItem(t);let e=t.get("link");e&&(this.links.removeValue(e),e.dispose())}_positionBullet(t){let e=t.get("sprite");if(e){let s=e.dataItem.get("slice");if(s){let r=s.width(),a=s.height(),l=t.get("locationX",.5),n=t.get("locationY",.5),u=0,o=0;this.get("orientation")=="horizontal"?o=a/2:u=r/2,e.setAll({x:s.x()+r*l-u,y:s.y()-o+a*n})}}}};Object.defineProperty(W,"className",{enumerable:!0,configurable:!0,writable:!0,value:"FunnelSeries"});Object.defineProperty(W,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:C.classNames.concat([W.className])});var V=class extends W{constructor(){super(...arguments),Object.defineProperty(this,"_tag",{enumerable:!0,configurable:!0,writable:!0,value:"pyramid"}),Object.defineProperty(this,"_nextSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_prepareChildren(){super._prepareChildren(),this._nextSize=void 0}decorateSlice(t){let e=this.get("orientation"),i=this.slicesContainer,s=t.get("slice"),r=t.get("label"),a=t.get("link"),l=this.get("valueIs","area"),n=this.getPrivate("valueAbsoluteSum",0);if(n==0)return;let u=this.get("startLocation",0),o=this.get("endLocation",1),m=this.get("topWidth",0),h=this.get("bottomWidth",T),p=Math.abs(t.get("valueWorking",0)),g=t.get("value",0),c,b,y=i.innerHeight(),_=i.innerWidth(),x=a.width(),d=a.height();e=="horizontal"&&([_,y]=[y,_],[x,d]=[d,x]);let D=_/2,S=1;g!=0?S=p/Math.abs(g):t.isHidden()&&(S=1e-6),d*=S,y=y*(o-u)-d*(this._count*this._total-1);let Y=k(m,_);X(this._nextSize)||(this._nextSize=Y);let Z=k(h,_),N=this._nextSize,ne=Math.atan2(y,Y-Z),z=Math.tan(Math.PI/2-ne);if(z==0&&(z=1e-8),l=="area"){let se=(Y+Z)/2*y*p/n,oe=Math.abs(N*N-2*se*z);c=(N-Math.sqrt(oe))/z,c>0?b=(2*se-c*N)/c:b=N}else c=y*p/n,b=N-c*z;let B=this._nextCoord+c/2,J=D,F=this._nextCoord,Q=D,I=F+c;e=="vertical"?(r.set("y",B),r.get("opacity")>0&&this._rLabels.push({label:r,y:B}),s.set("height",c)):(r.set("x",B),r.get("opacity")>0&&this._hLabels.push({label:r,y:B}),[J,F]=[F,J],[Q,I]=[I,Q],s.set("width",c)),s.setAll({orientation:e,bottomWidth:b,topWidth:N,x:J,y:F}),a.setAll({orientation:e,x:Q,y:I,topWidth:b,bottomWidth:b}),this._nextSize=b,this._nextCoord+=c+d}};Object.defineProperty(V,"className",{enumerable:!0,configurable:!0,writable:!0,value:"PyramidSeries"});Object.defineProperty(V,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:W.classNames.concat([V.className])});var K=class extends V{constructor(){super(...arguments),Object.defineProperty(this,"_tag",{enumerable:!0,configurable:!0,writable:!0,value:"pictorial"}),Object.defineProperty(this,"seriesMask",{enumerable:!0,configurable:!0,writable:!0,value:q.new(this._root,{position:"absolute",x:f,y:f,centerX:f,centerY:f})}),Object.defineProperty(this,"seriesGraphics",{enumerable:!0,configurable:!0,writable:!0,value:this.slicesContainer.children.push(q.new(this._root,{themeTags:["pictorial","background"],position:"absolute",x:f,y:f,centerX:f,centerY:f}))})}_afterNew(){super._afterNew(),this.set("topWidth",T),this.set("bottomWidth",T),this.set("valueIs","height"),this.slicesContainer.set("mask",this.seriesMask)}_updateScale(){let t=this.slicesContainer,e=t.innerWidth(),i=t.innerHeight(),s=this.seriesMask,r=this.seriesGraphics,a=s.get("scale",1),l=s.localBounds(),n=l.right-l.left,u=l.bottom-l.top;this.get("orientation")=="horizontal"?a=e/n:a=i/u,a!=1/0&&a!=NaN&&(s.set("scale",a),s.set("x",e/2),s.set("y",i/2),r.set("scale",a),r.set("x",e/2),r.set("y",i/2))}_prepareChildren(){if(super._prepareChildren(),this.isDirty("svgPath")){let t=this.get("svgPath");this.seriesMask.set("svgPath",t),this.seriesGraphics.set("svgPath",t)}this._updateScale()}};Object.defineProperty(K,"className",{enumerable:!0,configurable:!0,writable:!0,value:"PictorialStackedSeries"});Object.defineProperty(K,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:V.classNames.concat([K.className])});var E=class extends ${_afterNew(){super._afterNew(),this.seriesContainer.setAll({isMeasured:!0,layout:this._root.horizontalLayout})}};Object.defineProperty(E,"className",{enumerable:!0,configurable:!0,writable:!0,value:"SlicedChart"});Object.defineProperty(E,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:$.classNames.concat([E.className])});export{ie as DefaultTheme,W as FunnelSeries,M as FunnelSlice,$ as PercentChart,C as PercentSeries,K as PictorialStackedSeries,G as PieChart,U as PieSeries,V as PyramidSeries,E as SlicedChart};
