/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
v4.34.3 */
import{a as k}from"./ECCQEKEN.js";import d from"./O7NRKSDP.js";import"./M7RWCXDB.js";import c from"./OLI3SVA3.js";import{a as L}from"./SRCDHGWY.js";import{a as U}from"./RK5LF5NN.js";import b from"./YB6QDWRW.js";import a from"./7S26CSJP.js";import{g as N}from"./MGF5CCZW.js";import"./7QR22OBQ.js";import{b as T}from"./TC4TLAIC.js";import{H as S,I as C,J as P,K as v,M as x,P as O,a as M,b as m,s as g}from"./U4NXTENC.js";import"./7V34NQ5V.js";export default $arcgis.t(([{watch:b},{property:n,subclass:Q},h,{onLocaleChange:X},Z,Y,$,H,ee,te,f,I,{geographicToWebMercator:oe},ie,{project:re},ae,,,R,{a:D,c:w}])=>{var se=M`.arcgis-button{--calcite-icon-color: var(--calcite-color-text-3);--calcite-button-background-color: var(--calcite-color-foreground-1);color:var(--calcite-color-text-3);line-height:var(--calcite-font-line-height-relative-tight);display:flex;flex-flow:column;cursor:pointer;background-color:var(--calcite-color-foreground-1);font-size:var(--calcite-font-size);:hover{--calcite-icon-color: var(--calcite-color-text-1);--calcite-button-background-color: var(--calcite-color-transparent-hover)}calcite-button{width:var(--calcite-spacing-xxxl);height:var(--calcite-spacing-xxxl)}}:host{width:var(--calcite-spacing-xxxl);height:var(--calcite-spacing-xxxl)}`,z=!1,ne={maximumAge:0,timeout:15e3,enableHighAccuracy:!0};function ce(){let t="geolocation"in navigator;return t||console.warn("geolocation-unsupported","Geolocation unsupported."),t}function le(){let t=window.isSecureContext;return t||z||(z=!0,console.warn("insecure-context","Geolocation requires a secure origin.")),t}function pe(){return ce()&&le()}function de(t){return t??=ne,new Promise((e,o)=>{setTimeout(()=>o(new h("geolocation:timeout","getting the current geolocation position timed out")),t?.timeout??15e3),navigator.geolocation.getCurrentPosition(e,o,t??void 0)})}function he(t,e){let{position:o,view:r}=t,i=ue(o)?.coords;if(!i)throw new h("geometry-service:no-coords","Geolocation has no coordinates");let a=me(i);return ge(a,r,e)}function ue(t){let e=t?.coords||{},o={accuracy:e.accuracy,altitude:e.altitude,altitudeAccuracy:e.altitudeAccuracy,heading:e.heading,latitude:e.latitude,longitude:e.longitude,speed:e.speed,toJSON(){return{}}};return t&&{coords:o,timestamp:t.timestamp,toJSON(){return{}}}}function me({longitude:t,latitude:e,altitude:o}){return new te({longitude:t,latitude:e,z:o||void 0,spatialReference:{wkid:4326}})}async function ge(t,e,o){if(!e)return await Promise.resolve(t);let r=e.spatialReference;return r.isWGS84?await Promise.resolve(t):r.isWebMercator?await Promise.resolve(oe(t)):f.isLoaded()?await Promise.resolve(f.execute(t,r)):await fe(o).then(async i=>{if(!i)throw new h("geometry-service:missing-url","Geometry service URL is missing");let a=new ae({geometries:[t],outSpatialReference:r});return(await re(i,a,o))[0]})}async function fe(t){if(I.geometryServiceUrl)return await Promise.resolve(I.geometryServiceUrl);let e=ie.getDefault();try{await e.load(t)}catch{}return e.helperServices?.geometry?.url}var ye=Object.defineProperty,ve=Object.getOwnPropertyDescriptor,p=(t,e,o,r)=>{for(var i=r>1?void 0:r?ve(e,o):e,a=t.length-1,s;a>=0;a--)(s=t[a])&&(i=(r?s(e,o,i):s(i))||i);return r&&i&&ye(e,o,i),i},we=2500;function K(t){let e={type:"CIMVectorMarker",enable:!0,anchorPoint:{x:0,y:0},anchorPointUnits:"Relative",dominantSizeAxis3D:"Y",size:t==="background"?16:14,billboardMode3D:"FaceNearPlane",frame:{xmin:0,ymin:0,xmax:17,ymax:17},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[8.5,0],[7.02,.13],[5.59,.51],[4.25,1.14],[3.04,1.99],[1.99,3.04],[1.14,4.25],[.51,5.59],[.13,7.02],[0,8.5],[.13,9.98],[.51,11.41],[1.14,12.75],[1.99,13.96],[3.04,15.01],[4.25,15.86],[5.59,16.49],[7.02,16.87],[8.5,17],[9.98,16.87],[11.41,16.49],[12.75,15.86],[13.96,15.01],[15.01,13.96],[15.86,12.75],[16.49,11.41],[16.87,9.98],[17,8.5],[16.87,7.02],[16.49,5.59],[15.86,4.25],[15.01,3.04],[13.96,1.99],[12.75,1.14],[11.41,.51],[9.98,.13],[8.5,0]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidStroke",enable:!0,capStyle:"Round",joinStyle:"Round",lineStyle3D:"Strip",miterLimit:10,width:t==="background"?0:2,color:[255,255,255,255]},{type:"CIMSolidFill",enable:!0,color:t==="background"?[0,0,0,66]:[0,122,194,255]}]}}],scaleSymbolsProportionally:!0,respectFrame:!0};return t==="background"&&(e.offsetX=0,e.offsetY=-1),e}var V={type:"CIMPictureMarker",primitiveName:"headingOverride",enable:!0,anchorPoint:{x:0,y:-.5},anchorPointUnits:"Relative",dominantSizeAxis3D:"Y",size:36,billboardMode3D:"FaceNearPlane",invertBackfaceTexture:!0,scaleX:1,textureFilter:"Picture",url:"data:image/png;base64,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"},be=K("layer"),Ae=K("background"),Ee=new ee({data:{type:"CIMSymbolReference",symbol:{type:"CIMPointSymbol",symbolLayers:[be,Ae,V],angleAlignment:"Map"},primitiveOverrides:[{type:"CIMPrimitiveOverride",primitiveName:"headingOverride",propertyName:"Rotation",valueExpressionInfo:{type:"CIMExpressionInfo",title:"Rotation override",expression:"360 - $feature.heading",returnType:"Default"}},{type:"CIMPrimitiveOverride",primitiveName:"headingOverride",propertyName:"TintColor",valueExpressionInfo:{type:"CIMExpressionInfo",title:"TintColor override",expression:"IIF(IsEmpty($feature.heading), [255, 255, 255, 0], [255, 255, 255, 1])",returnType:"Default"}}]}}),c=class extends ${constructor(){super(...arguments),this._geolocationUsable=!0,this.goToLocationEnabled=!0,this.graphic=new H({symbol:Ee}),this.rotationEnabled=!0}initialize(){pe()||(this._geolocationUsable=!1),this.addHandles([b(()=>this.view?.type,()=>this._handleViewTypeChange(),{initial:!0})])}destroy(){this._clearGraphic(),this.view=void 0}_clearGraphic(){let{view:t,graphic:e}=this;t&&e&&t.graphics.remove(e)}_addGraphic(){let{view:t,graphic:e}=this;!t?.graphics||!e||t.graphics.includes(e)||t.graphics.push(e)}_handleViewTypeChange(){V.enable=this.view?.type==="2d"}_getScaleWithinConstraints(t,e){if(!e)return t;if(e.type==="2d"){let{effectiveMaxScale:o,effectiveMinScale:r}=e.constraints;return Math.min(r,Math.max(o,t))}return t}_getScale(t){let{scale:e}=this,o=typeof e=="number"?e:we;return this._getScaleWithinConstraints(o,t)}_getHeading(t,e){let o=e?.spatialReference,r=o?.isWebMercator||o?.isGeographic,i=t.coords?.heading;return!r||typeof i!="number"||Number.isNaN(i)||i<0||i>360?null:i}_addHeading(t){let{heading:e,target:o,view:r}=t;if(!(!r||e===null)){if(r.type==="3d"){o.heading=e;return}r.type==="2d"&&(o.rotation=360-e)}}async _animatePoint(t,e,o,r){let{view:i}=this;if(!this.goToLocationEnabled||!i)return;let a={target:t,scale:e};this.rotationEnabled&&this._addHeading({heading:o,target:a,view:i});let s={signal:r.signal};D(s),this.goToOverride&&i&&this.goToOverride(i,{target:a,options:s}),await i.goTo(a,s)}async updatePosition(t,e){try{let o=this.view,r=await he({position:t,view:o},{signal:e.signal}),{graphic:i}=this,{timestamp:a,coords:s}=t,{accuracy:y,altitude:u,altitudeAccuracy:J,latitude:j,longitude:q,speed:_}=s,E=this._getHeading(t,o),W={timestamp:a,accuracy:y,altitude:u,altitudeAccuracy:J,heading:E,latitude:j,longitude:q,speed:_};i&&(i.geometry=r,i.attributes=W);let B=this._getScale(o);await this._animatePoint(r,B,E,e)}catch(o){if(!w(o))throw new h("geolocation-positioning:invalid-point","Cannot position invalid point",{error:o})}return t}};p([n()],c.prototype,"_geolocationUsable",2);p([n()],c.prototype,"geolocationOptions",2);p([n()],c.prototype,"goToLocationEnabled",2);p([n()],c.prototype,"goToOverride",2);p([n({type:H})],c.prototype,"graphic",2);p([n()],c.prototype,"scale",2);p([n()],c.prototype,"rotationEnabled",2);p([n()],c.prototype,"view",2);c=p([Q("map-components.geolocation.GeolocationPositioning")],c);var Me=Object.defineProperty,Se=Object.getOwnPropertyDescriptor,d=(t,e,o,r)=>{for(var i=r>1?void 0:r?Se(e,o):e,a=t.length-1,s;a>=0;a--)(s=t[a])&&(i=(r?s(e,o,i):s(i))||i);return r&&i&&Me(e,o,i),i},Ce=new Y({icon:"trash",id:"remove-selected-feature",title:"{messages.remove}",className:"esri-icon-trash"});function Pe(t){return new Z({title:t.currentLocation,fieldInfos:[{fieldName:"timestamp",label:t.timestamp,format:{dateFormat:"short-date-short-time"}},{fieldName:"latitude",label:t.latitude,format:{places:4,digitSeparator:!0}},{fieldName:"longitude",label:t.longitude,format:{places:4,digitSeparator:!0}},{fieldName:"accuracy",label:t.accuracy,format:{places:0,digitSeparator:!0}},{fieldName:"altitude",label:t.altitude,format:{places:0,digitSeparator:!0}},{fieldName:"altitudeAccuracy",label:t.altitudeAccuracy,format:{places:0,digitSeparator:!0}},{fieldName:"heading",label:t.heading,format:{places:0,digitSeparator:!0}},{fieldName:"speed",label:t.speed,format:{places:0,digitSeparator:!0}}],actions:[Ce.clone()],content:[{type:"fields"}]})}var l=class extends c{constructor(t){super(t),this.popupEnabled=!0,this.locate=this.locate.bind(this)}initialize(){this.addHandles([X(()=>{let{graphic:t,view:e}=this;t&&e?.graphics?.includes(t)&&this._updatePopupTemplate(t)})])}destroy(){this.cancelLocate()}get state(){return this._geolocationUsable?this.view?.ready?this._locateController?"locating":this.error!=null?"error":"ready":"disabled":"feature-unsupported"}async locate(){if(this.cancelLocate(),this.state==="disabled")throw new h("locate:disabled-state","Cannot locate when disabled.");if(this.state==="feature-unsupported")throw new h("locate:feature-unsupported-state","Cannot locate in unsecure domain.");let t=new AbortController;this._locateController=t,this.error=void 0;try{let e=await de(this.geolocationOptions);if(await this.updatePosition(e,t),this._locateController!==t)return null;let{graphic:o}=this;return o&&this._updatePopupTemplate(o),this._addGraphic(),this.currentPosition=e,this._locateController=void 0,e}catch(e){if(w(e))return null;throw t===this._locateController&&(this._locateController=void 0),this.error=e,e}}cancelLocate(){this._clearGraphic(),this._locateController&&this._locateController.abort(),this._locateController=void 0}_updatePopupTemplate(t){if(!this.popupEnabled)return;let e=Pe(this.messages),o=t!==this.graphic;this.destroyed||o||(t.popupTemplate=e)}};d([n()],l.prototype,"_locateController",2);d([n()],l.prototype,"currentPosition",2);d([n()],l.prototype,"error",2);d([n()],l.prototype,"messages",2);d([n()],l.prototype,"popupEnabled",2);d([n({readOnly:!0})],l.prototype,"state",1);l=d([Q("map-components.locate.LocateViewModel")],l);var F={base:"locate",button:"arcgis-button"},G="gps-off",xe=R(l),A=class extends P{constructor(){super(),this.locateButtonElement=S(),this.messages=L(),this.viewModel=xe(this),this.hideErrorTooltip=()=>{this.isErrorTooltipOpen=!1},this.isErrorTooltipOpen=!1,this.view=this.viewModel.view,this.autoDestroyDisabled=!1,this.geolocationOptions=this.viewModel.geolocationOptions,this.goToLocationDisabled=this.viewModel.goToLocationEnabled,this.goToOverride=this.viewModel.goToOverride,this.graphic=this.viewModel.graphic,this.icon=G,this.popupDisabled=this.viewModel.popupEnabled,this.scale=this.viewModel.scale,this.state=this.viewModel.state,this.arcgisError=g(),this.arcgisPropertyChange=N()("state"),this.arcgisReady=g(),this.arcgisSuccess=g(),this.listenOn(document,"click",this.hideErrorTooltip)}static{this.properties={isErrorTooltipOpen:16,view:0,autoDestroyDisabled:5,geolocationOptions:0,goToLocationDisabled:7,goToOverride:0,graphic:0,icon:1,label:1,messageOverrides:0,popupDisabled:5,position:3,referenceElement:1,scale:9,state:3}}static{this.styles=se}async cancelLocate(){this.viewModel.cancelLocate()}async destroy(){await this.manager.destroy()}async locate(){return await this.viewModel.locate()}loaded(){this.viewModel.messages={...this.messages,...this.messageOverrides},this.manager.onLifecycle(()=>[b(()=>this.viewModel.error,e=>{this.isErrorTooltipOpen=!!e,this.arcgisError.emit({error:e})}),b(()=>this.viewModel.currentPosition,e=>{this.arcgisSuccess.emit({position:e})})])}_localizeError(e){if(e instanceof GeolocationPositionError)return e.code===GeolocationPositionError.PERMISSION_DENIED?this.messages?.permissionError:e.code===GeolocationPositionError.TIMEOUT?this.messages?.timeoutError:this.messages?.positionUnavailable;if(e instanceof Error)return e.message}_locate(){let{viewModel:e}=this;e.state==="locating"?e.cancelLocate():e.locate().catch(()=>{})}render(){let{viewModel:e,icon:o}=this,{state:r}=e,i=r==="locating",a=i?this.messages.cancel:this.messages.title,s=r==="feature-unsupported",y=k===void 0?G:void 0,u=this._localizeError(this.viewModel?.error);return m`<div class=${v(T(F.base,F.button))}>${!s&&m`<calcite-button class=${v(U.widgetButton)} .disabled=${r==="disabled"} .loading=${i} .iconStart=${i?void 0:o??y} kind=neutral .label=${a} @click=${this._locate} title=${a??x} ${C(this.locateButtonElement)}></calcite-button>`||""}${u?m`<calcite-tooltip .open=${this.isErrorTooltipOpen} overlay-positioning=fixed .referenceElement=${this.locateButtonElement.value}>${u}</calcite-tooltip>`:null}</div>`}};O("arcgis-locate",A);return A},"core/reactiveUtils","core/accessorSupport/decorators","core/Error","intl","PopupTemplate","support/actions/ActionButton","core/Accessor","Graphic","symbols/CIMSymbol","geometry/Point","geometry/operators/projectOperator","config","geometry/support/webMercatorUtils","portal/Portal","rest/geometryService","rest/support/ProjectParameters",a,b,c,d)