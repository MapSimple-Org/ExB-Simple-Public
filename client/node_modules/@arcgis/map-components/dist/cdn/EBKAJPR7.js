/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
v4.34.3 */
import{a as n}from"./6HII4BF2.js";import{a as g}from"./SRCDHGWY.js";import"./MGF5CCZW.js";import"./TC4TLAIC.js";import{J as u,P as h,a as d,b as a,s as l}from"./U4NXTENC.js";import"./7V34NQ5V.js";var k=d`:host{min-width:300px}.arcgis-utility-network-trace-inputs calcite-block{--calcite-block-border-color: transparent;margin:0;background-color:transparent}.arcgis-utility-network-trace-inputs calcite-block calcite-label:last-child{--calcite-label-margin-bottom: 0}.arcgis-utility-network-trace-inputs calcite-notice{padding:var(--calcite-spacing-xs)}`,o="map-components:utility-network-trace-inputs",c=class extends u{constructor(){super(...arguments),this.messages=g({blocking:!0}),this.traceConfigurations=[],this._state="ready",this.arcgisTraceInputsChange=l(),this.arcgisUtilityNetworkChange=l()}static{this.properties={traceConfigurations:16,utilityNetworks:16,_state:16,view:0,selectedUtilityNetwork:0,selectedTraceConfiguration:0,referenceElement:1}}static{this.styles=k}load(){this._setupUtilityNetwork()}willUpdate(t){let{utilityNetworks:e,selectedUtilityNetwork:i}=this;(t.has("utilityNetworks")||!e||e.length===0||!i||!e?.includes(i))&&this._handleUtilityNetworksChange(),t.has("selectedUtilityNetwork")&&(this.arcgisUtilityNetworkChange.emit(),this._setupTraceConfigurations()),t.has("selectedTraceConfiguration")&&(this.arcgisTraceInputsChange.emit(),this._handleTraceConfigChange())}_handleSubnetworkTraceConfigChange(t){if(!t.traceConfiguration){console.error(`${o} - Trace configuration not found`);return}}_selectTraceConfigurationByGuid(t){let e=this.selectedUtilityNetwork?.sharedNamedTraceConfigurations.find(i=>i.globalId===t);if(!e){console.error(`${o} - Trace configuration not found`);return}this.selectedTraceConfiguration=e}_handleTraceConfigChange(){let{selectedTraceConfiguration:t}=this;if(t)switch(t.traceType){case"subnetwork":this._handleSubnetworkTraceConfigChange(t);break;default:console.error(`${o} - Unknown trace configuration type`)}}async _setupTraceConfigurations(){await this.selectedUtilityNetwork?.load(),this.traceConfigurations=this.selectedUtilityNetwork?.sharedNamedTraceConfigurations||[],this.selectedTraceConfiguration=this.traceConfigurations.at(0)}_handleUtilityNetworksChange(){let{utilityNetworks:t}=this;if(!t||t.length===0){this._state="error",console.error(`${o} - No utility networks found in the map`);return}(!this.selectedUtilityNetwork||!t.includes(this.selectedUtilityNetwork))&&(this.selectedUtilityNetwork=t.at(0))}async _setupUtilityNetwork(){if(this.view?.map){let t=this.view.map;await t.load(),this.utilityNetworks=t.utilityNetworks||void 0}else this._state="disabled",console.error(`${o} - No view or map available to load utility networks`)}renderError(t,e=!1){return a`<calcite-notice .closable=${e} kind=danger open scale=s width=full><div slot=message>${t}</div></calcite-notice>`}renderLoader(){return a`<calcite-loader label=loading></calcite-loader>`}renderTraceSelection(){let{messages:t,traceConfigurations:e}=this,i=t.labels.traceConfiguration;if(e.length===0)return this.renderError(t.errors.noTraceConfigurationError,!0);let r=n(e,s=>s.globalId,s=>a`<calcite-option .value=${s.globalId}>${s.title}</calcite-option>`);return a`<calcite-label>${i}<calcite-select .label=${i} .value=${this.selectedTraceConfiguration?.globalId||void 0} @calciteSelectChange=${s=>{this._selectTraceConfigurationByGuid(s.target.value)}}>${r}</calcite-select></calcite-label>`}renderUtilityNetworkSelection(){let{messages:t}=this,e=t.labels.utilityNetwork,i=n(this.utilityNetworks,r=>r.id,r=>a`<calcite-option .value=${r.id}>${r.title}</calcite-option>`);return a`<calcite-label>${e}<calcite-select .label=${e} .value=${this.selectedUtilityNetwork?.id} @calciteSelectChange=${r=>{this.selectedUtilityNetwork?.id!==r.target.value&&(this.selectedUtilityNetwork=this.utilityNetworks?.find(s=>s.id===r.target.value))}}>${i}</calcite-select></calcite-label>`}renderContent(){let{messages:t,utilityNetworks:e}=this;return!e||e.length===0?this.renderError(t.errors.noUtilityNetworkError):a`${e.length===1?null:this.renderUtilityNetworkSelection()}${this.selectedUtilityNetwork?.loaded?this.renderTraceSelection():this.renderLoader()}`}render(){let{messages:t,_state:e}=this;return a`<div class="arcgis-utility-network-trace-inputs"><calcite-block expanded .label=${t.labels.traceInputs}>${e==="disabled"?this.renderError(t.errors.noMapError):this.renderContent()}</calcite-block></div>`}};h("arcgis-utility-network-trace-inputs",c);export{c as ArcgisUtilityNetworkTraceInputs};
