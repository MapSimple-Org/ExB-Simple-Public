/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
v4.34.3 */
import{a as C}from"./MWPCQM2X.js";import{a as b}from"./XIZLMN6F.js";import{b as S,c as T}from"./JHAJCFXL.js";import e from"./MSRS6EXP.js";import{h as a}from"./TLMHEFBH.js";import{a as f}from"./BMZ5OG4J.js";import d from"./TNMDYW24.js";import c from"./GUWCFIQ4.js";import{j as L,q as P}from"./MHMLEVRX.js";import"./DXCHSVBP.js";import{c as r}from"./5BG7WW2E.js";import"./2YIVYDK5.js";import{A as o,F as y,g as v,h as s,l as h,w as g,x as p,y as $}from"./GRWAOK3Y.js";import"./UUMP6K6L.js";export default $arcgis.t(([,,,,,,,{Qa:F,mc:w,oc:I,ya:x},,{a:D,d:u,k:d,o:E}])=>{var l={jsAppFlyout:"js-app-flyout",name:"pie-chart-data-popover",numericFieldPickList:"pie-chart-data-numeric-fields-pick-list",header:"header",fab:"fab",pickListItemLabel:"pick-list-item-label",flipClass:"sort-counter-clockwise",panel:"panel"},A=v`.hide{display:none}.am5-modal{width:100%;height:100%;position:absolute;z-index:100000;top:0;left:0}.am5-modal-curtain{top:0;left:0;width:100%;height:100%;position:absolute;background:#fff!important;z-index:100}.am5-modal-wrapper{top:0;left:0;width:100%;height:100%;position:absolute;display:flex;align-items:center;justify-content:center;white-space:nowrap;background:#ffffff80;z-index:101}.am5-modal-content{display:inline-block;padding:1.2em;vertical-align:middle;text-align:start;white-space:normal;background:#fff;border-radius:4px;box-shadow:#00000073 0 0 36px;color:#000}.am5-layer-1000{z-index:1000!important}.am5-layer-30{z-index:100!important}.arcgis-charts-modal{box-shadow:none!important}.arcgis-charts-modal-header{background-color:#0000000d;font-weight:700;padding:4px;align-content:center}.show{display:block}.notifyPanel{flex:0 1 auto}.disable-interactions{pointer-events:none}.dim-text{color:var(--arcgis-charts-dim-text)}.name{display:flex;flex-direction:column;margin:.5rem;padding:.5rem;background:#fff;min-width:250px}.header{margin:0;font-weight:bolder}.fab{display:flex;justify-content:stretch}.pick-list-item-label{font-size:small}.sort-icon-color{color:#000}.sort-counter-clockwise{transform:scaleX(-1)}.panel{max-height:60vh}`,k=class extends ${constructor(){super(...arguments),this._messages=f(),this.commonStrings=f({name:"common",blocking:!0}),this.picklist=g(),this.popoverElement=g(),this.placement="leading",this.offsetDistance=-200,this.pickListHasChanged=!1,this.aggregationLabels=[],this.layerFieldsInfo=[],this.arcgisChartsConfigPieChartDataPopoverChange=h(),this.arcgisChartsConfigPopoverClose=h()}static{this.properties={aggregationLabels:16,messageOverrides:0,headingTitle:3,referenceElement:2,open:7,contentKind:1,layerFieldsInfo:0,selectedContent:1}}static{this.styles=A}async reposition(){await this.popoverElement.value?.reposition()}willUpdate(e){e.has("selectedContent")&&this.selectedContentChange(this.selectedContent,e.get("selectedContent"));let t=u.map(i=>x(i,this.commonStrings));L(this.aggregationLabels,t)||(this.aggregationLabels=t)}updated(){S(this.popoverElement.value,this.open),setTimeout(async()=>{await this.picklist.value?.setFocus()},D.PopoverTimer)}selectedContentChange(e,t){this.pickListHasChanged=T(e,t)}buildAggregationPickListItems(){return C(u,e=>e,(e,t)=>s`<calcite-list-item .label=${this.aggregationLabels[t]} .value=${e} .selected=${d(e,this.selectedContent)}></calcite-list-item>`)}buildSortOrder(){let e=Object.keys(r);return e.splice(e.indexOf(r.customSort),1),C(e,t=>t,t=>{let i="string",c="rotate",n="";switch(t){case r.labelAsc:i="string";break;case r.labelDesc:i="string",n=l.flipClass;break;case r.valueAsc:i="number";break;case r.valueDesc:i="number",n=l.flipClass;break;case r.customSort:}return s`<calcite-list-item .selected=${this.selectedContent===t} .label=${this._messages[t]} .value=${r[t]}><calcite-icon slot=content-end .icon=${i}></calcite-icon><calcite-icon class=${o(n)} slot=content-end .icon=${c}></calcite-icon></calcite-list-item>`})}buildPickListItem(e){return b(e.name,s`<calcite-list-item .label=${F(this.layerFieldsInfo,e.name)} .value=${e.name} .selected=${d(e.name,this.selectedContent)}></calcite-list-item>`)}buildPickListItems(e){let t=this.layerFieldsInfo?.length??0,i=[];switch(e){case a.numericFields:{for(let c=0;c<t;c+=1){let n=this.layerFieldsInfo[c];w(n)&&i.push(this.buildPickListItem(n))}break}case a.category:{let c=b(" ",s`<calcite-list-item label=" " value=" " .selected=${d("",this.selectedContent)}></calcite-list-item>`);i.push(c);for(let n=0;n<t;n+=1){let m=this.layerFieldsInfo[n];(I(m)||m.type===P.String)&&i.push(this.buildPickListItem(m))}break}}return i}closePopover(){if(this.contentKind===a.numericFields&&this.pickListHasChanged){let e={pickListElement:this.picklist.value,eventEmitter:this.arcgisChartsConfigPieChartDataPopoverChange,contentKind:this.contentKind};E(e)}this.arcgisChartsConfigPopoverClose.emit()}onDataContentTypeChange(e){this.pickListHasChanged=!0;let t=e.target.selectedItems;this.arcgisChartsConfigPieChartDataPopoverChange.emit({contentKind:this.contentKind,value:t.map(i=>i.value)}),this.open=!1}onNumericFieldsChange(e){e.target!==null&&(this.selectedContent=e.target.selectedItems.map(t=>t.value))}onNumericFieldSelectionDone(){this.pickListHasChanged&&this.closePopover()}renderAggregationType(){let e=this.buildAggregationPickListItems();return s`<calcite-list label class=${o(l.pickListItemLabel)} selection-mode=single selection-appearance=border @calciteListChange=${this.onDataContentTypeChange}>${e}</calcite-list>`}renderCategory(){let e=this.buildPickListItems(a.category);return s`<calcite-list label class=${o(l.pickListItemLabel)} selection-mode=single selection-appearance=border filter-enabled @calciteListChange=${this.onDataContentTypeChange} ${p(this.picklist)}>${e}</calcite-list>`}renderNumericFields(){let e=this.buildPickListItems(a.numericFields);return s`<calcite-list label class=${o(l.numericFieldPickList)} selection-mode=multiple filter-enabled @calciteListChange=${this.onNumericFieldsChange} ${p(this.picklist)}>${e}</calcite-list>`}renderSortOrder(){let e=this.buildSortOrder();return s`<calcite-list label selection-mode=single selection-appearance=border @calciteListChange=${this.onDataContentTypeChange}>${e}</calcite-list>`}renderPopoverInfo(){let e;switch(this.contentKind){case a.aggregation:e=this.renderAggregationType();break;case a.category:e=this.renderCategory();break;case a.numericFields:e=this.renderNumericFields();break;case a.sortOrder:e=this.renderSortOrder();break}return e}render(){let e;return this.contentKind===a.numericFields&&(e=s`<div slot=footer><calcite-fab class=${o(l.fab)} appearance=outline-fill kind=neutral icon .label=${this._messages.selectionDone} scale=s text-enabled .text=${this._messages.selectionDone} @click=${this.onNumericFieldSelectionDone}></calcite-fab></div>`),s`<div class=${o(l.jsAppFlyout)}><calcite-popover class=${o(l.name)} .referenceElement=${this.referenceElement??document.body} .placement=${this.placement} @calcitePopoverClose=${this.closePopover} .offsetDistance=${this.offsetDistance} .open=${this.open} label auto-close ${p(this.popoverElement)}><calcite-panel class=${o(l.panel)} closable .closed=${!this.open} @calcitePanelClose=${this.closePopover}><div slot=header-content class=${o(l.header)}>${this.headingTitle??""}</div>${this.renderPopoverInfo()}${e}</calcite-panel></calcite-popover></div>`}};y("arcgis-charts-config-pie-chart-popover",k);return k},"geometry/support/jsonUtils","rest/support/AttributeBinsQuery","rest/support/Query","rest/support/StatisticDefinition","time/TimeExtent","core/promiseUtils","request",c,d,e)