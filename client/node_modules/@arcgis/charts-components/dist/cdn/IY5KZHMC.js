/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
v4.34.3 */
import{a as L}from"./MWPCQM2X.js";import{a as P}from"./XIZLMN6F.js";import{a as v}from"./JHAJCFXL.js";import h from"./MSRS6EXP.js";import"./TLMHEFBH.js";import{a as I}from"./BMZ5OG4J.js";import f from"./JQSIPEYW.js";import"./PI2NXF2Q.js";import e from"./TNMDYW24.js";import c from"./GUWCFIQ4.js";import"./MHMLEVRX.js";import"./DXCHSVBP.js";import"./5BG7WW2E.js";import{b as C,f as r}from"./2YIVYDK5.js";import{A as a,B as d,D as p,F as y,g as b,h as o,l as g,y as $}from"./GRWAOK3Y.js";import"./UUMP6K6L.js";export default $arcgis.t(([,,,,,,,{Ha:k},,u,{r:x}])=>{var _={stackedType:"stacked-type"},l={topSection:"top-section",sectionLabel:"section-label",list:"list",disabledInfo:"disabled-info",disabledStackingOption:"disabled-stacking-option"},E=b`:host{display:flex;flex-direction:column;width:var(--arcgis-charts-config-calcite-block-default-width);margin:var(--arcgis-charts-config-calcite-block-default-margin)}.top-section{margin-top:var(--arcgis-charts-config-margin-minor)}.section-label{display:flex;margin-bottom:var(--arcgis-charts-config-margin-major);margin-left:var(--arcgis-charts-config-margin-minor);margin-right:var(--arcgis-charts-config-margin-minor);justify-content:space-between;align-items:center;font-weight:var(--calcite-font-weight-medium);font-size:var(--calcite-font-size-0)}.list{margin-left:var(--arcgis-charts-config-margin-minor);margin-right:var(--arcgis-charts-config-margin-minor);margin-bottom:var(--arcgis-charts-config-margin-major)}.disabled-info{margin:auto 1rem;pointer-events:auto}.disabled-info:active{margin:auto 1rem;pointer-events:none}.disabled-stacking-option{pointer-events:none;opacity:var(--calcite-opacity-disabled)}`,S=class extends ${constructor(){super(...arguments),this._messages=I(),this.open=!1,this.seriesNameChange=e=>{if(e.detail!==null&&e.detail!==void 0){let t=e.detail?.name;if(this.isNullCategorySelected){let i=this.model.nullCategory;if(i){let s={...i,text:t};this.model.nullCategory=s}}else this.model.setSeriesName(t,this.selectedSeriesIndex??-1)}},this.seriesColorChange=e=>{if(e.detail!==null&&e.detail!==void 0){let{color:t}=e.detail;if(t!==void 0){if(this.isNullCategorySelected){let i=this.model.nullCategory,s=i?.symbol&&{...i,symbol:{...i.symbol,color:t,outline:i.symbol.outline&&{...i.symbol.outline,color:t}}};this.model.nullCategory=s}else this.model.setSeriesColor(t,this.selectedSeriesIndex??-1);this.model.colorMatch=!1}}},this.seriesPopoverClose=e=>{let{selectedSeriesIndex:t}=e.detail;this.selectedSeriesIndex===t&&(this.seriesPopover=v(this.seriesPopover),this.selectedSeriesIndex=void 0)},this.onModelConfigChange=()=>{this.requestUpdate()},this.seriesOrderResetCounter=0,this.activeColorMatch=!1,this.popoverPlacement="leading",this.arcgisChartsConfigDataChangeError=g(),this.arcgisChartsConfigPopoverOpenChange=g()}static{this.properties={seriesOrderResetCounter:16,selectedSeriesIndex:16,messageOverrides:0,model:0,activeColorMatch:5,popoverPlacement:1}}static{this.styles=E}load(){this.modelChange(this.model),this.onModelConfigChange()}willUpdate(e){e.has("model")&&this.modelChange(this.model,e.get("model")),e.has("selectedSeriesIndex")&&this.selectedSeriesIndexChange()}disconnectedCallback(){super.disconnectedCallback(),this.removeSeriesPopover(),this.model.removeEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange)}modelChange(e,t){t?.removeEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange),e?.addEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange)}removeSeriesPopover(){this.seriesPopover!==null&&this.seriesPopover!==void 0&&(this.seriesPopover.open=!1,this.seriesPopover=v(this.seriesPopover))}selectedSeriesIndexChange(){this.selectedSeriesIndex!==void 0&&(this.seriesPopover=p(o`<arcgis-charts-config-bar-chart-series-popover .referenceElement=${this.el} .selectedName=${this.selectedSeriesIndex!=null?this.model.getSeriesName(this.selectedSeriesIndex):void 0} .selectedColor=${this.selectedSeriesIndex!=null?this.model.getSeriesColor(this.selectedSeriesIndex):void 0} .placement=${this.popoverPlacement} .selectedSeriesIndex=${this.selectedSeriesIndex!=null?this.selectedSeriesIndex:void 0} .nullCategory=${this.isNullCategorySelected?this.model.nullCategory:void 0} .open=${this.open} @arcgisChartsConfigSeriesPopoverNameChange=${this.seriesNameChange} @arcgisChartsConfigSeriesPopoverColorChange=${this.seriesColorChange} @arcgisChartsConfigPopoverClose=${this.seriesPopoverClose}></arcgis-charts-config-bar-chart-series-popover>`),this.seriesPopover&&!document.body.contains(this.seriesPopover)&&document.body.appendChild(this.seriesPopover))}buildSeriesListItems(){let e=this.model.seriesLength??0,t=Array.from({length:e},(i,s)=>s);return L(t,i=>this.model.getSeriesId(i),i=>{let s=this.model.getSeriesId(i),n=this.model.getSeriesColor(i),h=this.model.getSeriesName(i),m=this.model.chartSubType===k.BarAndLineFromFields?this._messages.series:s,c="#CCCCCC",f="minus-square";if((e>1||!this.activeColorMatch)&&n!==void 0){f="square-f";let[T,M,N,O]=[...n];c=`rgba(${T},${M},${N},${O/255})`}return o`<calcite-list-item .label=${h??s??""} .description=${m} .value=${s} .selected=${this.selectedSeriesIndex===i} @click=${this.openSeriesPopOver}><calcite-icon .icon=${f} style=${d({color:c})} slot=content-end></calcite-icon></calcite-list-item>`})}buildSeriesList(){return P(this.seriesOrderResetCounter,o`<calcite-list label class=${a(l.list)} drag-enabled selection-mode=single selection-appearance=border @calciteListOrderChange=${this.onCalciteListOrderChange}>${this.buildSeriesListItems()}</calcite-list>`)}buildNullCategoryUI(){let e=this.model.nullCategory,t=this._messages.nullCategory,i=e?.symbol?.color??u.nullCategory?.symbol?.color??u.grayColor,[s,n,h,m]=[...i],c=`rgba(${s},${n},${h},${m/255})`;return o`<calcite-list label class=${a(l.list)} selection-mode=none><calcite-list-item .label=${t} .value=${t} .selected=${this.selectedSeriesIndex===null} @click=${this.openSeriesPopOver}><calcite-icon icon=square-f style=${d({color:c})} slot=content-end></calcite-icon></calcite-list-item></calcite-list>`}buildMultipleBarTypeList(){let e=this.shouldDisableStacking();return e&&this.model.stackedType!==r.Side&&(this.model.stackedType=r.Side),o`<calcite-list label id=${_.stackedType} class=${a(l.list)} selection-mode=single-persist selection-appearance=border @click=${this.onMultipleBarSelect}><calcite-list-item .label=${this._messages.sideBySide} .value=${r.Side} .selected=${this.model.stackedType===void 0||this.model.stackedType===r.Side}><calcite-icon scale=l icon=graph-bar-side-by-side slot=content-start></calcite-icon></calcite-list-item><calcite-list-item class=${a(e?l.disabledStackingOption:"")} .label=${this._messages.stacked} .value=${r.Stacked} .selected=${this.model.stackedType===r.Stacked}><calcite-icon scale=l icon=graph-bar-stacked slot=content-start></calcite-icon>${e&&o`<calcite-icon class=${a(l.disabledInfo)} slot=content-end icon=information scale=s flip-rtl @mouseover=${this.createTooltip} @mouseout=${this.destroyTooltip}></calcite-icon>`||""}</calcite-list-item><calcite-list-item class=${a(e?l.disabledStackingOption:"")} .label=${this._messages.stacked100} .value=${r.Stacked100} .selected=${this.model.stackedType===r.Stacked100}><calcite-icon scale=l icon=graph-bar-100-stacked slot=content-start></calcite-icon>${e&&o`<calcite-icon class=${a(l.disabledInfo)} slot=content-end icon=information scale=s flip-rtl @mouseover=${this.createTooltip} @mouseout=${this.destroyTooltip}></calcite-icon>`||""}</calcite-list-item></calcite-list>`}resetSeriesOriginal(){this.selectedSeriesIndex=void 0,this.model.resetSeriesStyling(),this.seriesOrderResetCounter+=1}onMultipleBarSelect(e){if(!this.shouldDisableStacking()){let t=e.target;this.model.stackedType=t.value??t.parentElement.value??""}}onCalciteListOrderChange(e){if(e.detail!==null&&e.detail!==void 0){let{newIndex:t,oldIndex:i}=e.detail;this.model.moveSeries(i,t),this.seriesOrderResetCounter+=1}}openSeriesPopOver(e){e.stopImmediatePropagation(),this.removeSeriesPopover();let t=e.target,i=t.localName==="calcite-list-item"?t:t.parentNode,s=this.model.getSeriesIndex(i.value);this.open=this.selectedSeriesIndex!==s,this.selectedSeriesIndex=this.selectedSeriesIndex!==s?s:void 0,this.isNullCategorySelected=i.value===this._messages.nullCategory}createTooltip(e){let t=e.target,i=(this.model.aggregationType===C.NoAggregation?this._messages.noAggStackingDisabled:this._messages.singleStackingDisabled)??"";this.tooltip=p(o`<calcite-tooltip style=${d({opacity:1,zIndex:"var(--calcite-floating-ui-z-index)"})} .referenceElement=${t} open placement=top>${i}</calcite-tooltip>`),document.body.appendChild(this.tooltip)}destroyTooltip(){x(this.tooltip)}shouldDisableStacking(){return(this.model.seriesLength??0)<=1||this.model.aggregationType===C.NoAggregation}render(){return o`<div class=${`${l.sectionLabel} ${l.topSection}`}>${this._messages.displayMultiSeries}</div>${this.buildMultipleBarTypeList()}<div class=${a(l.sectionLabel)}>${this._messages.series}<calcite-button @click=${this.resetSeriesOriginal} .disabled=${!this.model.resetAvailable()} appearance=transparent icon-end=reset>${this._messages.reset}</calcite-button></div>${this.buildSeriesList()}${this.model.nullCategory!==void 0&&this.model.fetchNULLValues?this.buildNullCategoryUI():null}`}};y("arcgis-charts-config-bar-chart-series",S);return S},"geometry/support/jsonUtils","rest/support/AttributeBinsQuery","rest/support/Query","rest/support/StatisticDefinition","time/TimeExtent","core/promiseUtils","request",c,e,f,h)