/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
v4.34.3 */
import{a as P,c as L}from"./VZXOTDOW.js";import{a as k}from"./MWPCQM2X.js";import{a as f}from"./XIZLMN6F.js";import{a as p}from"./JHAJCFXL.js";import i from"./MSRS6EXP.js";import{k as a,m as g}from"./TLMHEFBH.js";import{a as O}from"./BMZ5OG4J.js";import e from"./TNMDYW24.js";import d from"./GUWCFIQ4.js";import{j as b}from"./MHMLEVRX.js";import"./DXCHSVBP.js";import{b as c}from"./5BG7WW2E.js";import{a as w}from"./2YIVYDK5.js";import{A as o,D as x,F,g as y,h as l,j as v,l as S,w as m,x as h,y as $}from"./GRWAOK3Y.js";import"./UUMP6K6L.js";export default $arcgis.t(([,,,,,,,{B:d,Qa:u,Ra:I},,{a:B}])=>{var r={label:"label",fieldList:"field-list",fab:"fab",dimText:"dim-text",list:"list",customSortButtons:"custom-sort-buttons"},E=y`.hide{display:none}.am5-modal{width:100%;height:100%;position:absolute;z-index:100000;top:0;left:0}.am5-modal-curtain{top:0;left:0;width:100%;height:100%;position:absolute;background:#fff!important;z-index:100}.am5-modal-wrapper{top:0;left:0;width:100%;height:100%;position:absolute;display:flex;align-items:center;justify-content:center;white-space:nowrap;background:#ffffff80;z-index:101}.am5-modal-content{display:inline-block;padding:1.2em;vertical-align:middle;text-align:start;white-space:normal;background:#fff;border-radius:4px;box-shadow:#00000073 0 0 36px;color:#000}.am5-layer-1000{z-index:1000!important}.am5-layer-30{z-index:100!important}.arcgis-charts-modal{box-shadow:none!important}.arcgis-charts-modal-header{background-color:#0000000d;font-weight:700;padding:4px;align-content:center}.show{display:block}.notifyPanel{flex:0 1 auto}.disable-interactions{pointer-events:none}.dim-text{color:var(--arcgis-charts-dim-text)}:host{display:flex;flex-direction:column;width:var(--arcgis-charts-config-calcite-block-default-width);margin:var(--arcgis-charts-config-calcite-block-default-margin);margin-top:var(--arcgis-charts-top-section-margin)}.label,.disabled-label{display:flex;margin-left:var(--arcgis-charts-config-margin-minor);margin-right:var(--arcgis-charts-config-margin-minor);margin-bottom:var(--arcgis-charts-config-margin-minor);justify-content:space-between}.text{display:flex;margin-left:var(--arcgis-charts-config-margin-minor);width:calc(100% - 1.5rem);height:2rem;margin-bottom:var(--arcgis-charts-config-margin-minor);justify-content:space-between}.field-list{max-height:50vh;overflow-y:auto}.disabled-label{pointer-events:none}.fab{display:flex;margin-left:var(--arcgis-charts-config-margin-minor);margin-right:var(--arcgis-charts-config-margin-minor);margin-bottom:1.5rem;justify-content:center}.list{margin-left:var(--arcgis-charts-config-margin-minor);margin-right:var(--arcgis-charts-config-margin-minor);margin-bottom:var(--arcgis-charts-config-margin-major)}.custom-sort-buttons{display:flex;justify-content:space-between;align-items:center;font-weight:var(--calcite-font-weight-medium);font-size:var(--calcite-font-size-0)}`,C=class extends ${constructor(){super(...arguments),this._messages=O(),this.boxPlotPopover=null,this.categoryElement=m(),this.numericFieldsElement=m(),this.splitByFieldElement=m(),this.sortOrderElement=m(),this.originalCustomSortLabels=[],this.isCustomSortDisabled=!1,this.onModelConfigChange=()=>{this.requestUpdate()},this.popoverClose=e=>{this.boxPlotPopover===e?.target&&(this.boxPlotPopover=p(this.boxPlotPopover))},this.onBoxPlotDataChange=async e=>{try{if(e.detail!==null&&e.detail?.value!==void 0){let{contentKind:t}=e.detail,s=[...e.detail.value];switch(L(P),t){case a.category:{let i=s[0]?.trim()||d;if(this.model.category=i,this.model.getSortOrder()===c.customSort){let n=await this.updateCustomSortProps();this.model.orderByList=n,this.sortOrderResetCounter+=1}break}case a.numericFields:{this.model.numericFields=s;let i=s.length>1;if(this.model.standardizeValues=i,this.model.getSortOrder()===c.customSort){let n=await this.updateCustomSortProps();this.model.orderByList=n,this.sortOrderResetCounter+=1}break}case a.splitByField:{let i=s[0]?.trim()||"";this.model.splitByField=i;break}case a.sortOrder:{let i=s[0];if(i===c.customSort){let n=await this.updateCustomSortProps();this.model.setSortOrder(i,n)}else this.model.setSortOrder(i);this.sortOrderResetCounter+=1}break;default:break}}}catch(t){throw this.arcgisChartsConfigDataChangeError.emit({error:t,model:this.model}),t}this.requestUpdate()},this.selectedCustomSortItemId="",this.sortOrderResetCounter=0,this.layerFieldsInfo=[],this.arcgisChartsConfigDataChangeError=S()}static{this.properties={selectedCustomSortItemId:16,sortOrderResetCounter:16,messageOverrides:0,model:0,layerFieldsInfo:0}}static{this.styles=E}load(){this.modelChange(this.model),this.onModelConfigChange(),this.currentDataFilter=this.model.getDataFilters(),this.updateCustomSortProps()}async willUpdate(e){e.has("model")&&this.modelChange(this.model,e.get("model")),b(this.model.getDataFilters(),this.currentDataFilter)||(await this.updateCustomSortProps(),this.currentDataFilter=this.model.getDataFilters()),this.disableSplitBy=this.model.numericFields.length===0||this.model.numericFields.length>1&&this.model.category!==d}disconnectedCallback(){super.disconnectedCallback(),this.boxPlotPopover=p(this.boxPlotPopover),this.model.removeEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange)}modelChange(e,t){t?.removeEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange),e?.addEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange)}onCalciteListOrderChange(e){if(e.detail!==null&&e.detail!==void 0){let{newIndex:t,oldIndex:s}=e.detail;this.model.moveCustomSortValuesInOrderByList(s,t)}}onCustomSortItemSelected(e){let{id:t}=e.target;this.selectedCustomSortItemId=this.selectedCustomSortItemId===t?"":t}onCustomSortItemMoved(e){let{id:t}=e.target,s=this.model.orderByList.length,i=this.model.orderByList.indexOf(this.selectedCustomSortItemId);t===g.Up?s=i-1:t===g.Down&&(s=i+1),i>=0&&s>=0&&s<this.model.orderByList.length&&(this.model.moveCustomSortValuesInOrderByList(i,s),this.sortOrderResetCounter+=1)}buildCustomSortListItems(){return k(this.model.orderByList,e=>e,e=>{let t=I(this.layerFieldsInfo,e);return l`<calcite-list-item id=${e??v} .label=${e??""} .description=${t} .value=${e} .selected=${this.selectedCustomSortItemId===e} @calciteListItemSelect=${this.onCustomSortItemSelected}><calcite-icon slot=content-end></calcite-icon></calcite-list-item>`})}buildCustomSortList(){return f(this.sortOrderResetCounter,l`<calcite-list label class=${o(r.list)} drag-enabled selection-mode=single selection-appearance=border @calciteListOrderChange=${this.onCalciteListOrderChange}>${this.buildCustomSortListItems()}</calcite-list>`)}buildNumericFieldItem(e){return f(e,l`<calcite-list-item .label=${u(this.layerFieldsInfo,e)} .value=${e} closable @calciteListItemClose=${this.onRemoveNumericField}></calcite-list-item>`)}onCategorySelect(e){this.categoryElement.value&&!this.categoryElement.value.disabled&&(this.contentKind=a.category,this.setupPopover(e))}async onRemoveNumericField(e){let t=e.target.value;if(this.model.numericFields=this.model.numericFields.filter(s=>s!==t),this.model.numericFields.length===0&&this.model.resetConfig(),this.model.getSortOrder()===c.customSort){let s=await this.updateCustomSortProps();this.model.orderByList=s,this.sortOrderResetCounter+=1}}async updateCustomSortProps(){let e=await this.model.getCustomSortValues();this.originalCustomSortLabels=[...e];let t=e.length>B.customSortLimit;return t&&(this.sortOrderElement.value&&(this.sortOrderElement.value.label=this._messages.xAxisAsc),this.model.setSortOrder(c.xAxisAsc)),this.isCustomSortDisabled=t,e}onStandardizeValuesChange(e){this.model.standardizeValues=e.target.checked}onShowOutliersChange(e){this.model.showOutliers=e.target.checked}onSplitBySelect(e){this.splitByFieldElement.value&&!this.splitByFieldElement.value.disabled&&(this.contentKind=a.splitByField,this.setupPopover(e))}onSortOrderSelect(e){this.contentKind=a.sortOrder,this.setupPopover(e)}setupPopover(e){e.stopImmediatePropagation(),this.boxPlotPopover=p(this.boxPlotPopover);let t,s,i,n=!1;switch(this.contentKind){case a.category:t=this.categoryElement.value,s=this._messages.categoryHeader,i=this.model.category===d?"":this.model.category;break;case a.numericFields:t=this.numericFieldsElement.value,s=this._messages.numericFieldsHeader,i=this.model.numericFields;break;case a.splitByField:t=this.splitByFieldElement.value,s=this._messages.splitByFieldHeader,i=this.model.splitByField;break;case a.sortOrder:t=this.sortOrderElement.value,s=this._messages.selectSortOrder,i=this.model.getSortOrder(),n=this.isCustomSortDisabled;break}this.boxPlotPopover=x(l`<arcgis-charts-config-box-plot-popover .headingTitle=${s} .referenceElement=${t} open .contentKind=${this.contentKind} .layerFieldsInfo=${this.layerFieldsInfo} .selectedContent=${i} .isCustomSortDisabled=${n} @arcgisChartsConfigBoxPlotDataPopoverChange=${this.onBoxPlotDataChange} @arcgisChartsConfigPopoverClose=${this.popoverClose}></arcgis-charts-config-box-plot-popover>`),!document.body.contains(this.boxPlotPopover)&&this.boxPlotPopover!==null&&document.body.appendChild(this.boxPlotPopover)}onAddNumericFields(e){this.contentKind=a.numericFields,this.setupPopover(e)}getCorrectedSplitByValue(){return this.model.splitByField?.trim()===""?"":u(this.layerFieldsInfo,this.model.splitByField)}getCorrectedCategoryValue(){return this.model.category===d?"":u(this.layerFieldsInfo,this.model.category)}resetToOriginalCustomSortLabels(){this.selectedCustomSortItemId="",this.model.orderByList=[...this.originalCustomSortLabels],this.sortOrderResetCounter+=1}renderCustomSortUI(){let e=this.model.getSortOrder(),t=this.model.getAxisValueFormat(0)?.type,s=this.model.orderByList.indexOf(this.selectedCustomSortItemId);return t===w.CategoryAxisFormat&&e===c.customSort&&!this.isCustomSortDisabled?l`<calcite-label class=${o(r.label)}><div class=${o(r.customSortButtons)}><div><calcite-button appearance=transparent .disabled=${s===0||s===-1||this.selectedCustomSortItemId.trim()===""} icon-start=arrow-bold-up id=${g.Up} kind=neutral scale=s @click=${this.onCustomSortItemMoved}></calcite-button><calcite-button appearance=transparent .disabled=${s===-1||s===this.model.orderByList.length-1||this.selectedCustomSortItemId.trim()===""} icon-start=arrow-bold-down id=${g.Down} kind=neutral scale=s @click=${this.onCustomSortItemMoved}></calcite-button></div><calcite-button @click=${this.resetToOriginalCustomSortLabels} .disabled=${b(this.model.orderByList,this.originalCustomSortLabels)} appearance=transparent icon-end=reset>${this._messages.reset}</calcite-button></div>${this.model.category===d?this._messages.values:this._messages.category}${this.buildCustomSortList()}</calcite-label>`:null}renderNumericFields(e){let t=[];for(let s of e)t.push(this.buildNumericFieldItem(s));return l`<calcite-list label class=${o(r.fieldList)} ${h(this.numericFieldsElement)}>${t}</calcite-list>`}renderCategory(){let e=this.getCorrectedCategoryValue(),t=this.model.numericFields.length===0||(this.model.numericFields??[]).length>1&&this.model.splitByField!=="";return l`<arcgis-charts-config-field-select .label=${e} .disabled=${t} @click=${this.onCategorySelect} ${h(this.categoryElement)}></arcgis-charts-config-field-select>`}renderSplitBy(){let e=this.getCorrectedSplitByValue();return l`<arcgis-charts-config-field-select .label=${e} .disabled=${this.disableSplitBy} @click=${this.onSplitBySelect} ${h(this.splitByFieldElement)}></arcgis-charts-config-field-select>`}renderSorting(){return l`<arcgis-charts-config-field-select .label=${this._messages[this.model.getSortOrder()]} @click=${this.onSortOrderSelect} ${h(this.sortOrderElement)}></arcgis-charts-config-field-select>`}render(){let e=this.renderCategory(),t=this.renderNumericFields([...this.model.numericFields??[]]),s=this.renderSplitBy(),i=this.renderSorting(),n=this.renderCustomSortUI();return l`<div><calcite-label class=${o(r.label)}>${this._messages.numericFields}${t}</calcite-label><div class=${o(r.fab)}><calcite-fab appearance=outline-fill kind=neutral scale=m .label=${this._messages.selectNumericFields} text-enabled .text=${this._messages.selectNumericFields} icon=plus @click=${this.onAddNumericFields}></calcite-fab></div><calcite-label class=${o(r.label)}><div>${this._messages.category} <span class=${o(r.dimText)}>(${this._messages.optional})</span></div>${e}</calcite-label><calcite-label class=${o(r.label)}><div class=${o(this.disableSplitBy?r.dimText:"")}>${this._messages.splitBy} <span class=${o(r.dimText)}>(${this._messages.optional})</span></div>${s}</calcite-label><div>${(this.model.numericFields??[]).length>1?l`<calcite-label class=${o(r.label)} layout=inline-space-between>${this._messages.standardizeValues}<calcite-switch .checked=${this.model.standardizeValues} @calciteSwitchChange=${this.onStandardizeValuesChange}></calcite-switch></calcite-label>`:null}</div><calcite-label class=${o(r.label)} layout=inline-space-between>${this._messages.showOutliers}<calcite-switch .checked=${this.model.showOutliers} @calciteSwitchChange=${this.onShowOutliersChange}></calcite-switch></calcite-label><calcite-label class=${o(r.label)}>${this._messages.sortOrder}${i}</calcite-label>${n}</div>`}};F("arcgis-charts-config-box-plot-data",C);return C},"geometry/support/jsonUtils","rest/support/AttributeBinsQuery","rest/support/Query","rest/support/StatisticDefinition","time/TimeExtent","core/promiseUtils","request",d,e,i)