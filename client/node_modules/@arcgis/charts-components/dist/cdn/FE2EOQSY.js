/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
v4.34.3 */
import{a as C}from"./JHAJCFXL.js";import e from"./MSRS6EXP.js";import"./TLMHEFBH.js";import{a as I}from"./BMZ5OG4J.js";import d from"./TNMDYW24.js";import{d as x,f as l}from"./UM26TKF2.js";import c from"./GUWCFIQ4.js";import{a as E,b as L,f as a,h as M,i as f,r as D,w as u,x as G,y as j,z as O}from"./MHMLEVRX.js";import"./DXCHSVBP.js";import{g as y,h as z,j as m,k as h,m as S,n as T,q as p}from"./TJF35EBS.js";import{f as i,g as r,h as X}from"./5BG7WW2E.js";import{a as n}from"./2YIVYDK5.js";import{A as g,D as N,F as w,g as A,h as b,x as B,y as V}from"./GRWAOK3Y.js";import"./UUMP6K6L.js";export default $arcgis.t(([,,,,,,,,,{e:R}])=>{var P={type:u.TS,color:[1,1,1,255],font:{family:"Tahoma",size:12,decoration:O.None,style:G.Normal,weight:j.Normal}},k={type:u.SLS,color:[1,1,1,255],style:D.Solid,width:2},v={element:"chart-element",elementList:"element-list",sectionLabel:"section-label"},W=A`:host{width:var(--arcgis-charts-config-calcite-block-default-width);margin:var(--arcgis-charts-config-calcite-block-default-margin)}.section-label{display:flex;margin:var(--arcgis-charts-config-margin-major) var(--arcgis-charts-config-margin-minor);justify-content:space-between;align-items:center;font-weight:var(--calcite-font-weight-medium);font-size:var(--calcite-font-size-0)}.element-list{margin:var(--arcgis-charts-config-margin-minor)}.element{user-select:none}`,F=class extends V{constructor(){super(...arguments),this._messages=I(),this.formatPopover=null,this.selectableElements=[],this.textProperties=[],this.symbolProperties=[],this.symbolPropertyChange=t=>{let e=t;e.stopImmediatePropagation();let s;if(e.target?.localName==="calcite-list-item"?s=e.target?.value:s=e.target?.parentNode?.value,this.selectedTexts=[],this.selectedBackground=[],this.selectedSymbols.includes(s))this.selectedSymbols=[],this.updateSelectedElement(this.selectedSymbols);else{let o=this.getFormatValue(s);this.selectedSymbols=[s],this.initSelectedSymbols(x(o)?o:k)}this.setupFormatPopover()},this.textPropertyChange=t=>{let e=t;e.stopImmediatePropagation();let s;if(e.target?.localName==="calcite-list-item"?s=e.target?.value:s=e.target?.parentNode?.value,this.selectedSymbols=[],this.selectedBackground=[],e.shiftKey){this.selectedTexts=[];let o=this.textProperties.indexOf(this.lastSelectedText??s),c=this.textProperties.indexOf(s);this.textProperties.forEach((d,$)=>{$>=Math.min(o,c)&&$<=Math.max(o,c)&&this.selectedTexts.push(d)}),this.updateSelectedElement(this.selectedTexts),this.setupFormatPopover()}else if(e.ctrlKey)this.selectedTexts.includes(s)?(this.selectedTexts=this.selectedTexts.filter(o=>o!==s),this.updateSelectedElement(this.selectedTexts)):(this.selectedTexts=[...this.selectedTexts,s],this.updateSelectedElement(this.selectedTexts)),this.setupFormatPopover();else if(this.selectedTexts.includes(s))this.selectedTexts=[],this.updateSelectedElement(this.selectedTexts),this.setupFormatPopover();else{let o=this.getFormatValue(s);this.selectedTexts=[s],this.initSelectedTexts(l(o)?o:P),this.setupFormatPopover()}this.lastSelectedText=s},this.backgroundChange=t=>{let e=t;e.stopImmediatePropagation();let s;e.target?.localName==="calcite-list-item"?s=e.target?.value:s=e.target?.parentNode?.value,this.selectedSymbols=[],this.selectedTexts=[],this.selectedBackground.includes(s)?(this.selectedBackground=[],this.selectedElement={}):(this.selectedBackground=[s],this.selectedElement=f(this.getFormatValue(s))?void 0:this.getFormatValue(s)),this.setupFormatPopover()},this.updateSymbolProps=t=>{let e=t.detail;this.selectedSymbols.forEach(s=>{this.setFormatValue(s,e)}),this.selectedElement=a(t.target.selectedElement)},this.updateBackground=t=>{this.setFormatValue(X.Background,t.detail),this.selectedElement=t.detail},this.updateTextProps=t=>{let{font:e,color:s}=t.detail;this.selectedTexts.forEach(o=>{let c=this.getFormatValue(o),d=l(c)?c:void 0;this.setFormatValue(o,{...d,type:u.TS,font:{...d?.font,...e},color:s??d?.color})}),this.selectedElement=a(t.target.selectedElement)},this.onModelConfigChange=()=>{this.requestUpdate()},this.formatPopoverClose=t=>{this.formatPopover===t?.target&&(this.selectedTexts=[],this.selectedSymbols=[],this.selectedBackground=[],this.selectedElement={},this.removeFormatPopover())},this.mergeFormatValues=(t,e)=>{let s=!1;E(t)&&E(e)||L(t)&&L(e)?s=!0:s=t===e;let o=typeof t=="number"||typeof e=="number"?Number.NaN:"";return s?void 0:o},this.updateSelectableElements=t=>{t&&!this.selectableElements.includes(t)&&this.selectableElements.push(t)},this.selectedSymbols=[],this.selectedTexts=[],this.selectedBackground=[]}static{this.properties={selectedSymbols:16,selectedTexts:16,selectedBackground:16,selectedElement:16,messageOverrides:0,model:0}}static{this.styles=W}load(){this.modelChange(this.model)}willUpdate(t){t.has("model")&&this.modelChange(this.model,t.get("model"))}disconnectedCallback(){super.disconnectedCallback(),this.removeFormatPopover(),this.model.removeEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange)}modelChange(t,e){e?.removeEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange),t?.addEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange)}correctTextElementSelection(){for(let t of this.selectableElements){let e=this.selectedTexts.includes(t.value)||this.selectedSymbols.includes(t.value)||this.selectedBackground.includes(t.value);t.selected=e}}updateSelectedElement(t,e){if(this.selectedElement=void 0,e===void 0){let s=a(this.getFormatValue(t[0]));this.selectedElement=t?.reduce((o,c)=>{let d=this.getFormatValue(c);return M(o,d,this.mergeFormatValues)},s)}else{let s=a(e);f(e)&&(this.selectedSymbols?.length>0&&(s=a(k)),this.selectedTexts?.length>0&&(s=a(P))),this.selectedElement=s}}initSelectedTexts(t){let e=a(t);f(t)&&(e=a(P)),this.selectedElement=e}initSelectedSymbols(t){let e=a(t);f(t)&&(e=a(k)),this.selectedElement=e}setupFormatPopover(){this.formatPopover=C(this.formatPopover);let t=this.selectedElement;t?.type===u.TS||t?.type===u.SLS||Array.isArray(this.selectedElement)?(this.formatPopover=N(b`<arcgis-charts-config-format-popover .selectedElement=${this.selectedElement} .referenceElement=${this.el} @arcgisChartsConfigFormatPopoverSymbolChange=${this.updateSymbolProps} @arcgisChartsConfigFormatPopoverTextChange=${this.updateTextProps} @arcgisChartsConfigFormatPopoverColorChange=${this.updateBackground} placement=auto @arcgisChartsConfigPopoverClose=${this.formatPopoverClose} open></arcgis-charts-config-format-popover>`),this.formatPopover!==null&&!document.body.contains(this.formatPopover)&&document.body.appendChild(this.formatPopover)):this.removeFormatPopover()}removeFormatPopover(){this.formatPopover!==null&&(this.formatPopover.open=!1,this.formatPopover=C(this.formatPopover))}getFormatValue(t){switch(t){case i.Title:return this.model.titleSymbol;case i.Description:return this.model.descriptionSymbol;case i.XAxisTitle:return m(this.model)?this.model.xAxisTitleSymbol:void 0;case i.YAxisTitle:return h(this.model)?this.model.getAxisTitleSymbol(1):void 0;case i.AxisLabels:return m(this.model)?this.model.axisLabelsSymbol:void 0;case i.GuideLabels:return T(this.model)?this.model.guideLabelsSymbol:void 0;case i.LegendText:return p(this.model)?this.model.legendTextSymbol:void 0;case i.LegendTitle:return p(this.model)?this.model.legendTitleSymbol:void 0;case i.DataLabels:return S(this.model)?this.model.dataLabelsSymbol:void 0;case r.AxisLines:return m(this.model)?this.model.axisLinesSymbol:void 0;case r.GridLines:return h(this.model)?this.model.getGridLinesSymbol():void 0;case r.LeaderLines:return y(this.model)?this.model.ticksSymbol:void 0;case i.Background:return this.model.backgroundColor;default:return}}setFormatValue(t,e){switch(t){case i.Title:l(e)&&(this.model.titleSymbol=e);break;case i.Description:l(e)&&(this.model.descriptionSymbol=e);break;case i.XAxisTitle:m(this.model)&&l(e)&&(this.model.xAxisTitleSymbol=e);break;case i.YAxisTitle:h(this.model)&&l(e)&&this.model.setAxisTitleSymbol(e,1);break;case i.AxisLabels:m(this.model)&&l(e)&&(this.model.axisLabelsSymbol=e);break;case i.GuideLabels:T(this.model)&&l(e)&&(this.model.guideLabelsSymbol=e);break;case i.LegendText:p(this.model)&&l(e)&&(this.model.legendTextSymbol=e);break;case i.LegendTitle:p(this.model)&&l(e)&&(this.model.legendTitleSymbol=e);break;case i.DataLabels:S(this.model)&&l(e)&&(this.model.dataLabelsSymbol=e);break;case r.AxisLines:m(this.model)&&x(e)&&(this.model.axisLinesSymbol=e);break;case r.GridLines:if(h(this.model)&&x(e)){let s=this.model.chartType,o=[];switch(s){case n.BarSeries:case n.LineSeries:case n.ComboLineAndBarSeries:case n.HistogramSeries:case n.BoxPlotSeries:case n.RadarSeries:{o=[1];break}case n.ScatterSeries:{o=[0,1];break}}this.model.setGridLinesSymbol(e,o)}break;case r.LeaderLines:y(this.model)&&x(e)&&(this.model.ticksSymbol=e);break;case i.Background:Array.isArray(e)&&(this.model.backgroundColor=e);break}}renderFormatElements(){this.textProperties=[i.Title,...m(this.model)?[i.XAxisTitle]:[],...h(this.model)?[i.YAxisTitle]:[],...p(this.model)?[i.LegendTitle]:[],i.Description,...p(this.model)?[i.LegendText]:[],...m(this.model)?[i.AxisLabels]:[],...T(this.model)?[i.GuideLabels]:[],...S(this.model)?[i.DataLabels]:[]],z(this.model)&&(this.textProperties=this.textProperties.filter(s=>s!==i.DataLabels)),this.symbolProperties=[i.Background,...m(this.model)?[r.AxisLines]:[],...h(this.model)?[r.GridLines]:[],...y(this.model)?[r.LeaderLines]:[]];let t=this.textProperties.map(s=>this.renderTextElement(s,this.textPropertyChange)),e=this.symbolProperties.map(s=>s===i.Background?this.renderTextElement(s,this.backgroundChange):this.renderTextElement(s,this.symbolPropertyChange));return{textElements:t,symbolElements:e}}renderTextElement(t,e){let s=R(t),o=this.getFormatValue(t),c=typeof o=="string"?o:"",d=this.selectedTexts.includes(t)||this.selectedSymbols.includes(t)||this.selectedBackground.includes(t);return b`<calcite-list-item class=${g(v.element)} .label=${this._messages[t]} .description=${c} .value=${t} .selected=${d} @click=${e} ${B(this.updateSelectableElements)}>${s!==void 0?b`<calcite-icon slot=content-start scale=s .icon=${s}></calcite-icon>`:null}</calcite-list-item>`}render(){let{textElements:t,symbolElements:e}=this.renderFormatElements();return b`<div class=${g(v.sectionLabel)}>${this._messages.textElements}</div><calcite-list label class=${g(v.elementList)} selection-mode=multiple selection-appearance=border @calciteListChange=${this.correctTextElementSelection}>${t}</calcite-list><div class=${g(v.sectionLabel)}>${this._messages.symbolElements}</div><calcite-list label class=${g(v.elementList)} selection-mode=single selection-appearance=border>${e}</calcite-list>`}};w("arcgis-charts-config-format",F);return F},"geometry/support/jsonUtils","rest/support/AttributeBinsQuery","rest/support/Query","rest/support/StatisticDefinition","time/TimeExtent","core/promiseUtils","request",c,d,e)