/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
v4.34.3 */
import{d as h}from"./TLMHEFBH.js";import{g as P}from"./UM26TKF2.js";import a from"./GUWCFIQ4.js";import{f as d,j as n,w as I}from"./MHMLEVRX.js";import"./DXCHSVBP.js";import"./2YIVYDK5.js";import{F as y,g as C,h as c,l as p,y as u}from"./GRWAOK3Y.js";import"./UUMP6K6L.js";export default $arcgis.t(([,,,,,,,{ic:v,kc:F}])=>{var L=C`:host{overflow-y:auto;overflow-x:hidden;margin-bottom:var(--arcgis-charts-intra-section-margin);margin-top:var(--arcgis-charts-intra-section-margin);height:100%}`,m=class extends u{constructor(){super(...arguments),this.onModelConfigChange=async e=>{let i=e?.detail.config??this.model.config;this.layer===void 0&&await this.updateFetchLayerFieldsInfo(i)},this.popoverPlacement="leading",this.arcgisChartsConfigNoSeriesUpdate=p(),this.arcgisChartsConfigWebChartChange=p()}static{this.properties={layerFieldsInfo:16,model:0,popoverPlacement:3,seriesColor:2,calculatedMinMaxBounds:2,page:3,layer:0,usePopupTemplateFieldsInfo:5,filterBySelection:5,chartData:0}}static{this.styles=L}async load(){this.layer!==void 0&&await this.layerChange(this.layer,void 0),this.seriesColor!==void 0&&this.seriesColorChange(this.seriesColor),this.usePopupTemplateFieldsInfo!==void 0&&await this.usePopupTemplateFieldsInfoChange(this.usePopupTemplateFieldsInfo,void 0),this.modelChange(this.model),this.onModelConfigChange()}async willUpdate(e){e.has("model")&&this.modelChange(this.model,e.get("model")),e.has("layer")&&await this.layerChange(this.layer,e.get("layer")),e.has("usePopupTemplateFieldsInfo")&&await this.usePopupTemplateFieldsInfoChange(this.usePopupTemplateFieldsInfo,e.get("usePopupTemplateFieldsInfo")),e.has("seriesColor")&&this.seriesColorChange(this.seriesColor),this.layerFieldsInfo===void 0&&await this.updateFetchLayerFieldsInfo()}disconnectedCallback(){super.disconnectedCallback(),this.model.removeEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange)}modelChange(e,i){i?.removeEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange),e?.addEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange)}async layerChange(e,i){e!==void 0&&!n(i,e)&&await this.updateFetchLayerFieldsInfo()}async usePopupTemplateFieldsInfoChange(e,i){e!==void 0&&e!==i&&await this.updateFetchLayerFieldsInfo()}seriesColorChange(e){let{slices:i,groupedSlices:s,groupOfSlices:t}=e?.get(0)??{},o=[];this.filterBySelection===!0?o=this.model.slices?.map(r=>i?.find(a=>a.sliceId===r.sliceId)??s?.find(a=>a.sliceId===r.sliceId)??r)??[]:o=(i??[]).concat(s??[]),o.forEach((r,a)=>{let f=this.model.slices?.find(w=>w.sliceId===o[a].sliceId);f&&(o[a]={...o[a],...f});let l=o[a].fillSymbol;l!==void 0&&!n(l?.outline?.color,l?.color)&&(l.outline={...l.outline??{},type:I.SLS,color:l.color})});let g=(s??[]).map(r=>r.sliceId);s!==void 0&&!n(g,this.model.groupedSliceIds)&&(this.model.groupedSliceIds=d(g)),n(o,this.model.slices)||(this.model.slices=d(o)),t!==void 0&&!n(t,this.model.sliceGrouping)&&(this.model.sliceGrouping=d(t))}async updateFetchLayerFieldsInfo(e){let i=e??this.model.config,s=this.layer;if(!s){let t=P(i)?i.iLayer:void 0;t&&(s=await v(t))}s&&(this.layerFieldsInfo=await F(s,this.usePopupTemplateFieldsInfo))}render(){let e;switch(this.page){case h.Data:e=c`<arcgis-charts-config-pie-chart-data .model=${this.model} .layerFieldsInfo=${this.layerFieldsInfo}></arcgis-charts-config-pie-chart-data>`;break;case h.Slices:e=c`<arcgis-charts-config-pie-chart-slices .model=${this.model} .chartData=${this.chartData} .popoverPlacement=${this.popoverPlacement}></arcgis-charts-config-pie-chart-slices>`;break;case h.Format:e=c`<arcgis-charts-config-format .model=${this.model}></arcgis-charts-config-format>`;break;case h.General:e=c`<arcgis-charts-config-general .model=${this.model}></arcgis-charts-config-general>`;break;default:e="";break}return e}};y("arcgis-charts-config-pie-chart",m);return m},"geometry/support/jsonUtils","rest/support/AttributeBinsQuery","rest/support/Query","rest/support/StatisticDefinition","time/TimeExtent","core/promiseUtils","request",a)