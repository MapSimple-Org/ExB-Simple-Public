/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
v4.34.3 */
import{a as m,b as r}from"./R7TF2W5C.js";import{b as c}from"./K22MD3IH.js";import{a as v}from"./BMZ5OG4J.js";import{f as g}from"./MHMLEVRX.js";import"./DXCHSVBP.js";import{o as h,p as l}from"./TJF35EBS.js";import{i as d}from"./5BG7WW2E.js";import"./2YIVYDK5.js";import{A as u,D as C,F as b,g as p,h as a,w as f,x as A,y as x}from"./GRWAOK3Y.js";import"./UUMP6K6L.js";var P=p`:host{display:flex;flex-direction:column;width:var(--arcgis-charts-config-calcite-block-default-width);margin:var(--arcgis-charts-config-calcite-block-default-margin)}.add-guide{display:flex;justify-content:center;padding:.5rem}.add-guide-btn{width:100%}.no-guides{border-radius:2rem}.no-messages{text-align:center}.guide-icon{padding-left:.5rem;padding-top:.5rem;width:1.5rem;height:1.5rem}`,G=class extends x{constructor(){super(...arguments),this._messages=v(),this.addGuideButton=f(),this.guideTypePopover=null,this.addXGuide=e=>{if(h(this.model)){let t=this.getUniqueName(this._messages.xAxisGuide??""),i=this.model.getXGuidesLength()??0;this.model.addXAxisGuide(t,i),this.model.setGuideStyle(g(c.style),i,d.X),this.latestGuidePosition=r(i,d.X,this.model),this.togglePopOver(e),(this.el.shadowRoot?.querySelectorAll("calcite-block")??[]).forEach((s,o)=>{o!==this.latestGuidePosition&&(s.open=!1)})}},this.addYGuide=e=>{if(l(this.model)){let t=this.getUniqueName(this._messages.yAxisGuide??""),i=this.model.getYGuidesLength()??0;this.model.addYAxisGuide(t,i),this.model.setGuideStyle(g(c.style),i,d.Y),this.latestGuidePosition=r(i,d.Y,this.model),this.togglePopOver(e);for(let s of this.el.shadowRoot?.querySelectorAll("calcite-block")??[])s.open=!1}},this.togglePopOver=e=>{e.stopImmediatePropagation(),this.enableXAxisGuide&&this.enableYAxisGuide&&(this.showAddButton=!this.showAddButton)},this.onModelConfigChange=()=>{this.requestUpdate()},this.closeAddPopOver=e=>{e.stopImmediatePropagation(),this.showAddButton=!0},this.showAddButton=!0,this.latestGuidePosition=0,this.open=!1}static{this.properties={showAddButton:16,latestGuidePosition:16,messageOverrides:0,model:0,timeZone:3,calculatedMinMaxBounds:2,enableXAxisGuide:5,enableYAxisGuide:5,open:7}}static{this.styles=P}load(){this.modelChange(this.model)}willUpdate(e){e.has("model")&&this.modelChange(this.model,e.get("model"))}disconnectedCallback(){super.disconnectedCallback(),this.model.removeEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange)}modelChange(e,t){t?.removeEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange),e?.addEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange)}getAllGuidesLength(){let e=h(this.model)?this.model.getXGuidesLength()??0:0,t=l(this.model)?this.model.getYGuidesLength()??0:0;return e+t}getUniqueName(e,t=1){let i=`${e} ${t}`,s=!1;if(h(this.model)){let o=this.model.getXGuidesLength()??0;for(let n=0;n<o&&!s;n+=1)this.model.getGuideName(n,d.X)===i&&(s=!0)}if(l(this.model)){let o=this.model.getYGuidesLength()??0;for(let n=0;n<o&&!s;n+=1)this.model.getGuideName(n,d.Y)===i&&(s=!0)}return s?this.getUniqueName(e,t+1):i}setChangedGuide(e){let{index:t,orientation:i,isDelete:s}=e.detail,o=r(t,i,this.model);s&&o!==void 0&&o<=this.latestGuidePosition&&this.latestGuidePosition>0&&(this.latestGuidePosition-=1)}setupGuidePopover(e){e.stopImmediatePropagation(),this.togglePopOver(e)}renderGuideTypePopover(){let e=this.getAllGuidesLength();this.guideTypePopover=C(a`<arcgis-charts-config-guides-type-popover .enableXAxisGuide=${this.enableXAxisGuide} .enableYAxisGuide=${this.enableYAxisGuide} .referenceElement=${this.addGuideButton.value} .placement=${e===0?"bottom":"top"} .open=${!this.showAddButton} @arcgisChartsAddXAxisGuide=${this.addXGuide} @arcgisChartsAddYAxisGuide=${this.addYGuide} @arcgisChartsConfigPopoverClose=${this.closeAddPopOver}></arcgis-charts-config-guides-type-popover>`),!this.showAddButton&&!document.body.contains(this.guideTypePopover)&&this.guideTypePopover!==null&&document.body.appendChild(this.guideTypePopover)}renderGuide(e,t){let i;return(this.enableXAxisGuide&&t===d.X||this.enableYAxisGuide&&t===d.Y)&&(i=a`<arcgis-charts-config-guide .model=${this.model} .timeZone=${this.timeZone} .calculatedMinMaxBounds=${this.calculatedMinMaxBounds} .index=${e} .orientation=${t} .latestGuidePosition=${this.latestGuidePosition} @arcgisChartsConfigGuideChange=${this.setChangedGuide}></arcgis-charts-config-guide>`),i}renderGuides(){let e=[];if(h(this.model)){let t=this.model.getXGuidesLength()??0;for(let i=0;i<t;i+=1)e.push(this.renderGuide(i,d.X))}if(l(this.model)){let t=this.model.getYGuidesLength()??0;for(let i=0;i<t;i+=1)e.push(this.renderGuide(i,d.Y))}return e}renderAddGuideButton(e){return a`<calcite-fab slot=fab appearance=outline-fill kind=neutral text-enabled .text=${this._messages.addGuide} .label=${this._messages.addGuide} @click=${e} scale=s></calcite-fab>`}render(){let e=this.getAllGuidesLength()>0,t=this.showAddButton&&this.enableXAxisGuide&&this.enableYAxisGuide,i=this.enableXAxisGuide&&!this.enableYAxisGuide,s=!this.enableXAxisGuide&&this.enableYAxisGuide;return a`${this.renderGuideTypePopover()}${e?this.renderGuides():a`<div class=${u(m.noMessages)}>${this._messages.noGuidesMsg}</div>`}<div class=${u(m.addGuide)} ${A(this.addGuideButton)}>${t&&this.renderAddGuideButton(this.setupGuidePopover)||""}${i&&this.renderAddGuideButton(this.addXGuide)||""}${s&&this.renderAddGuideButton(this.addYGuide)||""}</div>`}};b("arcgis-charts-config-guides",G);export{G as ArcgisChartsConfigGuides};
