/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
v4.34.3 */
import{a as w}from"./GBCMZCYP.js";import{a as u}from"./MWPCQM2X.js";import{a as v}from"./XIZLMN6F.js";import{a as f}from"./JHAJCFXL.js";import{a as g}from"./BMZ5OG4J.js";import a from"./GUWCFIQ4.js";import"./MHMLEVRX.js";import"./DXCHSVBP.js";import"./2YIVYDK5.js";import{A as o,D as p,F as C,g as d,h as r,l as s,y as m}from"./GRWAOK3Y.js";import"./UUMP6K6L.js";export default $arcgis.t(([])=>{var n={addChartContainer:"add-chart-container",viewChartComponent:"view-chart-component",header:"header",dropdownPopup:"dropdown-popup"},R=d`.view-chart-component{width:var(--arcgis-charts-config-panel-width);height:var(--arcgis-charts-config-panel-height)}.add-chart-container{display:flex;justify-content:center;padding:2rem 0;background-color:var(--calcite-color-background)}.header{margin-left:1rem}.dropdown-popup{position:relative}`,l=class extends m{constructor(){super(...arguments),this._messages=g(),this.chartRenamePopover=null,this.popoverClose=()=>{let e=this.modelList?.find(t=>t.chartId===this.selectedChartId);this.chartTitle=e?.titleText??"",this.selectedActionChartId="",this.removeChartRenamePopover()},this.onChartRename=e=>{if(!this.disableEditing){this.chartTitle=e.detail.name;let t=this.modelList?.find(i=>i.chartId===this.selectedActionChartId);t!==void 0&&(t.titleText=this.chartTitle),this.selectedActionChartId="",this.removeChartRenamePopover()}},this.onModelConfigChange=()=>{this.requestUpdate()},this.onCalciteListOrderChange=e=>{if(e.detail!==null&&e.detail!==void 0){let{newIndex:t,oldIndex:i}=e.detail;if(this.modelList!==void 0&&this.modelList?.length>0){let a=[...this.modelList],c=a?.[i],h=a?.[t];c&&h&&(a.splice(i,1),a.splice(t,0,c)),this.chartsOrderReorderCounter+=1,this.arcgisChartsConfigModelListReorder.emit({modelList:a})}}},this.chartTitle="",this.chartsOrderReorderCounter=0,this.noGroup=!1,this.disableEditing=!1,this.arcgisChartsConfigModelListReorder=s(),this.arcgisChartsConfigViewChartAddChart=s(),this.arcgisChartsConfigViewChartDelete=s(),this.arcgisChartsConfigViewChartEdit=s(),this.arcgisChartsConfigViewChartSelect=s()}static{this.properties={isChartRenamePopoverOpen:16,chartTitle:16,selectedActionChartId:16,chartsOrderReorderCounter:16,messageOverrides:0,selectedChartId:3,layer:0,modelList:2,noGroup:7,disableEditing:7}}static{this.styles=R}willUpdate(e){e.has("modelList")&&this.modelListChange(this.modelList,e.get("modelList"))}disconnectedCallback(){super.disconnectedCallback(),this.removeChartRenamePopover()}modelListChange(e,t){t?.forEach(i=>{i.removeEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange)}),e?.forEach(i=>{i.addEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange)})}onAddChartClick(e){e.stopImmediatePropagation(),this.arcgisChartsConfigViewChartAddChart.emit({referenceElement:e.target,layerId:this.layer?.id.toString()})}buildChartList(){let e=this.modelList?u(this.modelList,t=>t.chartId,(t,i)=>{let a=t.chartId,c=t.titleText,h=w(t.config);return r`<calcite-list-item .label=${c??a??this._messages.chartTitle} .selected=${this.selectedChartId===(a?.toString()??i.toString())} .value=${a??i.toString()} @click=${this.onChartSelect}><calcite-icon slot=content-start .icon=${h}></calcite-icon>${this.disableEditing?null:r`<calcite-dropdown slot=actions-end overlay-positioning=fixed placement=bottom-end @calciteDropdownClose=${()=>this.chartActionClosed(a??"")} @calciteDropdownOpen=${()=>this.chartActionOpened(a??"")} class=${o(n.dropdownPopup)}><calcite-action scale=l .text=${this._messages.chartActions??""} slot=trigger .active=${a===this.selectedActionChartId}><calcite-icon icon=ellipsis></calcite-icon></calcite-action><calcite-dropdown-group selection-mode=none><calcite-dropdown-item accesskey=edit @calciteDropdownItemSelect=${this.chartEditSelect}>${this._messages.edit}</calcite-dropdown-item><calcite-dropdown-item accesskey=rename @click=${$=>$.stopPropagation()} @calciteDropdownItemSelect=${this.chartRenameSelect}>${this._messages.rename}</calcite-dropdown-item><calcite-dropdown-item accesskey=delete @calciteDropdownItemSelect=${this.chartDeleteSelect}>${this._messages.delete}</calcite-dropdown-item></calcite-dropdown-group></calcite-dropdown>`}</calcite-list-item>`}):null;return this.layer?r`<div>${this.noGroup?null:r`<p class=${o(n.header)}>${this.layer.title??this.layer.id.toString()}</p>`}${v(this.chartsOrderReorderCounter,r`<calcite-list label .dragEnabled=${!this.disableEditing} selection-mode=single selection-appearance=border @calciteListOrderChange=${this.onCalciteListOrderChange}>${e}${this.disableEditing?null:r`<div class=${o(n.addChartContainer)}><calcite-fab slot=fab appearance=outline-fill kind=neutral text-enabled .text=${this._messages.addChart} .label=${this._messages.addChart} @click=${this.onAddChartClick} scale=s></calcite-fab></div>`}</calcite-list>`)}</div>`:null}onChartSelect(e){let t=e.currentTarget,i;t?.localName==="calcite-list-item"?i=t.value:t?.localName==="calcite-icon"&&(i=t.parentNode.value),this.arcgisChartsConfigViewChartSelect.emit({chartId:i})}chartEditSelect(){this.disableEditing||(this.arcgisChartsConfigViewChartEdit.emit({chartId:this.selectedActionChartId}),this.chartActionClosed(this.selectedActionChartId))}chartRenameSelect(e){if(!this.disableEditing){let t=e.target.closest("calcite-list-item"),i=this.modelList?.find(a=>a.chartId===this.selectedActionChartId);t!==null&&(this.renameReferenceElement=t),this.arcgisChartsConfigViewChartSelect.emit({chartId:this.selectedActionChartId}),this.chartTitle=i?.titleText??"",this.setupRenamePopover()}}chartDeleteSelect(){this.disableEditing||(this.arcgisChartsConfigViewChartDelete.emit({chartId:this.selectedActionChartId}),this.selectedActionChartId="")}chartActionClosed(e){e===this.selectedActionChartId&&!this.isChartRenamePopoverOpen&&(this.selectedActionChartId="")}chartActionOpened(e){this.selectedActionChartId=e}setupRenamePopover(){this.isChartRenamePopoverOpen=!0,this.chartRenamePopover!==null&&(this.chartRenamePopover.name=this.chartTitle,this.chartRenamePopover.referenceElement=this.renameReferenceElement),this.chartRenamePopover=p(r`<arcgis-charts-config-chart-rename-popover .name=${this.chartTitle} .referenceElement=${this.renameReferenceElement} .open=${this.isChartRenamePopoverOpen} @arcgisChartsConfigPopoverClose=${this.popoverClose} @arcgisChartsConfigChartRenamePopoverChange=${this.onChartRename}></arcgis-charts-config-chart-rename-popover>`),!document.body.contains(this.chartRenamePopover)&&this.chartRenamePopover!==null&&document.body.appendChild(this.chartRenamePopover)}removeChartRenamePopover(){this.chartRenamePopover!==null&&(this.isChartRenamePopoverOpen=!1,this.chartRenamePopover=f(this.chartRenamePopover))}render(){return r`<div class=${o(n.viewChartComponent)}>${this.buildChartList()}</div>`}};C("arcgis-charts-config-view-charts",l);return l},"geometry/support/jsonUtils","rest/support/AttributeBinsQuery","rest/support/Query","rest/support/StatisticDefinition","time/TimeExtent","core/promiseUtils","request",a)