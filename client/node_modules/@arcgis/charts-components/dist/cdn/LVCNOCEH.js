/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
v4.34.3 */
import{b as te}from"./R7TF2W5C.js";import{b as E}from"./K22MD3IH.js";import{a as Q}from"./XIZLMN6F.js";import{a as ee}from"./JHAJCFXL.js";import d from"./MSRS6EXP.js";import"./TLMHEFBH.js";import{a as U}from"./BMZ5OG4J.js";import b from"./TNMDYW24.js";import{c as O,d as g}from"./UM26TKF2.js";import a from"./GUWCFIQ4.js";import{f as k,r as V,w as u}from"./MHMLEVRX.js";import"./DXCHSVBP.js";import{k as Y,o as W,p as H}from"./TJF35EBS.js";import{i as v}from"./5BG7WW2E.js";import{a as j}from"./2YIVYDK5.js";import{A as o,B as S,D as I,F as N,g as R,h as r,l as X,w as c,x as h,y as z}from"./GRWAOK3Y.js";import"./UUMP6K6L.js";export default $arcgis.t(([,,,,,,,{L:q,jb:p},{c:Z,d:D,e:P},{h:C,i:x,n:T,p:J,r:K}])=>{var a={row:"row",column:"column",colorPicker:"color-picker"},se=R`.hide{display:none}.am5-modal{width:100%;height:100%;position:absolute;z-index:100000;top:0;left:0}.am5-modal-curtain{top:0;left:0;width:100%;height:100%;position:absolute;background:#fff!important;z-index:100}.am5-modal-wrapper{top:0;left:0;width:100%;height:100%;position:absolute;display:flex;align-items:center;justify-content:center;white-space:nowrap;background:#ffffff80;z-index:101}.am5-modal-content{display:inline-block;padding:1.2em;vertical-align:middle;text-align:start;white-space:normal;background:#fff;border-radius:4px;box-shadow:#00000073 0 0 36px;color:#000}.am5-layer-1000{z-index:1000!important}.am5-layer-30{z-index:100!important}.arcgis-charts-modal{box-shadow:none!important}.arcgis-charts-modal-header{background-color:#0000000d;font-weight:700;padding:4px;align-content:center}.show{display:block}.notifyPanel{flex:0 1 auto}.disable-interactions{pointer-events:none}.dim-text{color:var(--arcgis-charts-dim-text)}:host{display:flex;flex-direction:column}.row{display:flex;flex-direction:row;column-gap:var(--arcgis-charts-inter-section-margin)}.column{display:flex;flex-direction:column;flex-wrap:wrap;flex-grow:1}.column>calcite-input{margin-bottom:.5rem;flex-grow:2}.column>calcite-input[type=number]{margin-bottom:.5rem}input{padding:.5rem}.label{display:flex;flex-direction:row;justify-content:space-between;margin-bottom:var(--arcgis-charts-intra-section-margin);flex-grow:1}.color-picker{border:1px solid var(--calcite-color-border-2);box-shadow:none;margin-bottom:var(--arcgis-charts-inter-section-margin)}.delete-guide{display:flex;flex-direction:row-reverse;height:2rem;margin:0 1rem;font-weight:550}.delete-guide:dir(rtl){flex-direction:row}`,A=class extends z{constructor(){super(...arguments),this._messages=U(),this.startCalciteInput=c(),this.endCalciteInput=c(),this.startDateCalciteInput=c(),this.endDateCalciteInput=c(),this.startTimeCalciteInput=c(),this.endTimeCalciteInput=c(),this.colorElement=c(),this.colorChange=e=>{let t=e.detail,i=this.model.getGuideStart(this.index,this.orientation),n=this.model.getGuideEnd(this.index,this.orientation);if(p(i,n)===u.SLS){let l=k(E.style),s=this.model.getGuideStyle(this.index,this.orientation),d={...l,...g(s)?s:{},color:t};this.lineStyleChange({detail:d})}else this.setColor(t)},this.symbolChange=e=>{let t=e?.detail,i=this.model.getGuideStart(this.index,this.orientation),n=this.model.getGuideEnd(this.index,this.orientation);if(p(i,n)===u.SLS){let l=k(E.style),s=this.model.getGuideStyle(this.index,this.orientation),d={...l,...g(s)?s:{},...g(t)?t:{}};this.lineStyleChange({detail:d})}else t?.color!==void 0&&this.setColor(t.color)},this.onModelConfigChange=()=>{this.requestUpdate()},this.guidePopover=null,this.latestGuidePosition=0,this.arcgisChartsConfigGuideChange=X()}static{this.properties={guidePopover:16,messageOverrides:0,model:0,timeZone:3,calculatedMinMaxBounds:2,index:11,orientation:3,latestGuidePosition:9}}static{this.styles=se}get isXAxisDateField(){return this.orientation===v.X&&Y(this.model)&&this.model.getAxisValueFormat(0)?.type===j.DateAxisFormat}load(){this.modelChange(this.model)}willUpdate(e){e.has("model")&&this.modelChange(this.model,e.get("model"))}loaded(){this.isXAxisDateField&&this.setGuideDateTimeRange()}disconnectedCallback(){super.disconnectedCallback(),this.model.removeEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange)}modelChange(e,t){t?.removeEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange),e?.addEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange)}onColorElementSelect(e){this.guidePopover?.open===!0?this.removeGuidePopover():this.setupGuidePopover(e)}setGuideStart(e){let{value:t}=e.target;this.startCalciteInput.value!==void 0&&(t===""?C({inputElement:this.startCalciteInput.value,status:x.INVALID}):(this.model.setGuideStart(t,this.index,this.orientation),this.symbolChange(),this.arcgisChartsConfigGuideChange.emit({index:this.index,orientation:this.orientation,isDelete:!1}),C({inputElement:this.startCalciteInput.value,status:x.IDLE}))),this.guidePopover?.open===!0&&this.removeGuidePopover()}setGuideEnd(e){let{value:t}=e.target;this.endCalciteInput.value!==void 0&&(this.model.setGuideEnd(t===""?null:t,this.index,this.orientation),this.symbolChange(),this.arcgisChartsConfigGuideChange.emit({index:this.index,orientation:this.orientation,isDelete:!1}),C({inputElement:this.endCalciteInput.value,status:x.IDLE})),this.guidePopover?.open===!0&&this.removeGuidePopover()}setGuideDateTimeRange(){let e=this.calculatedMinMaxBounds?.find(m=>m.isXAxis)?.minimum,t=this.calculatedMinMaxBounds?.find(m=>m.isXAxis)?.maximum,i=typeof e=="number"?new Date(e):new Date,n=typeof t=="number"?new Date(t):new Date,l=new window.Intl.DateTimeFormat().resolvedOptions().timeZone,s=Z(this.timeZone)??l,d=D(i,s),f=P(i,s),$=D(n,s),ie=P(n,s),_=this.startDateCalciteInput.value?.value??"",b=_===""?d:_,F=this.startTimeCalciteInput.value?.value??"",L=F===""?f:F,G=this.endDateCalciteInput.value?.value??"",y=G===""?$:G,M=this.endTimeCalciteInput.value?.value??"",B=M===""?ie:M,w=!1;if(!Array.isArray(b)&&b!==void 0&&L!==void 0){let m=`${b}T${L}`;this.model.setGuideStart(m,this.index,this.orientation),w=!0}if(!Array.isArray(y)&&y!==void 0&&B!==void 0){let m=G===""?void 0:`${y}T${B}`;this.model.setGuideEnd(m,this.index,this.orientation),w=!0}w&&(this.symbolChange(),this.arcgisChartsConfigGuideChange.emit({index:this.index,orientation:this.orientation,isDelete:!1}),this.guidePopover?.open===!0&&this.removeGuidePopover())}setGuideName(e){let t=e.target.value;this.model.setGuideName(t,this.index,this.orientation),this.arcgisChartsConfigGuideChange.emit({index:this.index,orientation:this.orientation,isDelete:!1})}setGuideLabel(e){let t=e.target.value;this.model.setGuideLabelText(t,this.index,this.orientation),this.arcgisChartsConfigGuideChange.emit({index:this.index,orientation:this.orientation,isDelete:!1})}setGuideRendered(e){let t=e.target?.selectedItem?.value;if(t!==void 0){let i=t===this._messages.inFront;this.model.setGuideAbove(i,this.index,this.orientation),this.arcgisChartsConfigGuideChange.emit({index:this.index,orientation:this.orientation,isDelete:!1})}}lineStyleChange(e){let t=e.detail;this.model.setGuideStyle(t,this.index,this.orientation),this.arcgisChartsConfigGuideChange.emit({index:this.index,orientation:this.orientation,isDelete:!1})}setupGuidePopover(e){e.stopImmediatePropagation();let t=this.model.getGuideStyle(this.index,this.orientation),i=this.model.getGuideStart(this.index,this.orientation),n=this.model.getGuideEnd(this.index,this.orientation),l;p(i,n)===u.SLS?l=g(t)?t:void 0:l=t?.color;let s=this.colorElement.value;Array.isArray(t?.color)?(this.guidePopover=I(r`<arcgis-charts-config-guide-popover .referenceElement=${s} open .selectedElement=${l} @arcgisChartsConfigGuidePopoverColorChange=${this.colorChange} @arcgisChartsConfigGuidePopoverSymbolChange=${this.symbolChange} @arcgisChartsConfigPopoverClose=${this.removeGuidePopover}></arcgis-charts-config-guide-popover>`),this.guidePopover!==void 0&&!document.body.contains(this.guidePopover)&&document.body.appendChild(this.guidePopover)):this.removeGuidePopover()}removeGuidePopover(){this.guidePopover!==null&&this.guidePopover!==void 0&&(this.guidePopover=ee(this.guidePopover))}setColor(e){let t=q({opacity:0}),i=this.model.getGuideStyle(this.index,this.orientation),n={...O(i)?i:{},type:u.SFS,color:e,outline:t};this.model.setGuideStyle(n,this.index,this.orientation),this.arcgisChartsConfigGuideChange.emit({index:this.index,orientation:this.orientation,isDelete:!1})}getDateStringFromBound(e){return typeof e=="string"?e.split("T")[0]:""}getTimeStringFromBound(e){return typeof e=="string"?e.split("T")[1]:""}createTooltip(e){let t=e.target,i="";switch(t.icon){case"view-visible":i=this._messages.hideGuide??"";break;case"view-hide":i=this._messages.showGuide??"";break;case"trash":default:i=this._messages.deleteGuide??"";break}this.tooltip=I(r`<calcite-tooltip style=${S({opacity:1,zIndex:"var(--calcite-floating-ui-z-index)"})} .referenceElement=${t} open placement=top>${i}</calcite-tooltip>`),document.body.appendChild(this.tooltip)}toggleGuide(){let e=this.model.getGuideVisibility(this.index,this.orientation);this.model.setGuideVisibility(!e,this.index,this.orientation)}destroyTooltip(){K(this.tooltip)}deleteGuide(){this.destroyTooltip(),this.orientation===v.X&&W(this.model)?this.model.deleteXAxisGuide(this.index):this.orientation===v.Y&&H(this.model)&&this.model.deleteYAxisGuide(this.index),this.arcgisChartsConfigGuideChange.emit({index:this.index,orientation:this.orientation,isDelete:!0})}renderColorElement(){let e=this.model.getGuideStyle(this.index,this.orientation),[t,i,n,l]=[...e?.color??[1,1,1,255]],s=this.model.getGuideStart(this.index,this.orientation),d=this.model.getGuideEnd(this.index,this.orientation),f=g(e)?J(e.style):V.Solid,$=p(s,d)===u.SLS?`line-${f}`:"square-f";return r`<calcite-list label selection-mode=single selection-appearance=border><calcite-list-item .value=${this._messages.style} class=${o(a.colorPicker)} .label=${this._messages.style} .selected=${this.guidePopover?.open} @click=${this.onColorElementSelect} ${h(this.colorElement)}><calcite-icon slot=content-end .icon=${$} style=${S({color:`rgba(${t},${i},${n},${l/255})`})}></calcite-icon></calcite-list-item></calcite-list>`}render(){let e=this.model.getGuideStart(this.index,this.orientation),t=this.model.getGuideEnd(this.index,this.orientation),i=this.model.getGuideName(this.index,this.orientation),n=this.model.getGuideLabelText(this.index,this.orientation),l=this.model.getGuideAbove(this.index,this.orientation),s=this.model.getGuideVisibility(this.index,this.orientation),d=this.isXAxisDateField;return r`<calcite-block .heading=${i??""} .open=${this.latestGuidePosition===te(this.index,this.orientation,this.model)} collapsible .messageOverrides=${{expand:this._messages.expand,collapse:this._messages.collapse}}><calcite-action slot=control text .icon=${s?"view-visible":"view-hide"} @click=${this.toggleGuide} @mouseover=${this.createTooltip} @mouseout=${this.destroyTooltip}></calcite-action><calcite-action slot=control text icon=trash @click=${this.deleteGuide} @mouseover=${this.createTooltip} @mouseout=${this.destroyTooltip}></calcite-action><div class=${o(a.row)}><calcite-label class=${o(a.column)}>${this._messages.start}${d?r`<calcite-input-date-picker .value=${this.getDateStringFromBound(e)} required scale=s placement=bottom-end @calciteInputDatePickerChange=${this.setGuideDateTimeRange} ${h(this.startDateCalciteInput)}></calcite-input-date-picker>`:r`<calcite-input type=number required @calciteInputInput=${this.setGuideStart} @keydown=${T} number-button-type=none .value=${e?.toString()} ${h(this.startCalciteInput)}></calcite-input>`}</calcite-label><calcite-label class=${o(a.column)}>${this._messages.end}${d?r`<calcite-input-date-picker .value=${this.getDateStringFromBound(t)} scale=s placement=bottom-end @calciteInputDatePickerChange=${this.setGuideDateTimeRange} ${h(this.endDateCalciteInput)}></calcite-input-date-picker>`:r`<calcite-input type=number @calciteInputInput=${this.setGuideEnd} @keydown=${T} number-button-type=none .value=${t?.toString()} ${h(this.endCalciteInput)}></calcite-input>`}</calcite-label></div>${d?Q("time-picker-row",r`<div class=${o(a.row)}>${e!=null?r`<calcite-label class=${o(a.column)}><calcite-input-time-picker .value=${this.getTimeStringFromBound(e)} scale=s @calciteInputTimePickerChange=${this.setGuideDateTimeRange} ${h(this.startTimeCalciteInput)}></calcite-input-time-picker></calcite-label>`:null}${t!=null?r`<calcite-label class=${o(a.column)}><calcite-input-time-picker .value=${this.getTimeStringFromBound(t)} scale=s @calciteInputTimePickerChange=${this.setGuideDateTimeRange} ${h(this.endTimeCalciteInput)}></calcite-input-time-picker></calcite-label>`:null}</div>`):null}<div class=${o(a.row)}><div class=${o(a.column)}>${this.renderColorElement()}</div></div><div class=${o(a.row)}><calcite-label class=${o(a.column)}>${this._messages.guideName}<calcite-input type=text .value=${i} @calciteInputInput=${this.setGuideName}></calcite-input></calcite-label></div><div class=${o(a.row)}><calcite-label class=${o(a.column)}>${this._messages.guideLabel}<calcite-input type=text .value=${n} @calciteInputInput=${this.setGuideLabel}></calcite-input></calcite-label></div><div class=${o(a.row)}><calcite-label class=${o(a.column)}>${this._messages.display}<calcite-segmented-control @calciteSegmentedControlChange=${this.setGuideRendered} scale=s><calcite-segmented-control-item .checked=${l} .value=${this._messages.inFront}>${this._messages.inFront}</calcite-segmented-control-item><calcite-segmented-control-item .checked=${!l} .value=${this._messages.inBack}>${this._messages.inBack}</calcite-segmented-control-item></calcite-segmented-control></calcite-label></div></calcite-block>`}};N("arcgis-charts-config-guide",A);return A},"geometry/support/jsonUtils","rest/support/AttributeBinsQuery","rest/support/Query","rest/support/StatisticDefinition","time/TimeExtent","core/promiseUtils","request",a,b,d)