/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
v4.34.3 */
import i from"./DZ3SLLYL.js";import h from"./6KL5YQAS.js";import f from"./XCUGMEPO.js";import e from"./MJVNOHMT.js";import c from"./CDJV5WUJ.js";import{i as o,j as l,k as a}from"./UM26TKF2.js";import b from"./GUWCFIQ4.js";import{j as T}from"./MHMLEVRX.js";import{a as D}from"./5BG7WW2E.js";import{a as w,b as g,f as d}from"./2YIVYDK5.js";export default $arcgis.t(([,,,,,,,{Dc:k,O:O,Q:B,Qa:V,W:U,_:b,ca:P,k:m},{a:f,b:y,c:E},{$:R,Ba:_,Ca:A,Da:ee,Ea:ie,_:M,aa:N,b:L,ba:z,c:p,ca:q,da:j,e:u,ea:G,fa:H,ga:J,ha:W,ia:X,ka:Y,la:K,ma:Q,ua:Z,va:h,wa:$,xa:c,ya:S,za:F},{a:C,c:te,d:se,e:re},{a:ne,b:oe,c:ae,d:ge},le])=>{var x=class extends C{get temporalBinningSize(){return M(this._config)}set temporalBinningSize(e){this.guardSetterFromAsyncOverwrite(()=>{j(e,this._config),this.emitConfigUpdate("temporalBinningSize")})}get temporalBinningUnit(){return R(this._config)}set temporalBinningUnit(e){this.guardSetterFromAsyncOverwrite(()=>{H(e,this._config),this.emitConfigUpdate("temporalBinningUnit")})}get timeAggregationType(){return N(this._config)}set timeAggregationType(e){this.guardSetterFromAsyncOverwrite(()=>{J(e,this._config),this.emitConfigUpdate("timeAggregationType")})}get trimIncompleteTimeInterval(){return z(this._config)}set trimIncompleteTimeInterval(e){this.guardSetterFromAsyncOverwrite(()=>{W(e,this._config),this.emitConfigUpdate("trimIncompleteTimeInterval")})}get nullPolicy(){return q(this._config)}set nullPolicy(e){this.guardSetterFromAsyncOverwrite(()=>{G(e,this._config),this.emitConfigUpdate("nullPolicy")})}resetTimeInterval(){this.guardSetterFromAsyncOverwrite(()=>{X(this._config),this.emitConfigUpdate("resetTimeInterval")})}},he=(s,e)=>e.series?.[s].assignToSecondValueAxis??!1,ce=s=>{let{assign:e,seriesIndex:i,config:t,commonStrings:r}=s;e&&t.axes!==void 0&&!t.axes?.[2]&&(t.axes[2]=b(r,w.BarSeries)[1]),t.series&&t.series.forEach((n,I)=>{I===i?n.assignToSecondValueAxis=e:I!==i&&n?.assignToSecondValueAxis!==!0&&(n.assignToSecondValueAxis=!1)}),t.axes?.[2]&&!t.series.some(n=>n.assignToSecondValueAxis)&&t.axes.splice(2,1)},de=(s,e)=>e.series?.[s]?.name,me=(s,e,i)=>{i.series?.[e]&&(i.series[e].name=s)},fe=(s,e)=>{let i=e.series?.[s],t;return a(i)?t=i.fillSymbol?.color:o(i)&&(t=i.lineSymbol?.color),t},ye=(s,e,i)=>{let t=i.series?.[e];t&&(a(t)?t.fillSymbol={...P(e),...t.fillSymbol,color:s}:o(t)&&(t.lineSymbol={...U(e),...t.lineSymbol,color:s}))},pe=s=>s.series.map(e=>e.id),ue=(s,e)=>{e.series?.sort((i,t)=>s.findIndex(r=>i.id===r)-s.findIndex(r=>t.id===r))},Se=s=>s.stackedType??d.Side,Fe=s=>{let{newStackedType:e,config:i,layerInfo:t,commonStrings:r}=s;if(i.stackedType=e,t!==void 0){let n=p({config:i,layerInfo:t,commonStrings:r,numericFields:c(i),aggregationType:h(i)});L(i,1,n)}i.axes?.[1]&&(e===d.Stacked100?i.axes[1].valueFormat=B():i.axes[1].valueFormat=O()),u({config:i,value:null,axisIndex:1,isMax:!1}),u({config:i,value:null,axisIndex:1,isMax:!0})},_e=s=>{let e,i=s.series.find(t=>(a(t)||o(t)||l(t))&&t.nullCategory!==void 0);return(a(i)||o(i)||l(i))&&(e=i?.nullCategory),e},Ae=(s,e)=>{s.series.forEach(i=>{(a(i)||o(i)||l(i))&&(i.nullCategory=e)})},v=class extends C{constructor(){super(...arguments),this._xAxisField="",this._aggregationType=g.Count,this._splitByField="",this._numericFields=[]}get xAxisField(){return this._xAxisField}set xAxisField(e){if(this._xAxisField=e,this.dirtyAsyncSetters.push("xAxisField"),e.trim()===""||e===m){let i=this.numericFields;this.resetConfig(),this.numericFields=i}this.processSeriesRebuild()}get aggregationType(){return this._aggregationType}set aggregationType(e){this._aggregationType=e,this.dirtyAsyncSetters.push("aggregationType"),this.processSeriesRebuild()}get splitByField(){return this._splitByField}set splitByField(e){this.layerInfo?.layerFieldsInfo&&Y(this.layerInfo?.layerFieldsInfo,e)&&(this._splitByField=e,this.dirtyAsyncSetters.push("splitByField"),this.processSeriesRebuild())}get numericFields(){return this._numericFields}set numericFields(e){typeof e=="string"&&(e=[e]);let i=K(this.layerInfo?.layerFieldsInfo??[],e),t=(this.xAxisField===""||this.xAxisField===m)&&e.length===0;if(i&&!t){let r=this.layerInfo?.objectIdField??"";e.length===0?(e.push(r),this._aggregationType=g.Count):this._aggregationType===g.Count&&e.length>=1&&!e.includes(r)&&(this._aggregationType=g.Sum),this._numericFields=e,this.dirtyAsyncSetters.push("numericFields"),this.numericFields.length>1&&(this._splitByField="",this.dirtyAsyncSetters.push("splitByField")),this.processSeriesRebuild()}else t&&this.resetConfig()}getAssignToSecondValueAxis(e){return he(e,this._config)}setAssignToSecondValueAxis(e,i){this.guardSetterFromAsyncOverwrite(()=>{ce({assign:e,seriesIndex:i,config:this._config,commonStrings:this.commonStrings}),this.emitConfigUpdate("setAssignToSecondValueAxis")})}getSortOrder(){return S(this._config)}setSortOrder(e,i){this.guardSetterFromAsyncOverwrite(()=>{y(e,this._config,i),this.emitConfigUpdate("setSortOrder")})}async getCustomSortValues(){return await A(this._config,this.layerInfo)}async setDataFilters(e){super.setDataFilters(e);let i=S(this._config);if(i===D.customSort){let t=await A(this._config,this.layerInfo);y(i,this._config,t)}this.dispatchEvent(new CustomEvent("arcgisChartsModelDataChange")),this.emitConfigUpdate("setDataFilter")}get orderByList(){return f(this._config)}set orderByList(e){this.guardSetterFromAsyncOverwrite(()=>{!k(this._config)&&(_(e,this._config),this.emitConfigUpdate("orderByList"))})}async updateSeriesFromLayerFilter(){this.layerInfo!==void 0&&(this.dirtyAsyncSetters.push("updateSeriesFromLayerFilter"),await this.processSeriesRebuild())}get binTemporalData(){return ee(this._config)}set binTemporalData(e){this.guardSetterFromAsyncOverwrite(()=>{ie(e,this._config),this.emitConfigUpdate("enableTemporalBinning")})}getSeriesName(e){return de(e,this._config)}setSeriesName(e,i){this.guardSetterFromAsyncOverwrite(()=>{me(e,i,this._config),this.emitConfigUpdate("setSeriesName")})}getSeriesColor(e){return fe(e,this._config)}setSeriesColor(e,i){this.guardSetterFromAsyncOverwrite(()=>{ye(e,i,this._config),this.emitConfigUpdate("setSeriesColor")})}getOrderOfSeries(){return pe(this._config)}setOrderOfSeries(e){this.guardSetterFromAsyncOverwrite(()=>{ue(e,this._config),this.emitConfigUpdate("setOrderOfSeries")})}get stackedType(){return Se(this._config)}set stackedType(e){this.guardSetterFromAsyncOverwrite(()=>{Fe({newStackedType:e,config:this._config,layerInfo:this.layerInfo,commonStrings:this.commonStrings}),this.emitConfigUpdate("stackedType")})}moveSeries(e,i){this.guardSetterFromAsyncOverwrite(()=>{let t=this.getOrderOfSeries(),[r]=t.splice(e,1);t.splice(i,0,r),this.setOrderOfSeries(t),this.emitConfigUpdate("moveSeries")})}moveCustomSortValuesInOrderByList(e,i){this.guardSetterFromAsyncOverwrite(()=>{let t=f(this._config),[r]=t.splice(e,1);t.splice(i,0,r),_(t,this._config),this.emitConfigUpdate("moveCustomSortValuesInOrderByList")})}get nullCategory(){return _e(this._config)}set nullCategory(e){this.guardSetterFromAsyncOverwrite(()=>{let i=this.nullCategory;T(i,e)||(Ae(this._config,e),this.emitConfigUpdate("setNullCategory"))})}setupLocalProps(){this._xAxisField=E(this._config),this._aggregationType=h(this._config),this._splitByField=$(this._config),this._numericFields=c(this._config)}resetConfig(){let e=this._config.id;this._config=this.generateDefaultConfig(),this._config.id=e,this.setupLocalProps(),this.dispatchEvent(new CustomEvent("arcgisChartsModelDataChange")),this.emitConfigUpdate("resetConfig")}canUseSynchronousSeriesRebuild(){return this.splitByField===""||this.numericFields.length>1}async processSeriesRebuild(){if(this.layerInfo!==void 0){let e=this.dirtyAsyncSetters[this.dirtyAsyncSetters.length-1];if(this.canUseSynchronousSeriesRebuild())this.dirtyAsyncSetters=[],F(this.getBuildNewSeriesProps());else if(!this.asyncConfigUpdateInProgress){for(this.asyncConfigUpdateInProgress=!0,this.setupFinished=new Promise(i=>{this.resolveSetup=i});this.dirtyAsyncSetters.length>0;)this.dirtyAsyncSetters=[],await F(this.getBuildNewSeriesProps());this.asyncConfigUpdateInProgress=!1,this.resolveSetup?.()}this.setupLocalProps(),this.dispatchEvent(new CustomEvent("arcgisChartsModelDataChange")),this.emitConfigUpdate(e)}}getBuildNewSeriesProps(){return{xAxisField:this.xAxisField,splitByField:this.splitByField,numericFields:this.numericFields,aggregationType:this.aggregationType,config:this._config,layerInfo:this.layerInfo,commonStrings:this.commonStrings}}generateChartTitle(){return this.layerInfo!==void 0?Z(this._config,this.layerInfo,this.commonStrings):""}generateXAxisTitle(){return this.layerInfo!==void 0?V(this.layerInfo.layerFieldsInfo,this._xAxisField):""}generateYAxisTitle(){return this.layerInfo!==void 0?p({config:this._config,layerInfo:this.layerInfo,commonStrings:this.commonStrings,numericFields:c(this._config),aggregationType:h(this._config)}):""}};Q(v,[re,oe,ae,ne,le,ge,te,se,x]);return{a:de,b:me,c:ye,d:v}},"geometry/support/jsonUtils","rest/support/AttributeBinsQuery","rest/support/Query","rest/support/StatisticDefinition","time/TimeExtent","core/promiseUtils","request",b,c,e,f,h,i)