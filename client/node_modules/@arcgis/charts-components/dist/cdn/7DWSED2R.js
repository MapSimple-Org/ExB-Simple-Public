/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
v4.34.3 */
import c from"./MJVNOHMT.js";import b from"./CDJV5WUJ.js";import{h as O,n as ae}from"./UM26TKF2.js";import a from"./GUWCFIQ4.js";import{d as $,f as E,i as Z,j as ee,q as oe}from"./MHMLEVRX.js";import{b as d}from"./5BG7WW2E.js";import{a as f,h,v as u}from"./2YIVYDK5.js";export default $arcgis.t(([,,,,,,,{substitute:P},{B:I,Dc:L,Fa:G,L:J,M:ie,N:se,Qa:B,U:D,V:W,aa:re,ea:_,ib:A,mb:ne,pc:te,rc:H,sc:K,z:j,zb:le},{f:T},{M:N,b:C,e:Q,g:R,h:ce,ja:ye,na:de,q:me}])=>{var so=(o,e)=>e?.series?.[o]?.name,ro=(o,e,i)=>{let s=i;s?.series?.[e]!==void 0&&(s.series[e].name=o)},no=(o,e)=>{let i,s=e.series?.[o];return s?.type===f.BoxPlotSeries?i=s.fillSymbol?.color:s?.type===f.LineSeries&&(i=s.lineSymbol?.color),i},ve=o=>{let e=o.series[0];return o.showMean===!0&&O(e)?e.fillSymbol?.color:void 0},Be=(o,e)=>{let i=e.series[0];e.showMean===!0&&O(i)&&(i.fillSymbol!==void 0?i.fillSymbol.color=o:i.fillSymbol={...D(),color:o})},lo=(o,e,i)=>{let s=i?.series?.[e];s?.type===f.BoxPlotSeries&&s.fillSymbol!==void 0?s.fillSymbol.color=o:s?.type===f.LineSeries&&s.lineSymbol!==void 0&&(s.lineSymbol.color=o,s.markerSymbol!==void 0&&(s.markerSymbol.color=o))},Me=o=>o.series.map(e=>e.id),Ae=(o,e)=>{e?.series?.sort((i,s)=>o.findIndex(r=>i.id===r)-o.findIndex(r=>s.id===r))},to=(o,e,i)=>{let s=Me(i),[r]=s.splice(o,1);s.splice(e,0,r),Ae(s,i)},ao=o=>U(o)?o.series.findIndex(e=>e.type===f.BoxPlotSeries):-1;function Le(o,e,i){let s=xe(o,e,i),r=me(o),n=L(o);return s===r||n}function fe(o,e,i){let s=k(o,e,i),r=N(1,o),n=L(o);return s===r||n}function Oe(o){let{config:e,layerInfo:i,newCategory:s}=o,{layerFieldsInfo:r}=i,n=M(e),t=s!==I?B(r,n):"",l=N(0,e),a=L(e);return t===l||a||l.trim()===""}var M=o=>A(o)?.x??I,Ce=$(o=>{let e=A(o),i=e?.query?.where?.split("=")[0].trim()??"";return ne(e?.query?.where)?"":i},o=>A(o)?.query?.where),ge=$(o=>le(o?.series).filter(e=>e!==""),o=>o?.series),V=o=>{let{category:e,seriesIndex:i,y:s,commonStrings:r}=o,n={..._(r,i),x:e===void 0||e===""?I:e,y:s,query:{}};return E(n)},ke=o=>{let{category:e,seriesIndex:i,y:s,commonStrings:r}=o,n={...re({commonStrings:r,seriesIndex:i}),x:e===void 0||e===""?I:e,y:s,query:{}};return E(n)};function ue(o){let{x:e,y:i,seriesTemplate:s,commonStrings:r}=o,{id:n,fillSymbol:t}=s??{},l=_(r),a=n??`series_${Date.now()}`;return l.id=a,l.name=a,l.x=e,l.y=i,t?l.fillSymbol=t:l.fillSymbol&&(l.fillSymbol.color=G,l.fillSymbol?.outline&&(l.fillSymbol.outline.color=G)),l}function Se(o){let{numericFields:e,config:i,layerInfo:s,category:r,commonStrings:n}=o,{layerFieldsInfo:t}=s,l=[],a=r??M(i),m=!1,c=T({fieldName:a,numericFields:e,fieldList:t});if(e.length===0){let S=V({y:"",seriesIndex:0,category:a,commonStrings:n});l.push(S)}else if(c){let S=e.length>1?e:e[0],F=V({y:S,seriesIndex:0,category:a,commonStrings:n}),b=e.length>1?n.axisLabels.values:B(s.layerFieldsInfo,e[0]),p={...F,id:e[0],name:b,x:c?I:a},g=i.series.find(y=>ee(S,y.y)&&y.query?.where===void 0);g!==void 0&&(!i.colorMatch&&"fillSymbol"in g&&(p.fillSymbol=g.fillSymbol,m=!0),p.id=g.id,p.name=g.name),l.push(p)}else for(let S=0;S<e.length;S+=1){let F=e[S],b=V({y:F,seriesIndex:S,category:a,commonStrings:n}),p=B(t,F),g={...b,id:F,name:p,x:a},y=i.series.find(v=>F===v.y);y!==void 0&&(!i.colorMatch&&"fillSymbol"in y&&(g.fillSymbol=y.fillSymbol,m=!0),g.id=y.id,g.name=y.name),l.push(g)}return i.series.length===1&&l.length===1&&!i.colorMatch&&"fillSymbol"in i.series[0]&&(l[0].fillSymbol=i.series[0].fillSymbol,m=!0),i.colorMatch=!m,l}var pe=o=>o?.query?.where?.split("=")[1].trim().replace(/'/gu,"")??"",qe=o=>o.series.some(e=>e.type===f.LineSeries)&&o.series.some(e=>e.type===f.BoxPlotSeries);function De(o,e,i){let s=[];return o.forEach(r=>{if(r.type===f.BoxPlotSeries){let{type:n,fillSymbol:t,...l}=r;s.push({...l,type:f.LineSeries,lineSymbol:{...J({width:j}),...t!==void 0?{color:t.color}:{}},markerSymbol:{...W(),...t!==void 0?{color:t.color}:{}}})}}),s.unshift(ue({x:o[0].x,y:o[0].y,seriesTemplate:i,commonStrings:e})),s}function Te(o){let e=o.slice(1),i=[];return e.forEach(s=>{if(s.type===f.LineSeries){let{type:r,lineSymbol:n,markerSymbol:t,...l}=s,a=D();i.push({...l,type:f.BoxPlotSeries,fillSymbol:{...a,color:n?.color}})}}),i}function be(o){let{formerSeries:e,newSeries:i,showMean:s}=o,r=i,n=a=>a.type===(s?f.LineSeries:f.BoxPlotSeries),t=e.filter(n).map(a=>a.id),l=i.filter(n).map(a=>a.id);return t.length===l.length&&JSON.stringify(t)!==JSON.stringify(l)&&(r=r.sort((a,m)=>t.findIndex(c=>c===a.id)-t.findIndex(c=>c===m.id))),r}async function Ne(o){let{config:e,layerInfo:i,commonStrings:s,splitByField:r,numericFields:n,category:t}=o,{layer:l,layerFieldsInfo:a}=i,{fetchNullValues:m}=A(e)?.query??{},c=t??M(e),{categoriesArray:S,splitByFieldType:F}=await ye({config:e,layer:l,layerFieldsInfo:a,xAxisField:X(c)?void 0:c,aggregationFields:n,splitByField:r,fetchNullValues:m}),b=[],p=!1,g=qe(e);if(S.length===0){b=Se({numericFields:n,category:c,config:e,layerInfo:i,commonStrings:s});for(let y of b)y.query&&(y.query.where=`${r}=''`)}else for(let y=0;y<S.length;y+=1){let v=S[y],q={y:n,seriesIndex:y,category:c,commonStrings:s},Y=g?ke(q):V(q),Fe={fieldName:r,fieldValueToMatch:v??"",subtypeInfo:H(i.layer),fieldList:i.layerFieldsInfo},we=K(Fe),z=`${v}`,w={...Y,id:z,name:we??z,x:c===void 0||c===""?I:c,query:{...Y.query,where:`${r}=${F===oe.String&&v!==null?`'${v}'`:v}`}},x=e.series.find(Ie=>pe(Ie)===z);x!==void 0&&(e.colorMatch||(w.type===f.BoxPlotSeries?O(x)?w.fillSymbol=x.fillSymbol:w.fillSymbol={...D(),color:x.lineSymbol?.color}:O(x)?(w.lineSymbol={...J({width:j}),...x.fillSymbol!==void 0?{color:x.fillSymbol.color}:{}},w.markerSymbol={...W(),...x.fillSymbol!==void 0?{color:x.fillSymbol.color}:{}}):(w.lineSymbol=x.lineSymbol,w.markerSymbol=x.markerSymbol),p=!0),w.id=x.id,w.name=x.name),b.push(w)}if(b=be({formerSeries:e.series,newSeries:b,showMean:U(e)}),e.colorMatch=!p,U(e)){let y=e.series.find(q=>q.type===f.BoxPlotSeries),v=ue({x:c,y:n,seriesTemplate:y,commonStrings:s});b.unshift(v)}return b}var co=async o=>{let{splitByField:e,numericFields:i,category:s,config:r,layerInfo:n,commonStrings:t}=o,{layerFieldsInfo:l}=n,a=$e(s,i,e),m=te(l),c=M(r),S=Le(r,n,t),F=fe(r,n,t),b=Oe({config:r,layerInfo:n,newCategory:s}),p=R(r);if(!m.includes(c)&&m.includes(s)?p=se():m.includes(c)&&!m.includes(s)&&(p=ie()),p!==void 0&&ce(r,t,p),Ve(a?{newShowMeanLines:r.showMean,config:r,commonStrings:t}:{newShowMeanLines:!1,config:r,commonStrings:t}),r.series=a?await Ne({config:r,layerInfo:n,splitByField:e,numericFields:i,category:s,commonStrings:t}):Se({numericFields:i,config:r,layerInfo:n,category:s,commonStrings:t}),b){let g=T({fieldName:s,numericFields:i,fieldList:l})?"":B(l,s);C(r,0,g)}if(F){let g=k(r,n,t);C(r,1,g)}r?.title!==void 0&&S&&(r.title.content.text=xe(r,n,t)),Q({config:r,value:null,axisIndex:1,isMax:!1}),Q({config:r,value:null,axisIndex:1,isMax:!0})},Pe=o=>o?.standardizeValues??!1;function k(o,e,i){let{layerFieldsInfo:s}=e,r=Pe(o)?i.axisLabels.standardizedValues:i.axisLabels.values,n=o?.series?.map(t=>t.y).flat();return n=[...new Set(n)],n.length===1&&(r=B(s,n[0])),r}function xe(o,e,i){let{layerFieldsInfo:s}=e,r=M(o),n=ge(o),t=Ce(o),l=n.map(c=>B(s??[],c)).join(", "),a=B(s??[],r),m="";return n.length>0&&(r!==I&&t!==""?m=P(i.titleLabels.distributionOfFieldsByCategoryAndSplitBy,{valueFields:l,category:a,splitByField:t}):r!==I?m=P(i.titleLabels.distributionOfFieldsByCategory,{valueFields:l,category:a}):t!==""?m=P(i.titleLabels.distributionOfFieldsByCategory,{valueFields:l,category:t}):m=P(i.titleLabels.distributionOfField,{valueField:l})),m}var mo=o=>{let{series:e,splitByField:i,layerInfo:s,commonStrings:r}=o,n=typeof e.y=="string"?B(s.layerFieldsInfo,e.y):r.axisLabels.values;Z(i)||(n=pe(e));let t={fieldName:i,fieldValueToMatch:n??"",subtypeInfo:H(s.layer),fieldList:s.layerFieldsInfo};return n=K(t)??n,n??e.id},yo=o=>o?.showOutliers??!1,fo=o=>{let{newShowOutliers:e,config:i,layerInfo:s,commonStrings:r}=o;if(i.showOutliers=e,fe(i,s,r)){let n=k(i,s,r);C(i,1,n)}},go=o=>{let{newStandardizeValues:e,config:i,layerInfo:s,commonStrings:r}=o,n=N(1,i),t=k(i,s,r),l=L(i);if(i.standardizeValues=e,n===t||l){let a=k(i,s,r);C(i,1,a)}},he=o=>{let e=d.xAxisAsc,i=o.orderOptions?.data?.orderType??u.Category,s=o.orderOptions?.data?.orderBy??h.Ascending;switch(i){case u.Category:e=Array.isArray(s)?d.customSort:s===h.Ascending?d.xAxisAsc:d.xAxisDesc;break;case u.Mean:e=s===h.Ascending?d.meanAsc:d.meanDesc;break;case u.Median:e=s===h.Ascending?d.medianAsc:d.medianDesc;break}return e},uo=(o,e,i)=>{let s=u.Category,r=h.Ascending;if(e.orderOptions=e.orderOptions??{},o===d.customSort&&i!==void 0)e.orderOptions.data={orderType:u.Category,orderBy:i};else{switch(o){case d.xAxisAsc:{s=u.Category,r=h.Ascending;break}case d.xAxisDesc:{s=u.Category,r=h.Descending;break}case d.meanAsc:{s=u.Mean,r=h.Ascending;break}case d.meanDesc:{s=u.Mean,r=h.Descending;break}case d.medianAsc:{s=u.Median,r=h.Ascending;break}case d.medianDesc:{s=u.Median,r=h.Descending;break}}e.orderOptions.data={orderType:s,orderBy:r}}},U=o=>o.showMean??!1,Ve=o=>{let{newShowMeanLines:e=!1,config:i,commonStrings:s,previousMeanLinesBoxColor:r}=o,n=e?r:ve(i),t=(e??!1)!==(i.showMean??!1);if(i.showMean=e,t){let l;e?l=ae(i.series)?De(i.series,s):i.series:l=Te(i.series),l&&(l=be({formerSeries:i.series,newSeries:l,showMean:e}),i.series=l)}return e&&r!==void 0&&Be(r,i),{previousMeanLinesBoxColor:n}},So=o=>{let e=[],i=o.orderOptions?.data?.orderType;return he(o)===d.customSort&&i===u.Category&&(e=o.orderOptions?.data?.orderBy),e},po=(o,e)=>{e.orderOptions??={};let i=e.orderOptions?.data?.orderType;he(e)===d.customSort&&i===u.Category&&(e.orderOptions.data={orderType:u.Category,orderBy:o})},bo=async(o,e)=>{let i=M(o),s=R(o)?.type,r=ge(o),n=[];return s===f.CategoryAxisFormat&&(T({fieldName:i,numericFields:r,fieldList:e.layerFieldsInfo})?n=r:X(i)||(n=await de({layerInfo:e,config:o,category:i}))),n},X=o=>o.trim()===""||o===I,ze=(o,e)=>e.length>1&&!X(o),$e=(o,e,i)=>!ze(o,e)&&i!=="";return{a:so,b:ro,c:no,d:ve,e:Be,f:lo,g:Me,h:Ae,i:to,j:ao,k:M,l:Ce,m:ge,n:co,o:Pe,p:k,q:xe,r:mo,s:yo,t:fo,u:go,v:he,w:uo,x:U,y:Ve,z:So,A:po,B:bo,C:ze,D:$e}},"geometry/support/jsonUtils","rest/support/AttributeBinsQuery","rest/support/Query","rest/support/StatisticDefinition","time/TimeExtent","core/promiseUtils","request","intl",a,b,c)