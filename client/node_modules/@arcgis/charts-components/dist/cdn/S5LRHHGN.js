/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
v4.34.3 */
import{a as u}from"./MWPCQM2X.js";import{a as f}from"./XIZLMN6F.js";import{a as o}from"./JHAJCFXL.js";import d from"./MSRS6EXP.js";import"./TLMHEFBH.js";import{a as S}from"./BMZ5OG4J.js";import b from"./TNMDYW24.js";import a from"./GUWCFIQ4.js";import"./MHMLEVRX.js";import"./DXCHSVBP.js";import"./5BG7WW2E.js";import"./2YIVYDK5.js";import{B as m,D as g,F as p,g as h,h as r,y as c}from"./GRWAOK3Y.js";import"./UUMP6K6L.js";export default $arcgis.t(([,,,,,,,{Ha:C},,{p:v}])=>{var O=h`:host{display:flex;flex-direction:column;width:var(--arcgis-charts-config-calcite-block-default-width);margin:var(--arcgis-charts-config-calcite-block-default-margin)}`,l=class extends c{constructor(){super(...arguments),this._messages=S(),this.seriesPopover=null,this.open=!1,this.seriesNameChange=e=>{if(e.detail!==null||e.detail!==void 0){let s=e.detail?.name;this.model.setSeriesName(s,this.selectedSeriesIndex??-1)}},this.seriesColorChange=e=>{if(e.detail!==null&&e.detail!==void 0){let{color:s}=e.detail;this.model.colorMatch=!1,s!==void 0&&(this.model.setSeriesColor(s,this.selectedSeriesIndex??-1),this.model.setSeriesMarkerColor(s,this.selectedSeriesIndex??-1))}},this.seriesLineStyleChange=e=>{if(e.detail!==null&&e.detail!==void 0){let{lineStyle:s}=e.detail;s!==void 0&&this.model.setSeriesLineStyle(s,this.selectedSeriesIndex??-1)}},this.seriesLineWidthChange=e=>{if(e.detail!==null&&e.detail!==void 0){let{lineWidth:s}=e.detail;s!==void 0&&(this.model.setSeriesLineWidth(s,this.selectedSeriesIndex??-1),this.model.setSeriesMarkerSize(s*2,this.selectedSeriesIndex??-1))}},this.seriesPopoverClose=e=>{let{selectedSeriesIndex:s}=e.detail;this.selectedSeriesIndex===s&&(this.seriesPopover=o(this.seriesPopover),this.selectedSeriesIndex=void 0)},this.onModelConfigChange=()=>{this.requestUpdate()},this.seriesOrderResetCounter=0,this.activeColorMatch=!1,this.popoverPlacement="leading"}static{this.properties={selectedSeriesIndex:16,seriesOrderResetCounter:16,messageOverrides:0,model:0,activeColorMatch:5,popoverPlacement:1}}static{this.styles=O}load(){this.modelChange(this.model),this.onModelConfigChange()}willUpdate(e){e.has("model")&&this.modelChange(this.model,e.get("model")),e.has("selectedSeriesIndex")&&this.selectedSeriesIndexChange()}disconnectedCallback(){super.disconnectedCallback(),this.removeSeriesPopover(),this.model.removeEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange)}modelChange(e,s){s?.removeEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange),e?.addEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange)}selectedSeriesIndexChange(){this.selectedSeriesIndex!==void 0&&(this.seriesPopover=g(r`<arcgis-charts-config-line-chart-series-popover .referenceElement=${this.el} .selectedName=${this.model.getSeriesName(this.selectedSeriesIndex)} .selectedColor=${this.model.getSeriesColor(this.selectedSeriesIndex)} .selectedLineStyle=${this.model.getSeriesLineStyle(this.selectedSeriesIndex)} .selectedLineWidth=${this.model.getSeriesLineWidth(this.selectedSeriesIndex)} .placement=${this.popoverPlacement} .open=${this.open} .selectedSeriesIndex=${this.selectedSeriesIndex} @arcgisChartsConfigSeriesPopoverNameChange=${this.seriesNameChange} @arcgisChartsConfigSeriesPopoverColorChange=${this.seriesColorChange} @arcgisChartsConfigSeriesPopoverLineStyleChange=${this.seriesLineStyleChange} @arcgisChartsConfigSeriesPopoverLineWidthChange=${this.seriesLineWidthChange} @arcgisChartsConfigPopoverClose=${this.seriesPopoverClose}></arcgis-charts-config-line-chart-series-popover>`),this.seriesPopover&&!document.body.contains(this.seriesPopover)&&document.body.appendChild(this.seriesPopover))}removeSeriesPopover(){this.seriesPopover!==void 0&&this.seriesPopover!==null&&(this.seriesPopover.open=!1,this.seriesPopover=o(this.seriesPopover))}buildSeriesListItems(){let e=this.model.seriesLength,s=Array.from({length:e},(i,t)=>t);return u(s,i=>this.model.getSeriesId(i),i=>{let t=this.model.getSeriesId(i),n=this.model.getSeriesColor(i),I=this.model.getSeriesName(i),x=this.model.chartSubType===C.BarAndLineFromFields?this._messages.series:t,$=this.model.getSeriesLineStyle(i),P=v($),a="#CCCCCC",d="minus-circle";if((e>1||!this.activeColorMatch)&&n!==void 0){d=`line-${P}`;let[L,b,y,M]=[...n];a=`rgba(${L},${b},${y},${M/255})`}return r`<calcite-list-item .label=${I??t??""} .description=${x} .value=${t} .selected=${this.selectedSeriesIndex===i} @click=${this.openSeriesPopOver}><calcite-icon slot=content-end .icon=${d} style=${m({color:a})}></calcite-icon></calcite-list-item>`})}buildSeriesList(){return f(this.seriesOrderResetCounter,r`<calcite-list label drag-enabled selection-mode=single selection-appearance=border @calciteListOrderChange=${this.onCalciteListOrderChange}>${this.buildSeriesListItems()}</calcite-list>`)}async resetSeriesOriginal(){this.selectedSeriesIndex=void 0,this.model.resetSeriesStyling(),this.seriesOrderResetCounter+=1}onCalciteListOrderChange(e){if(e.detail!==null&&e.detail!==void 0){let{newIndex:s,oldIndex:i}=e.detail;this.model.moveSeries(i,s),this.seriesOrderResetCounter+=1}}openSeriesPopOver(e){e.stopImmediatePropagation(),this.removeSeriesPopover();let s=e.target,i=s.localName==="calcite-list-item"?s:s.parentNode,t=this.model.getSeriesIndex(i.value);this.open=this.selectedSeriesIndex!==t,this.selectedSeriesIndex=this.selectedSeriesIndex!==t?t:void 0}render(){return r`<calcite-panel .heading=${this._messages.series}><calcite-button slot=header-actions-end @click=${this.resetSeriesOriginal} .disabled=${!this.model.resetAvailable()} appearance=transparent scale=s icon-end=reset>${this._messages.reset}</calcite-button>${this.buildSeriesList()}</calcite-panel>`}};p("arcgis-charts-config-line-chart-series",l);return l},"geometry/support/jsonUtils","rest/support/AttributeBinsQuery","rest/support/Query","rest/support/StatisticDefinition","time/TimeExtent","core/promiseUtils","request",a,b,d)