/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
v4.34.3 */
import{a as B}from"./MWPCQM2X.js";import{a as u}from"./XIZLMN6F.js";import{b as E,c as T}from"./JHAJCFXL.js";import h from"./MSRS6EXP.js";import{k as a}from"./TLMHEFBH.js";import{a as I}from"./BMZ5OG4J.js";import e from"./TNMDYW24.js";import d from"./GUWCFIQ4.js";import{q as b}from"./MHMLEVRX.js";import"./DXCHSVBP.js";import{b as r}from"./5BG7WW2E.js";import"./2YIVYDK5.js";import{A as c,B as $,D as x,F as P,g as y,h as l,l as f,w as g,x as p,y as v}from"./GRWAOK3Y.js";import"./UUMP6K6L.js";export default $arcgis.t(([,,,,,,,{substitute:z},{Qa:L,mc:F,oc:C},{g:w},{a:m,k:h,o:D,r:S}])=>{var o={jsAppFlyout:"js-app-flyout",name:"bar-chart-data-popover",numericFieldPickList:"bar-chart-data-numeric-fields-pick-list",header:"header",fab:"fab",pickListItemLabel:"pick-list-item-label",sortMean:"sort-mean",sortMedian:"sort-median",sortOrderPickList:"sort-order-pick-list",panel:"panel"},O=y`.hide{display:none}.am5-modal{width:100%;height:100%;position:absolute;z-index:100000;top:0;left:0}.am5-modal-curtain{top:0;left:0;width:100%;height:100%;position:absolute;background:#fff!important;z-index:100}.am5-modal-wrapper{top:0;left:0;width:100%;height:100%;position:absolute;display:flex;align-items:center;justify-content:center;white-space:nowrap;background:#ffffff80;z-index:101}.am5-modal-content{display:inline-block;padding:1.2em;vertical-align:middle;text-align:start;white-space:normal;background:#fff;border-radius:4px;box-shadow:#00000073 0 0 36px;color:#000}.am5-layer-1000{z-index:1000!important}.am5-layer-30{z-index:100!important}.arcgis-charts-modal{box-shadow:none!important}.arcgis-charts-modal-header{background-color:#0000000d;font-weight:700;padding:4px;align-content:center}.show{display:block}.notifyPanel{flex:0 1 auto}.disable-interactions{pointer-events:none}.dim-text{color:var(--arcgis-charts-dim-text)}.name{display:flex;flex-direction:column;margin:.5rem;padding:.5rem;background:#fff;min-width:250px}.header{margin:0;font-weight:bolder}.fab{display:flex;justify-content:stretch}.pick-list-item-label{font-size:small}.sort-icon-color{color:#000}.sort-mean,.sort-median{transform:rotate(90deg)}.sort-order-pick-list{overflow-y:hidden}.panel{max-height:60vh}`,k=class extends v{constructor(){super(...arguments),this._messages=I(),this.picklist=g(),this.placement="leading",this.popoverElement=g(),this.offsetDistance=-200,this.pickListHasChanged=!1,this.layerFieldsInfo=[],this.isCustomSortDisabled=!1,this.arcgisChartsConfigBoxPlotDataPopoverChange=f(),this.arcgisChartsConfigPopoverClose=f()}static{this.properties={messageOverrides:0,headingTitle:3,referenceElement:2,open:7,contentKind:1,layerFieldsInfo:0,isCustomSortDisabled:5,selectedContent:1}}static{this.styles=O}async reposition(){await this.popoverElement.value?.reposition()}willUpdate(e){e.has("selectedContent")&&this.selectedContentChange(this.selectedContent,e.get("selectedContent"))}async updated(){setTimeout(async()=>{typeof this.picklist.value?.setFocus=="function"&&await this.picklist.value?.setFocus()},m.PopoverTimer),E(this.popoverElement.value,this.open),this.hasUpdated||setTimeout(()=>{this.popoverElement.value?.reposition()},m.PopoverTimer)}selectedContentChange(e,t){this.pickListHasChanged=T(e,t)}closePopover(){if(this.contentKind===a.numericFields&&this.pickListHasChanged){let e={pickListElement:this.picklist.value,eventEmitter:this.arcgisChartsConfigBoxPlotDataPopoverChange,contentKind:this.contentKind};D(e)}this.open=!1,this.arcgisChartsConfigPopoverClose.emit()}async onDataContentTypeChange(e){this.pickListHasChanged=!0;let t=e.target.selectedItems;this.arcgisChartsConfigBoxPlotDataPopoverChange.emit({contentKind:this.contentKind,value:t.map(i=>i.value)}),this.open=!1}buildPickListItem(e){return u(e.name,l`<calcite-list-item .label=${L(this.layerFieldsInfo,e.name)} .value=${e.name} .selected=${h(e.name,this.selectedContent)}></calcite-list-item>`)}buildPickListItems(e){let t=this.layerFieldsInfo?.length??0,i=[];switch(e){case a.numericFields:{for(let s=0;s<t;s+=1){let n=this.layerFieldsInfo[s];F(n)&&i.push(this.buildPickListItem(n))}break}case a.category:{let s=u(" ",l`<calcite-list-item label=" " value=" " .selected=${h("",this.selectedContent)}></calcite-list-item>`);i.push(s);for(let n=0;n<t;n+=1){let d=this.layerFieldsInfo[n];(C(d)||d.type===b.String)&&i.push(this.buildPickListItem(d))}break}case a.splitByField:{let s=u(" ",l`<calcite-list-item label=" " value=" " .selected=${h("",this.selectedContent)}></calcite-list-item>`);i.push(s);for(let n=0;n<t;n+=1){let d=this.layerFieldsInfo[n];(C(d)||d.type===b.String)&&i.push(this.buildPickListItem(d))}break}}return i}onNumericFieldsChange(e){e.target!==null&&(this.selectedContent=e.target.selectedItems.map(t=>t.value))}buildSortOrder(){let e=Object.keys(r),t;return B(e,i=>i,i=>{let s="";switch(i){case r.xAxisAsc:{t="a-z-down";break}case r.xAxisDesc:{t="a-z-up";break}case r.meanAsc:t="sort-descending",s=o.sortMean;break;case r.meanDesc:{t="sort-ascending",s=o.sortMean;break}case r.medianAsc:{t="sort-descending",s=o.sortMedian;break}case r.medianDesc:{t="sort-ascending",s=o.sortMedian;break}case r.customSort:{t="arrow-up-down";break}}return l`<calcite-list-item .disabled=${this.isCustomSortDisabled&&i===r.customSort} .label=${this._messages[i]} .selected=${this.selectedContent===i} .value=${r[i]} @mouseover=${this.createTooltip} @mouseout=${this.destroyTooltip}><calcite-icon class=${`sort-icon-color ${s}`} slot=content-start .icon=${t}></calcite-icon></calcite-list-item>`})}async onNumericFieldSelectionDone(){this.pickListHasChanged&&this.closePopover()}createTooltip(e){if(e.target?.label===this._messages.customSort&&this.isCustomSortDisabled){let t=e.target,i=w(t),s=new Intl.NumberFormat(i).format(m.customSortLimit),n=z(this._messages.customSortLimit??"",{totalLimit:s});this.tooltip=x(l`<calcite-tooltip style=${$({opacity:1,zIndex:"var(--calcite-floating-ui-z-index)"})} .referenceElement=${t} open placement=top>${n}</calcite-tooltip>`),document.body.appendChild(this.tooltip)}}destroyTooltip(){S(this.tooltip)}renderCategory(){let e=this.buildPickListItems(a.category);return l`<calcite-list label class=${c(o.pickListItemLabel)} selection-mode=single selection-appearance=border filter-enabled @calciteListChange=${this.onDataContentTypeChange} ${p(this.picklist)}>${e}</calcite-list>`}renderNumericFields(){let e=this.buildPickListItems(a.numericFields);return l`<calcite-list label class=${c(o.numericFieldPickList)} selection-mode=multiple filter-enabled @calciteListChange=${this.onNumericFieldsChange} ${p(this.picklist)}>${e}</calcite-list>`}renderSplitByField(){let e=this.buildPickListItems(a.splitByField);return l`<calcite-list label class=${c(o.pickListItemLabel)} selection-mode=single selection-appearance=border filter-enabled @calciteListChange=${this.onDataContentTypeChange} ${p(this.picklist)}>${e}</calcite-list>`}renderSortOrder(){let e=this.buildSortOrder();return l`<calcite-list label class=${c(o.sortOrderPickList)} selection-mode=single selection-appearance=border @calciteListChange=${this.onDataContentTypeChange}>${e}</calcite-list>`}renderPopoverInfo(){let e;switch(this.contentKind){case a.category:e=this.renderCategory();break;case a.numericFields:e=this.renderNumericFields();break;case a.splitByField:e=this.renderSplitByField();break;case a.sortOrder:e=this.renderSortOrder();break}return e}render(){let e;return this.contentKind===a.numericFields&&(e=l`<div slot=footer><calcite-fab class=${c(o.fab)} appearance=outline-fill kind=neutral icon .label=${this._messages.selectionDone} scale=s text-enabled .text=${this._messages.selectionDone} @click=${this.onNumericFieldSelectionDone}></calcite-fab></div>`),l`<div class=${c(o.jsAppFlyout)}><calcite-popover class=${c(o.name)} .referenceElement=${this.referenceElement??document.body} .placement=${this.placement} .offsetDistance=${this.offsetDistance} .open=${this.open} @calcitePopoverClose=${this.closePopover} label auto-close ${p(this.popoverElement)}><calcite-panel class=${c(o.panel)} closable .closed=${!this.open} @calcitePanelClose=${this.closePopover}><div slot=header-content class=${c(o.header)}>${this.headingTitle??""}</div>${this.renderPopoverInfo()}${e}</calcite-panel></calcite-popover></div>`}};P("arcgis-charts-config-box-plot-popover",k);return k},"geometry/support/jsonUtils","rest/support/AttributeBinsQuery","rest/support/Query","rest/support/StatisticDefinition","time/TimeExtent","core/promiseUtils","request","intl",d,e,h)