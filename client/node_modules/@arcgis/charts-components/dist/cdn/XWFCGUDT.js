/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
v4.34.3 */
import c from"./MJVNOHMT.js";import b from"./CDJV5WUJ.js";import a from"./GUWCFIQ4.js";import{d as V,f as j,i as P,m as $,w as G}from"./MHMLEVRX.js";import{c as d,d as y}from"./5BG7WW2E.js";import{a as E,b as f,h as F,v as p}from"./2YIVYDK5.js";export default $arcgis.t(([,,,,,,,{substitute:O},{Dc:N,Qa:v,R:R,ha:z,i:T,j:D,ya:_},{d:k},{M:U,b:h,c:L,q:K}])=>{function B(r){let{config:t,layerInfo:e,mode:o,commonStrings:i}=r,s=e!==void 0?A({config:t,layerInfo:e,commonStrings:i,mode:o}):"",c=K(t),g=N(t);return s===c||g}function x(r){let{config:t,layerInfo:e,mode:o,commonStrings:i}=r,s=e!==void 0?L({config:t,layerInfo:e,commonStrings:i,numericFields:S(t),aggregationType:b(t,o)}):"",c=U(1,t),g=N(t);return s===c||g}var w=r=>r.series?.[0]?.x??"";function M(r,t){let e=r.series?.[0];return[`${t===y.Category?e.y:D} ${F.Descending}`]}var W=(r,t)=>{let e=d.valueDesc,o=r.orderOptions?.data?.orderType??M(r,t),i=r.orderOptions?.data?.orderBy??F.Descending;return o===p.Category&&Array.isArray(i)?e=d.customSort:o===p.Category?i===F.Ascending?e=d.labelAsc:e=d.labelDesc:i===F.Ascending?e=d.valueAsc:e=d.valueDesc,e},S=V(r=>{let t=[];return t=r.series?.[0]?.query?.outStatistics?.map(e=>e.onStatisticField)??[r.series?.[0]?.y??""],[...new Set(t.filter(e=>e!==""))]},r=>r.series),b=(r,t)=>{let e=S(r),o;return t===y.Fields&&e.length===0?o=f.Sum:o=r.series?.[0]?.query?.outStatistics?.[0]?.statisticType??f.NoAggregation,o};function X(r){let{config:t,layerInfo:e,mode:o,commonStrings:i}=r,{objectIdField:s}=e??{},c=z(i,s),g=w(t),l=t.series[0]?.dataLabels,a={...c,x:o===y.Category?g:T,slices:t.series?.[0]?.slices,dataLabels:{...c.dataLabels,type:c.dataLabels?.type??E.Text,content:{...c.dataLabels?.content,...l?.content,type:G.TS},visible:l?.visible??!1},innerRadiusSize:t.series?.[0]?.innerRadius,sliceGrouping:t.series?.[0]?.sliceGrouping,dataLabelsCharacterLimit:t.series?.[0]?.dataLabelsCharacterLimit,numericValueFormat:t.series?.[0]?.numericValueFormat,percentValueFormat:t.series?.[0]?.percentValueFormat,displayCategoryOnDataLabel:t.series?.[0]?.displayCategoryOnDataLabel,displayNumericValueOnDataLabel:t.series?.[0]?.displayNumericValueOnDataLabel,displayPercentageOnDataLabel:t.series?.[0]?.displayPercentageOnDataLabel},n=b(t,o);if(n!==f.NoAggregation&&s!==void 0){let m=`${n}_${s}_0`.toUpperCase();a.y=o===y.Category?m:D,a.query={outStatistics:o===y.Category?[{statisticType:n,onStatisticField:s,outStatisticFieldName:m}]:[]}}return o===y.Category&&a.query!==void 0?a.query.groupByFieldsForStatistics=[g]:delete a.query?.groupByFieldsForStatistics,j(a)}function A(r){let{config:t,layerInfo:e,mode:o,commonStrings:i}=r,{layerFieldsInfo:s,objectIdField:c}=e,g=w(t),l=S(t),a=b(t,o),n=l.length===0||l.includes(c),m=_(a,i),u=n?"":l.map(J=>v(s??[],J)).join(", "),I=v(s??[],g),C="",q;return o===y.Fields?q=l.length===0:q=g==="",q?C=i.utilsStrings.chartType.pieChart:a===f.NoAggregation?C=O(i.titleLabels.aggrFieldsByCategory,{aggregationFields:n?c:u,category:I}):a===f.Count?C=O(i.titleLabels.aggrTypeCategory,{aggregationType:m,category:I}):l.length>0&&(I===T||P(I)||$(I)?C=O(i.titleLabels.aggrTypeOfAggrFields,{aggregationType:m,aggregationFields:u}):C=O(i.titleLabels.aggrTypeOfAggrFieldsByCategory,{aggregationType:m,aggregationFields:u,category:I})),C}var ue=r=>{let{newSortOrderKind:t,config:e,orderByList:o}=r;e.orderOptions??={},t===d.customSort&&o!==void 0?e.orderOptions.data={orderType:p.Category,orderBy:[...o]}:e.orderOptions.data={orderType:t===d.labelAsc||t===d.labelDesc?p.Category:p.YValue,orderBy:t===d.labelAsc||t===d.valueAsc?F.Ascending:F.Descending}},fe=r=>{let{newCategory:t,config:e,layerInfo:o,mode:i,commonStrings:s}=r,c=e.series?.length??0,g=B({config:e,layerInfo:o,commonStrings:s,mode:i}),l=x({config:e,layerInfo:o,commonStrings:s,mode:i});if(e.series.forEach(a=>{a.x=i===y.Category?t:T,a.query!==void 0&&t!==T?a.query.groupByFieldsForStatistics=[t]:delete a.query?.groupByFieldsForStatistics}),c===0){let a=[X({config:e,layerInfo:o,mode:i,commonStrings:s})];e.series=a}if(o!==void 0){if(l){let n=L({config:e,layerInfo:o,numericFields:S(e),aggregationType:b(e,i),commonStrings:s});h(e,1,n)}e.title&&g&&(e.title.content.text=A({config:e,layerInfo:o,commonStrings:s,mode:i}));let a=i===y.Fields?S(e).filter(n=>n!==o.objectIdField):S(e);Y({newNumericFields:a,config:e,layerInfo:o,mode:i,commonStrings:s})}};function H(r){let{numericFields:t,aggregationType:e,config:o,layerInfo:i,mode:s,commonStrings:c}=r,{layerFieldsInfo:g}=i,l=[],a=X({config:o,layerInfo:i,mode:s,commonStrings:c}),n={...a,query:{...a.query}};t.length<=1?n.query.where=a.query?.where:delete n.query.where;let m=k({config:o,xAxisField:w(o),numericFields:t,aggregationType:e,mode:s,layer:i.layer,fieldList:g}).name;if(e!==f.NoAggregation)if(s===y.Category){if(t.length>0){let u=t[0];n.query.outStatistics=[{...a.query?.outStatistics?.[0]??{},onStatisticField:u,outStatisticFieldName:m,statisticType:e}]}}else for(let u of t)n.query.outStatistics?.push({onStatisticField:u,outStatisticFieldName:u,statisticType:e});else n.query={};n.y=m,l.push(n),o.series=l}var pe=r=>{let{newAggregationType:t,config:e,layerInfo:o,mode:i,commonStrings:s}=r,c=S(e),g=B({config:e,layerInfo:o,commonStrings:s,mode:i}),l=x({config:e,layerInfo:o,commonStrings:s,mode:i});if(H({config:e,layerInfo:o,numericFields:c,aggregationType:t,commonStrings:s,mode:i}),l){let u=L({config:e,layerInfo:o,commonStrings:s,numericFields:S(e),aggregationType:b(e,i)});h(e,1,u)}e.title&&g&&(e.title.content.text=A({config:e,layerInfo:o,commonStrings:s,mode:i}));let a=e.series?.[0]?.displayCategoryOnDataLabel,n=e.series?.[0]?.displayNumericValueOnDataLabel,m=e.series?.[0]?.displayPercentageOnDataLabel;e.legend={...e.legend??R(),displayNumericValue:n,displayPercentage:m,displayCategory:a}},Y=r=>{let{newNumericFields:t}=r,{config:e,layerInfo:o,mode:i,commonStrings:s}=r,{objectIdField:c}=o??{},g=b(e,i),l=B({config:e,layerInfo:o,commonStrings:s,mode:i}),a=x({config:e,layerInfo:o,commonStrings:s,mode:i});if(t=t===""?[]:t,t=typeof t=="string"?[t]:t,c!==void 0&&(t.length===0&&i===y.Category?(t.push(c),g=f.Count):g===f.Count&&t.length>=1&&!t.includes(c)&&(g=f.Sum)),o!==void 0){if(H({config:e,layerInfo:o,commonStrings:s,numericFields:t,aggregationType:g,mode:i}),a){let n=L({config:e,layerInfo:o,commonStrings:s,numericFields:S(e),aggregationType:b(e,i)});h(e,1,n)}e.title&&l&&(e.title.content.text=A({config:e,layerInfo:o,commonStrings:s,mode:i}))}else e.series.forEach(n=>{delete n.query,n.y=t[0]})},Se=(r,t)=>{let e=[],o=r.orderOptions?.data?.orderType,i=W(r,t),s=r.orderOptions?.data?.orderBy;return i===d.customSort&&o===p.Category&&Array.isArray(s)&&(e=s),e},Fe=r=>{let{values:t,config:e,mode:o}=r;e.orderOptions??={};let i=e.orderOptions?.data?.orderType;W(e,o)===d.customSort&&i===p.Category&&(e.orderOptions.data={orderType:p.Category,orderBy:[...t]})};return{a:w,b:W,c:S,d:b,e:A,f:ue,g:fe,h:pe,i:Y,j:Se,k:Fe}},"geometry/support/jsonUtils","rest/support/AttributeBinsQuery","rest/support/Query","rest/support/StatisticDefinition","time/TimeExtent","core/promiseUtils","request","intl",a,b,c)