/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
v4.34.3 */
import{a as S,c as w}from"./VZXOTDOW.js";import{a as E}from"./XIZLMN6F.js";import{a as L}from"./JHAJCFXL.js";import{f as l}from"./TLMHEFBH.js";import{a as v}from"./BMZ5OG4J.js";import e from"./CDJV5WUJ.js";import a from"./GUWCFIQ4.js";import{q as p}from"./MHMLEVRX.js";import"./DXCHSVBP.js";import"./5BG7WW2E.js";import{b as m,k as b,n as d}from"./2YIVYDK5.js";import{A as s,D as F,F as x,g as y,h as r,l as g,w as c,x as h,y as $}from"./GRWAOK3Y.js";import"./UUMP6K6L.js";export default $arcgis.t(([,,,,,,,{Qa:u,Xa:k,lc:f,ya:A,za:I},{e:B}])=>{var _=y`.hide{display:none}.am5-modal{width:100%;height:100%;position:absolute;z-index:100000;top:0;left:0}.am5-modal-curtain{top:0;left:0;width:100%;height:100%;position:absolute;background:#fff!important;z-index:100}.am5-modal-wrapper{top:0;left:0;width:100%;height:100%;position:absolute;display:flex;align-items:center;justify-content:center;white-space:nowrap;background:#ffffff80;z-index:101}.am5-modal-content{display:inline-block;padding:1.2em;vertical-align:middle;text-align:start;white-space:normal;background:#fff;border-radius:4px;box-shadow:#00000073 0 0 36px;color:#000}.am5-layer-1000{z-index:1000!important}.am5-layer-30{z-index:100!important}.arcgis-charts-modal{box-shadow:none!important}.arcgis-charts-modal-header{background-color:#0000000d;font-weight:700;padding:4px;align-content:center}.show{display:block}.notifyPanel{flex:0 1 auto}.disable-interactions{pointer-events:none}.dim-text{color:var(--arcgis-charts-dim-text)}:host{display:flex;flex-direction:column;width:var(--arcgis-charts-config-calcite-block-default-width);margin:var(--arcgis-charts-config-calcite-block-default-margin);margin-top:var(--arcgis-charts-top-section-margin)}.label,.disabled-label{display:flex;margin-left:.5rem;margin-right:.5rem;margin-bottom:.5rem;justify-content:space-between}.time-binning-header{display:flex;font-weight:700;margin-left:.5rem;margin-right:.5rem;justify-content:space-between}.text{display:flex;margin-left:.5rem;width:calc(100% - 1.5rem);height:2rem;margin-bottom:.5rem;justify-content:space-between}.field-list{max-height:50vh;overflow-y:auto}.disabled-label{pointer-events:none}.fab{display:flex;margin-left:.5rem;margin-right:.5rem;margin-bottom:1.5rem;justify-content:center}.link-container{display:flex;justify-content:flex-end}`,n={label:"label",fieldList:"field-list",fab:"fab",timeBinningHeader:"time-binning-header",linkContainer:"link-container",dimText:"dim-text"},C=class extends ${constructor(){super(...arguments),this._messages=v(),this.commonStrings=v({name:"common",blocking:!0}),this.lineChartPopover=null,this.aggregationElement=c(),this.xAxisFieldElement=c(),this.numericFieldsElement=c(),this.splitByFieldElement=c(),this.intervalAlignmentElement=c(),this.intervalElement=c(),this.onLineChartDataChange=async e=>{try{if(e.detail!==null&&e.detail?.value!==void 0){let{contentKind:t}=e.detail,i=[...e.detail.value];switch(w(S),t){case l.aggregation:this.model.aggregationType=i[0]!==m.NoAggregation?i[0]:m.NoAggregation;break;case l.xAxisField:{let a=i[0]?.trim()||"";this.model.xAxisField=a,this.arcgisChartsConfigResetTimeInterval.emit();break}case l.numericFields:this.model.numericFields=i,this.model.numericFields.length>0&&this.model.aggregationType===m.Count&&this.model.numericFields[0]!==f(this.layerFieldsInfo)&&(this.model.aggregationType=m.Sum);break;case l.splitByField:{let a=i[0]?.trim()||"";this.model.splitByField=a,this.model.colorMatch=!0;break}case l.interval:this.model.temporalBinningSize=i[0]?.intervalSize,this.model.temporalBinningUnit=i[0]?.intervalUnits,this.arcgisChartsConfigCustomizedTimeInterval.emit();break;case l.intervalAlignment:this.model.timeAggregationType=i[0]??"";break;default:break}}}catch(t){throw this.arcgisChartsConfigDataChangeError.emit({error:t,model:this.model}),t}this.removeLineChartDataPopover(),this.requestUpdate()},this.onModelConfigChange=()=>{this.requestUpdate()},this.popoverClose=e=>{this.lineChartPopover===e?.target&&this.removeLineChartDataPopover()},this.layerFieldsInfo=[],this.arcgisChartsConfigCustomizedTimeInterval=g(),this.arcgisChartsConfigDataChangeError=g(),this.arcgisChartsConfigLineChartDataNumericFieldValidate=g(),this.arcgisChartsConfigResetTimeInterval=g()}static{this.properties={aggregationLabel:16,timeAggregationLabel:16,disableSplitBy:16,messageOverrides:0,model:0,resetTimeInterval:0,layerFieldsInfo:0}}static{this.styles=_}load(){this.modelChange(this.model),this.onModelConfigChange()}willUpdate(e){e.has("model")&&this.modelChange(this.model,e.get("model")),this.aggregationLabel=A(this.model.aggregationType,this.commonStrings);let t=this.model.timeAggregationType;t!==void 0&&(this.timeAggregationLabel=I(t,this.commonStrings)),this.disableSplitBy=this.model.numericFields.length>1}disconnectedCallback(){super.disconnectedCallback(),this.removeLineChartDataPopover(),this.model.removeEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange)}modelChange(e,t){t?.removeEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange),e?.addEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange)}buildNumericFieldItem(e){return E(e,r`<calcite-list-item .label=${u(this.layerFieldsInfo,e)} .value=${e} closable @calciteListItemClose=${this.onRemoveNumericField}></calcite-list-item>`)}resetTimeIntervalOriginal(e){this.popoverClose(e),this.model.resetTimeInterval!==void 0&&(this.model.resetTimeInterval(),this.arcgisChartsConfigResetTimeInterval.emit())}onAggregationSelect(e){this.contentKind=l.aggregation,this.setupPopover(e)}onXAxisFieldSelect(e){this.contentKind=l.xAxisField,this.setupPopover(e)}onSplitBySelect(e){this.splitByFieldElement.value&&!this.splitByFieldElement.value.disabled&&(this.contentKind=l.splitByField,this.setupPopover(e))}onAddNumericFields(e){this.contentKind=l.numericFields,this.setupPopover(e)}onRemoveNumericField(e){let t=e.target.value;this.model.numericFields=this.model.numericFields.filter(i=>i!==t)}onIntervalAlignmentSelect(e){this.intervalAlignmentElement.value&&!this.intervalAlignmentElement.value.disabled&&(this.contentKind=l.intervalAlignment,this.setupPopover(e))}onIntervalSelect(e){this.intervalElement.value&&!this.intervalElement.value.disabled&&(this.contentKind=l.interval,this.setupPopover(e))}getCorrectedSplitByValue(){return this.model.splitByField===""||this.model.numericFields.length>1?"":u(this.layerFieldsInfo,this.model.splitByField)}getCorrectedXAxisValue(){return B({fieldName:this.model.xAxisField,fieldList:this.layerFieldsInfo})?"":u(this.layerFieldsInfo,this.model.xAxisField)}onShowDataLabelsChange(e){this.model.dataLabelsVisibility=e.target.checked}onTrimIncompleteIntervalChange(e){this.model.trimIncompleteTimeInterval=e.target.checked}onNullPolicyChange(e){this.model.nullPolicy=e.target.selectedItem.value}shouldShowTimeBinning(){let e=this.layerFieldsInfo.find(a=>a.name===this.model.xAxisField),t=e?.type===p.Date||e?.type===p.DateOnly||e?.type===p.TimestampOffset,i=this.model.aggregationType!==m.NoAggregation;return t&&i}setupPopover(e){e.stopImmediatePropagation(),this.removeLineChartDataPopover();let t={size:this.model.temporalBinningSize??1,unit:this.model.temporalBinningUnit??b.Second},i,a,o;switch(this.contentKind){case l.aggregation:i=this.aggregationElement.value,a=this._messages.aggregationHeader,o=this.model.aggregationType;break;case l.xAxisField:i=this.xAxisFieldElement.value,a=this._messages.xAxisFieldHeader,o=this.model.xAxisField;break;case l.numericFields:i=this.numericFieldsElement.value,a=this._messages.numericFieldsHeader,o=this.model.numericFields;break;case l.splitByField:i=this.splitByFieldElement.value,a=this._messages.splitByFieldHeader,o=this.model.splitByField;break;case l.interval:i=this.intervalElement.value,a=this._messages.editInterval,o=t;break;case l.intervalAlignment:i=this.intervalAlignmentElement.value,a=this._messages.intervalAlignment,o=this.model.timeAggregationType??"";break}this.lineChartPopover=F(r`<arcgis-charts-config-line-chart-popover .headingTitle=${a} .referenceElement=${i} open .contentKind=${this.contentKind} .layerFieldsInfo=${this.layerFieldsInfo} .selectedContent=${o} @arcgisChartsConfigLineChartDataPopoverChange=${this.onLineChartDataChange} @arcgisChartsConfigLineChartPopoverClose=${this.popoverClose}></arcgis-charts-config-line-chart-popover>`),!document.body.contains(this.lineChartPopover)&&this.lineChartPopover!==null&&document.body.appendChild(this.lineChartPopover)}removeLineChartDataPopover(){this.lineChartPopover!==null&&(this.lineChartPopover.open=!1,this.lineChartPopover=L(this.lineChartPopover))}renderAggregation(){return r`<arcgis-charts-config-field-select .label=${this.model.aggregationType===m.NoAggregation?this._messages.noAggregation:this.aggregationLabel} @click=${this.onAggregationSelect} ${h(this.aggregationElement)}></arcgis-charts-config-field-select>`}renderXAxisField(){let e=this.getCorrectedXAxisValue();return r`<arcgis-charts-config-field-select .label=${e} @click=${this.onXAxisFieldSelect} ${h(this.xAxisFieldElement)}></arcgis-charts-config-field-select>`}renderSplitBy(){let e=this.getCorrectedSplitByValue();return r`<arcgis-charts-config-field-select .label=${e} .disabled=${this.disableSplitBy} @click=${this.onSplitBySelect} ${h(this.splitByFieldElement)}></arcgis-charts-config-field-select>`}renderNumericFields(e){let t=f(this.layerFieldsInfo),i=[];for(let a of e)a!==t&&i.push(this.buildNumericFieldItem(a));return r`<calcite-list label class=${s(n.fieldList)} ${h(this.numericFieldsElement)}>${i}</calcite-list>`}renderInterval(){let e=(this.model.temporalBinningSize??0)<=0,t=this.model.temporalBinningSize??"",i=k(this.model.temporalBinningUnit??b.Second,this._messages)??"";return[r`<calcite-list label selection-appearance=border><calcite-list-item .value=${e?"":`${t} ${i}`} .label=${e?"":`${t} ${i}`} @click=${e?()=>{}:this.onIntervalSelect} ${h(this.intervalElement)}><calcite-icon slot=content-end icon=pencil></calcite-icon></calcite-list-item></calcite-list>`,r`<div class=${s(n.linkContainer)}><calcite-button appearance=transparent scale=s icon-end=reset @click=${this.resetTimeIntervalOriginal}>${this._messages.reset}</calcite-button></div>`]}renderIntervalAlignment(){return r`<arcgis-charts-config-field-select .label=${this.timeAggregationLabel} @click=${this.onIntervalAlignmentSelect} ${h(this.intervalAlignmentElement)}></arcgis-charts-config-field-select>`}renderEmptyBins(){return r`<calcite-radio-button-group name=empty-bins layout=vertical @calciteRadioButtonGroupChange=${this.onNullPolicyChange}><calcite-label layout=inline><calcite-radio-button .value=${d.Zero} .checked=${this.model.nullPolicy===d.Zero}></calcite-radio-button>${this._messages.treatAsZero}</calcite-label><calcite-label layout=inline><calcite-radio-button .value=${d.Interpolate} .checked=${this.model.nullPolicy===d.Interpolate}></calcite-radio-button>${this._messages.connectLine}</calcite-label><calcite-label layout=inline><calcite-radio-button .value=${d.Null} .checked=${this.model.nullPolicy===d.Null}></calcite-radio-button>${this._messages.breakLine}</calcite-label></calcite-radio-button-group>`}render(){let e=this.renderAggregation(),t=this.renderXAxisField(),i=this.renderSplitBy(),a=this.renderNumericFields([...this.model.numericFields]),o=this.renderInterval(),P=this.renderIntervalAlignment(),T=this.renderEmptyBins();return r`<div><calcite-label class=${s(n.label)}>${this._messages.xAxisField}${t}</calcite-label><calcite-label class=${s(n.label)}>${this._messages.aggregation}${e}</calcite-label><calcite-label class=${s(n.label)}>${this._messages.numericFields}${a}</calcite-label><div class=${s(n.fab)}><calcite-fab appearance=outline-fill kind=neutral scale=m .label=${this._messages.selectNumericFields} text-enabled .text=${this._messages.selectNumericFields} icon=plus @click=${this.onAddNumericFields}></calcite-fab></div><calcite-label class=${s(n.label)}><span class=${s(this.disableSplitBy?n.dimText:"")}>${this._messages.splitBy}</span>${i}</calcite-label><div .hidden=${!this.shouldShowTimeBinning()}><h3 class=${s(n.timeBinningHeader)}>${this._messages.timeBinningOptions}</h3><calcite-label class=${s(n.label)}>${this._messages.interval}${o}</calcite-label><calcite-label class=${s(n.label)}>${this._messages.intervalAlignment}${P}</calcite-label><calcite-label class=${s(n.label)} layout=inline-space-between>${this._messages.trimIncompleteInterval}<calcite-switch .checked=${this.model.trimIncompleteTimeInterval} @calciteSwitchChange=${this.onTrimIncompleteIntervalChange}></calcite-switch></calcite-label><calcite-label class=${s(n.label)}>${this._messages.emptyBins}${T}</calcite-label></div><calcite-label class=${s(n.label)} layout=inline-space-between>${this._messages.showDataLabels}<calcite-switch .checked=${this.model.dataLabelsVisibility} @calciteSwitchChange=${this.onShowDataLabelsChange}></calcite-switch></calcite-label></div>`}};x("arcgis-charts-config-line-chart-data",C);return C},"geometry/support/jsonUtils","rest/support/AttributeBinsQuery","rest/support/Query","rest/support/StatisticDefinition","time/TimeExtent","core/promiseUtils","request",a,e)